'use babel';
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
import NodeColorGradient from 'node-color-gradient';
import * as GitData from '../data/GitData';
import * as ConfigManager from '../ConfigManager';
let editors = {};
let datePromises = {};
let scalePromises = {};
export function colorScale(editor) {
    return __awaiter(this, void 0, void 0, function* () {
        const projectDir = yield GitData.getRepoRootPath(editor.getPath());
        if (!scalePromises[projectDir]) {
            scalePromises[projectDir] = getScaleForEditor(editor);
        }
        return yield scalePromises[projectDir];
    });
}
function getScaleForEditor(editor) {
    return __awaiter(this, void 0, void 0, function* () {
        const projectDir = yield GitData.getRepoRootPath(editor.getPath());
        let firstCommitDate = yield datePromises[projectDir];
        const totalDays = Math.floor((Date.now() - firstCommitDate.getTime()) / 1000 / 3600 / 24);
        const gradient = calculateScale(totalDays);
        // Hack to fix color scale calculation coming up short with steps
        const lengthDifference = totalDays - gradient.length;
        if (lengthDifference > 0) {
            for (let i = 0; i < lengthDifference; i++) {
                gradient.push(gradient[gradient.length - 1]);
            }
        }
        return gradient;
    });
}
export function setEditor(editor) {
    return GitData.getRepoRootPath(editor.getPath()).then(projectDir => {
        if (editors[projectDir]) {
            return;
        }
        editors[projectDir] = editor;
        datePromises[projectDir] = GitData.getFirstCommitDateForRepo(editor.getPath());
    });
}
export const scales = {
    RoyalPomegranate: [
        [63, 116, 212],
        [60, 125, 199],
        [55, 136, 228],
        [78, 161, 216],
        [83, 175, 202],
        [96, 202, 197],
        [127, 225, 221],
        [167, 239, 236],
        [203, 248, 247],
        [255, 255, 255],
        [253, 245, 234],
        [251, 231, 204],
        [246, 208, 158],
        [243, 179, 99],
        [240, 159, 96],
        [240, 141, 89],
        [239, 128, 88],
        [238, 115, 73],
        [237, 98, 59],
        [235, 62, 37],
    ],
    ChocolateMint: [
        [140, 81, 10],
        [191, 129, 45],
        [223, 194, 125],
        [246, 232, 195],
        [245, 245, 245],
        [199, 234, 229],
        [128, 205, 193],
        [53, 151, 143],
        [1, 102, 94],
    ],
    VioletApple: [
        [197, 27, 125],
        [222, 119, 174],
        [241, 182, 218],
        [253, 224, 239],
        [247, 247, 247],
        [230, 245, 208],
        [184, 225, 134],
        [127, 188, 65],
        [77, 146, 33],
    ],
    AffairGoblin: [
        [118, 42, 131],
        [153, 112, 171],
        [194, 165, 207],
        [231, 212, 232],
        [247, 247, 247],
        [217, 240, 211],
        [166, 219, 160],
        [90, 174, 97],
        [27, 120, 55],
    ],
    GoldDaisy: [
        [179, 88, 6],
        [224, 130, 20],
        [253, 184, 99],
        [254, 224, 182],
        [247, 247, 247],
        [216, 218, 235],
        [178, 171, 210],
        [128, 115, 172],
        [84, 39, 136],
    ],
    PoppyLochmara: [
        [235, 62, 37],
        [214, 96, 77],
        [244, 165, 130],
        [253, 219, 199],
        [247, 247, 247],
        [209, 229, 240],
        [146, 197, 222],
        [67, 147, 195],
        [33, 102, 172],
    ],
    PersianSteel: [
        [215, 48, 39],
        [244, 109, 67],
        [253, 174, 97],
        [254, 224, 144],
        [255, 255, 191],
        [224, 243, 248],
        [171, 217, 233],
        [116, 173, 209],
        [69, 117, 180],
    ],
};
function calculateScale(steps) {
    const scale = ConfigManager.get('colorScale');
    return new NodeColorGradient(scales[scale]).getGradient(steps);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29sb3VyU2NhbGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9saWIvaW50ZXJmYWNlL0NvbG91clNjYWxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLFdBQVcsQ0FBQzs7Ozs7Ozs7O0FBSVosT0FBTyxpQkFBaUIsTUFBTSxxQkFBcUIsQ0FBQztBQUNwRCxPQUFPLEtBQUssT0FBTyxNQUFNLGlCQUFpQixDQUFDO0FBQzNDLE9BQU8sS0FBSyxhQUFhLE1BQU0sa0JBQWtCLENBQUM7QUFFbEQsSUFBSSxPQUFPLEdBQWdDLEVBQUUsQ0FBQztBQUM5QyxJQUFJLFlBQVksR0FBc0MsRUFBRSxDQUFDO0FBQ3pELElBQUksYUFBYSxHQUE0QyxFQUFFLENBQUM7QUFFaEUsTUFBTSxxQkFBMkIsTUFBZTs7UUFDOUMsTUFBTSxVQUFVLEdBQUcsTUFBTSxPQUFPLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO1FBQ25FLEVBQUUsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMvQixhQUFhLENBQUMsVUFBVSxDQUFDLEdBQUcsaUJBQWlCLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDeEQsQ0FBQztRQUNELE1BQU0sQ0FBQyxNQUFNLGFBQWEsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUN6QyxDQUFDO0NBQUE7QUFFRCwyQkFBaUMsTUFBZTs7UUFDOUMsTUFBTSxVQUFVLEdBQUcsTUFBTSxPQUFPLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO1FBQ25FLElBQUksZUFBZSxHQUFTLE1BQU0sWUFBWSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQzNELE1BQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLEdBQUcsZUFBZSxDQUFDLE9BQU8sRUFBRSxDQUFDLEdBQUcsSUFBSSxHQUFHLElBQUksR0FBRyxFQUFFLENBQUMsQ0FBQztRQUMxRixNQUFNLFFBQVEsR0FBRyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7UUFFM0MsaUVBQWlFO1FBQ2pFLE1BQU0sZ0JBQWdCLEdBQUcsU0FBUyxHQUFHLFFBQVEsQ0FBQyxNQUFNLENBQUM7UUFDckQsRUFBRSxDQUFDLENBQUMsZ0JBQWdCLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN6QixHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLGdCQUFnQixFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7Z0JBQzFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMvQyxDQUFDO1FBQ0gsQ0FBQztRQUVELE1BQU0sQ0FBQyxRQUFRLENBQUM7SUFDbEIsQ0FBQztDQUFBO0FBRUQsTUFBTSxvQkFBb0IsTUFBZTtJQUN2QyxNQUFNLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVTtRQUM5RCxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3hCLE1BQU0sQ0FBQztRQUNULENBQUM7UUFDRCxPQUFPLENBQUMsVUFBVSxDQUFDLEdBQUcsTUFBTSxDQUFDO1FBQzdCLFlBQVksQ0FBQyxVQUFVLENBQUMsR0FBRyxPQUFPLENBQUMseUJBQXlCLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUM7SUFDakYsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDO0FBRUQsTUFBTSxDQUFDLE1BQU0sTUFBTSxHQUF3QztJQUN6RCxnQkFBZ0IsRUFBRTtRQUNoQixDQUFDLEVBQUUsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ2QsQ0FBQyxFQUFFLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUNkLENBQUMsRUFBRSxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDZCxDQUFDLEVBQUUsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ2QsQ0FBQyxFQUFFLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUNkLENBQUMsRUFBRSxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDZCxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ2YsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUNmLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDZixDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ2YsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUNmLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDZixDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ2YsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FBQztRQUNkLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUM7UUFDZCxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDO1FBQ2QsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FBQztRQUNkLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUM7UUFDZCxDQUFDLEdBQUcsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDO1FBQ2IsQ0FBQyxHQUFHLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQztLQUNkO0lBQ0QsYUFBYSxFQUFFO1FBQ2IsQ0FBQyxHQUFHLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQztRQUNiLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUM7UUFDZCxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ2YsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUNmLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDZixDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ2YsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUNmLENBQUMsRUFBRSxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDZCxDQUFDLENBQUMsRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDO0tBQ2I7SUFDRCxXQUFXLEVBQUU7UUFDWCxDQUFDLEdBQUcsRUFBRSxFQUFFLEVBQUUsR0FBRyxDQUFDO1FBQ2QsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUNmLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDZixDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ2YsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUNmLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDZixDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ2YsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FBQztRQUNkLENBQUMsRUFBRSxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUM7S0FDZDtJQUNELFlBQVksRUFBRTtRQUNaLENBQUMsR0FBRyxFQUFFLEVBQUUsRUFBRSxHQUFHLENBQUM7UUFDZCxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ2YsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUNmLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDZixDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ2YsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUNmLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDZixDQUFDLEVBQUUsRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDO1FBQ2IsQ0FBQyxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FBQztLQUNkO0lBQ0QsU0FBUyxFQUFFO1FBQ1QsQ0FBQyxHQUFHLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUNaLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUM7UUFDZCxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDO1FBQ2QsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUNmLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDZixDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ2YsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUNmLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDZixDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsR0FBRyxDQUFDO0tBQ2Q7SUFDRCxhQUFhLEVBQUU7UUFDYixDQUFDLEdBQUcsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDO1FBQ2IsQ0FBQyxHQUFHLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQztRQUNiLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDZixDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ2YsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUNmLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDZixDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ2YsQ0FBQyxFQUFFLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUNkLENBQUMsRUFBRSxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7S0FDZjtJQUNELFlBQVksRUFBRTtRQUNaLENBQUMsR0FBRyxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUM7UUFDYixDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDO1FBQ2QsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FBQztRQUNkLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDZixDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ2YsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztRQUNmLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDZixDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ2YsQ0FBQyxFQUFFLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztLQUNmO0NBQ0YsQ0FBQztBQUVGLHdCQUF3QixLQUFhO0lBQ25DLE1BQU0sS0FBSyxHQUFHLGFBQWEsQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDOUMsTUFBTSxDQUFDLElBQUksaUJBQWlCLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQ2pFLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIGJhYmVsJztcblxuaW1wb3J0IHsgYWxsb3dVbnNhZmVFdmFsLCBhbGxvd1Vuc2FmZU5ld0Z1bmN0aW9uIH0gZnJvbSAnbG9vcGhvbGUnO1xuaW1wb3J0IElFZGl0b3IgPSBBdG9tQ29yZS5JRWRpdG9yO1xuaW1wb3J0IE5vZGVDb2xvckdyYWRpZW50IGZyb20gJ25vZGUtY29sb3ItZ3JhZGllbnQnO1xuaW1wb3J0ICogYXMgR2l0RGF0YSBmcm9tICcuLi9kYXRhL0dpdERhdGEnO1xuaW1wb3J0ICogYXMgQ29uZmlnTWFuYWdlciBmcm9tICcuLi9Db25maWdNYW5hZ2VyJztcblxubGV0IGVkaXRvcnM6IHsgW3Byb3A6IHN0cmluZ106IElFZGl0b3IgfSA9IHt9O1xubGV0IGRhdGVQcm9taXNlczogeyBbcHJvcDogc3RyaW5nXTogUHJvbWlzZTxEYXRlPiB9ID0ge307XG5sZXQgc2NhbGVQcm9taXNlczogeyBbcHJvcDogc3RyaW5nXTogUHJvbWlzZTxBcnJheTxhbnk+PiB9ID0ge307XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb2xvclNjYWxlKGVkaXRvcjogSUVkaXRvcikge1xuICBjb25zdCBwcm9qZWN0RGlyID0gYXdhaXQgR2l0RGF0YS5nZXRSZXBvUm9vdFBhdGgoZWRpdG9yLmdldFBhdGgoKSk7XG4gIGlmICghc2NhbGVQcm9taXNlc1twcm9qZWN0RGlyXSkge1xuICAgIHNjYWxlUHJvbWlzZXNbcHJvamVjdERpcl0gPSBnZXRTY2FsZUZvckVkaXRvcihlZGl0b3IpO1xuICB9XG4gIHJldHVybiBhd2FpdCBzY2FsZVByb21pc2VzW3Byb2plY3REaXJdO1xufVxuXG5hc3luYyBmdW5jdGlvbiBnZXRTY2FsZUZvckVkaXRvcihlZGl0b3I6IElFZGl0b3IpIHtcbiAgY29uc3QgcHJvamVjdERpciA9IGF3YWl0IEdpdERhdGEuZ2V0UmVwb1Jvb3RQYXRoKGVkaXRvci5nZXRQYXRoKCkpO1xuICBsZXQgZmlyc3RDb21taXREYXRlOiBEYXRlID0gYXdhaXQgZGF0ZVByb21pc2VzW3Byb2plY3REaXJdO1xuICBjb25zdCB0b3RhbERheXMgPSBNYXRoLmZsb29yKChEYXRlLm5vdygpIC0gZmlyc3RDb21taXREYXRlLmdldFRpbWUoKSkgLyAxMDAwIC8gMzYwMCAvIDI0KTtcbiAgY29uc3QgZ3JhZGllbnQgPSBjYWxjdWxhdGVTY2FsZSh0b3RhbERheXMpO1xuXG4gIC8vIEhhY2sgdG8gZml4IGNvbG9yIHNjYWxlIGNhbGN1bGF0aW9uIGNvbWluZyB1cCBzaG9ydCB3aXRoIHN0ZXBzXG4gIGNvbnN0IGxlbmd0aERpZmZlcmVuY2UgPSB0b3RhbERheXMgLSBncmFkaWVudC5sZW5ndGg7XG4gIGlmIChsZW5ndGhEaWZmZXJlbmNlID4gMCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoRGlmZmVyZW5jZTsgaSsrKSB7XG4gICAgICBncmFkaWVudC5wdXNoKGdyYWRpZW50W2dyYWRpZW50Lmxlbmd0aCAtIDFdKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZ3JhZGllbnQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRFZGl0b3IoZWRpdG9yOiBJRWRpdG9yKSB7XG4gIHJldHVybiBHaXREYXRhLmdldFJlcG9Sb290UGF0aChlZGl0b3IuZ2V0UGF0aCgpKS50aGVuKHByb2plY3REaXIgPT4ge1xuICAgIGlmIChlZGl0b3JzW3Byb2plY3REaXJdKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGVkaXRvcnNbcHJvamVjdERpcl0gPSBlZGl0b3I7XG4gICAgZGF0ZVByb21pc2VzW3Byb2plY3REaXJdID0gR2l0RGF0YS5nZXRGaXJzdENvbW1pdERhdGVGb3JSZXBvKGVkaXRvci5nZXRQYXRoKCkpO1xuICB9KTtcbn1cblxuZXhwb3J0IGNvbnN0IHNjYWxlczogeyBbbmFtZTogc3RyaW5nXTogQXJyYXk8bnVtYmVyW10+IH0gPSB7XG4gIFJveWFsUG9tZWdyYW5hdGU6IFtcbiAgICBbNjMsIDExNiwgMjEyXSxcbiAgICBbNjAsIDEyNSwgMTk5XSxcbiAgICBbNTUsIDEzNiwgMjI4XSxcbiAgICBbNzgsIDE2MSwgMjE2XSxcbiAgICBbODMsIDE3NSwgMjAyXSxcbiAgICBbOTYsIDIwMiwgMTk3XSxcbiAgICBbMTI3LCAyMjUsIDIyMV0sXG4gICAgWzE2NywgMjM5LCAyMzZdLFxuICAgIFsyMDMsIDI0OCwgMjQ3XSxcbiAgICBbMjU1LCAyNTUsIDI1NV0sXG4gICAgWzI1MywgMjQ1LCAyMzRdLFxuICAgIFsyNTEsIDIzMSwgMjA0XSxcbiAgICBbMjQ2LCAyMDgsIDE1OF0sXG4gICAgWzI0MywgMTc5LCA5OV0sXG4gICAgWzI0MCwgMTU5LCA5Nl0sXG4gICAgWzI0MCwgMTQxLCA4OV0sXG4gICAgWzIzOSwgMTI4LCA4OF0sXG4gICAgWzIzOCwgMTE1LCA3M10sXG4gICAgWzIzNywgOTgsIDU5XSxcbiAgICBbMjM1LCA2MiwgMzddLFxuICBdLFxuICBDaG9jb2xhdGVNaW50OiBbXG4gICAgWzE0MCwgODEsIDEwXSxcbiAgICBbMTkxLCAxMjksIDQ1XSxcbiAgICBbMjIzLCAxOTQsIDEyNV0sXG4gICAgWzI0NiwgMjMyLCAxOTVdLFxuICAgIFsyNDUsIDI0NSwgMjQ1XSxcbiAgICBbMTk5LCAyMzQsIDIyOV0sXG4gICAgWzEyOCwgMjA1LCAxOTNdLFxuICAgIFs1MywgMTUxLCAxNDNdLFxuICAgIFsxLCAxMDIsIDk0XSxcbiAgXSxcbiAgVmlvbGV0QXBwbGU6IFtcbiAgICBbMTk3LCAyNywgMTI1XSxcbiAgICBbMjIyLCAxMTksIDE3NF0sXG4gICAgWzI0MSwgMTgyLCAyMThdLFxuICAgIFsyNTMsIDIyNCwgMjM5XSxcbiAgICBbMjQ3LCAyNDcsIDI0N10sXG4gICAgWzIzMCwgMjQ1LCAyMDhdLFxuICAgIFsxODQsIDIyNSwgMTM0XSxcbiAgICBbMTI3LCAxODgsIDY1XSxcbiAgICBbNzcsIDE0NiwgMzNdLFxuICBdLFxuICBBZmZhaXJHb2JsaW46IFtcbiAgICBbMTE4LCA0MiwgMTMxXSxcbiAgICBbMTUzLCAxMTIsIDE3MV0sXG4gICAgWzE5NCwgMTY1LCAyMDddLFxuICAgIFsyMzEsIDIxMiwgMjMyXSxcbiAgICBbMjQ3LCAyNDcsIDI0N10sXG4gICAgWzIxNywgMjQwLCAyMTFdLFxuICAgIFsxNjYsIDIxOSwgMTYwXSxcbiAgICBbOTAsIDE3NCwgOTddLFxuICAgIFsyNywgMTIwLCA1NV0sXG4gIF0sXG4gIEdvbGREYWlzeTogW1xuICAgIFsxNzksIDg4LCA2XSxcbiAgICBbMjI0LCAxMzAsIDIwXSxcbiAgICBbMjUzLCAxODQsIDk5XSxcbiAgICBbMjU0LCAyMjQsIDE4Ml0sXG4gICAgWzI0NywgMjQ3LCAyNDddLFxuICAgIFsyMTYsIDIxOCwgMjM1XSxcbiAgICBbMTc4LCAxNzEsIDIxMF0sXG4gICAgWzEyOCwgMTE1LCAxNzJdLFxuICAgIFs4NCwgMzksIDEzNl0sXG4gIF0sXG4gIFBvcHB5TG9jaG1hcmE6IFtcbiAgICBbMjM1LCA2MiwgMzddLFxuICAgIFsyMTQsIDk2LCA3N10sXG4gICAgWzI0NCwgMTY1LCAxMzBdLFxuICAgIFsyNTMsIDIxOSwgMTk5XSxcbiAgICBbMjQ3LCAyNDcsIDI0N10sXG4gICAgWzIwOSwgMjI5LCAyNDBdLFxuICAgIFsxNDYsIDE5NywgMjIyXSxcbiAgICBbNjcsIDE0NywgMTk1XSxcbiAgICBbMzMsIDEwMiwgMTcyXSxcbiAgXSxcbiAgUGVyc2lhblN0ZWVsOiBbXG4gICAgWzIxNSwgNDgsIDM5XSxcbiAgICBbMjQ0LCAxMDksIDY3XSxcbiAgICBbMjUzLCAxNzQsIDk3XSxcbiAgICBbMjU0LCAyMjQsIDE0NF0sXG4gICAgWzI1NSwgMjU1LCAxOTFdLFxuICAgIFsyMjQsIDI0MywgMjQ4XSxcbiAgICBbMTcxLCAyMTcsIDIzM10sXG4gICAgWzExNiwgMTczLCAyMDldLFxuICAgIFs2OSwgMTE3LCAxODBdLFxuICBdLFxufTtcblxuZnVuY3Rpb24gY2FsY3VsYXRlU2NhbGUoc3RlcHM6IG51bWJlcikge1xuICBjb25zdCBzY2FsZSA9IENvbmZpZ01hbmFnZXIuZ2V0KCdjb2xvclNjYWxlJyk7XG4gIHJldHVybiBuZXcgTm9kZUNvbG9yR3JhZGllbnQoc2NhbGVzW3NjYWxlXSkuZ2V0R3JhZGllbnQoc3RlcHMpO1xufVxuIl19