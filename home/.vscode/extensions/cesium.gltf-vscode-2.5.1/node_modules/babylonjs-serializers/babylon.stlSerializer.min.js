!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("babylonjs")):"function"==typeof define&&define.amd?define("babylonjs-serializers",["babylonjs"],t):"object"==typeof exports?exports["babylonjs-serializers"]=t(require("babylonjs")):e.SERIALIZERS=t(e.BABYLON)}("undefined"!=typeof self?self:"undefined"!=typeof global?global:this,(e=>(()=>{"use strict";var t={597:t=>{t.exports=e}},r={};function o(e){var n=r[e];if(void 0!==n)return n.exports;var i=r[e]={exports:{}};return t[e](i,i.exports,o),i.exports}o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};o.d(n,{default:()=>c});var i={};o.r(i),o.d(i,{STLExport:()=>f});var a={};o.r(a),o.d(a,{STLExport:()=>f});var s=o(597),f=function(){function e(){}return e.CreateSTL=function(e,t,r,o,n,i,a,f){void 0===t&&(t=!0),void 0===r&&(r="stlmesh"),void 0===o&&(o=!1),void 0===n&&(n=!0),void 0===i&&(i=!1),void 0===a&&(a=!1),void 0===f&&(f=!1);var d=function(e,t,r){var o=[3*e[r],3*e[r+1],3*e[r+2]],n=[new s.Vector3(t[o[0]],t[o[0]+2],t[o[0]+1]),new s.Vector3(t[o[1]],t[o[1]+2],t[o[1]+1]),new s.Vector3(t[o[2]],t[o[2]+2],t[o[2]+1])],i=n[0].subtract(n[1]),a=n[2].subtract(n[1]);return{v:n,n:s.Vector3.Cross(a,i).normalize()}},l=function(e,t,r,o){return t=c(e,t,r.x,o),t=c(e,t,r.y,o),c(e,t,r.z,o)},c=function(e,t,r,o){return e.setFloat32(t,r,o),t+4},u=function(e){if(a){var t=e;e instanceof s.InstancedMesh&&(t=e.sourceMesh);var r=t.getVerticesData(s.VertexBuffer.PositionKind,!0,!0);if(!r)return[];var o=s.Vector3.Zero(),n=void 0;for(n=0;n<r.length;n+=3)s.Vector3.TransformCoordinatesFromFloatsToRef(r[n],r[n+1],r[n+2],e.computeWorldMatrix(!0),o).toArray(r,n);return r}return e.getVerticesData(s.VertexBuffer.PositionKind)||[]};a&&(i=!0);var v="",p=0,b=0;if(o){for(var y=0;y<e.length;y++)p+=(w=(g=e[y]).getIndices())?w.length/3:0;var x=new ArrayBuffer(84+50*p);b+=80,(v=new DataView(x)).setUint32(b,p,n),b+=4}else f||(v="solid stlmesh\r\n");for(y=0;y<e.length;y++){var g=e[y];!o&&f&&(v+="solid "+g.name+"\r\n"),!i&&g instanceof s.Mesh&&g.bakeCurrentTransformIntoVertices();for(var m=u(g),w=g.getIndices()||[],h=0;h<w.length;h+=3){var j=d(w,m,h);o?(b=l(v,b,j.n,n),b=l(v,b,j.v[0],n),b=l(v,b,j.v[1],n),b=l(v,b,j.v[2],n),b+=2):(v+="\tfacet normal "+j.n.x+" "+j.n.y+" "+j.n.z+"\r\n",v+="\t\touter loop\r\n",v+="\t\t\tvertex "+j.v[0].x+" "+j.v[0].y+" "+j.v[0].z+"\r\n",v+="\t\t\tvertex "+j.v[1].x+" "+j.v[1].y+" "+j.v[1].z+"\r\n",v+="\t\t\tvertex "+j.v[2].x+" "+j.v[2].y+" "+j.v[2].z+"\r\n",v+="\t\tendloop\r\n",v+="\tendfacet\r\n")}!o&&f&&(v+="endsolid "+name+"\r\n")}if(o||f||(v+="endsolid stlmesh"),t){var V=document.createElement("a"),S=new Blob([v],{type:"application/octet-stream"});V.href=window.URL.createObjectURL(S),V.download=r+".stl",V.click()}return v},e}(),d=void 0!==o.g?o.g:"undefined"!=typeof window?window:void 0;if(void 0!==d)for(var l in i)d.BABYLON[l]=i[l];const c=a;return n.default})()));
//# sourceMappingURL=babylon.stlSerializer.min.js.map