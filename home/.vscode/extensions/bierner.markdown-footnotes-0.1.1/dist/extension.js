"use strict";var g=Object.defineProperty;var M=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var E=Object.prototype.hasOwnProperty;var B=(l,e)=>()=>(e||l((e={exports:{}}).exports,e),e.exports),D=(l,e)=>{for(var c in e)g(l,c,{get:e[c],enumerable:!0})},N=(l,e,c,_)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of y(e))!E.call(l,i)&&i!==c&&g(l,i,{get:()=>e[i],enumerable:!(_=M(e,i))||_.enumerable});return l};var P=l=>N(g({},"__esModule",{value:!0}),l);var w=B((U,S)=>{"use strict";function j(l,e,c,_){var i=Number(l[e].meta.id+1).toString(),h="";return typeof _.docId=="string"&&(h="-"+_.docId+"-"),h+i}function q(l,e){var c=Number(l[e].meta.id+1).toString();return l[e].meta.subId>0&&(c+=":"+l[e].meta.subId),"["+c+"]"}function z(l,e,c,_,i){var h=i.rules.footnote_anchor_name(l,e,c,_,i),A=i.rules.footnote_caption(l,e,c,_,i),m=h;return l[e].meta.subId>0&&(m+=":"+l[e].meta.subId),'<sup class="footnote-ref"><a href="#fn'+h+'" id="fnref'+m+'">'+A+"</a></sup>"}function F(l,e,c){return(c.xhtmlOut?`<hr class="footnotes-sep" />
`:`<hr class="footnotes-sep">
`)+`<section class="footnotes">
<ol class="footnotes-list">
`}function O(){return`</ol>
</section>
`}function R(l,e,c,_,i){var h=i.rules.footnote_anchor_name(l,e,c,_,i);return l[e].meta.subId>0&&(h+=":"+l[e].meta.subId),'<li id="fn'+h+'" class="footnote-item">'}function G(){return`</li>
`}function H(l,e,c,_,i){var h=i.rules.footnote_anchor_name(l,e,c,_,i);return l[e].meta.subId>0&&(h+=":"+l[e].meta.subId),' <a href="#fnref'+h+'" class="footnote-backref">\u21A9\uFE0E</a>'}S.exports=function(e){var c=e.helpers.parseLinkLabel,_=e.utils.isSpace;e.renderer.rules.footnote_ref=z,e.renderer.rules.footnote_block_open=F,e.renderer.rules.footnote_block_close=O,e.renderer.rules.footnote_open=R,e.renderer.rules.footnote_close=G,e.renderer.rules.footnote_anchor=H,e.renderer.rules.footnote_caption=q,e.renderer.rules.footnote_anchor_name=j;function i(o,n,p,u){var s,d,t,f,r,v,b,C,k,a,T,I=o.bMarks[n]+o.tShift[n],x=o.eMarks[n];if(I+4>x||o.src.charCodeAt(I)!==91||o.src.charCodeAt(I+1)!==94)return!1;for(r=I+2;r<x;r++){if(o.src.charCodeAt(r)===32)return!1;if(o.src.charCodeAt(r)===93)break}if(r===I+2||r+1>=x||o.src.charCodeAt(++r)!==58)return!1;if(u)return!0;for(r++,o.env.footnotes||(o.env.footnotes={}),o.env.footnotes.refs||(o.env.footnotes.refs={}),v=o.src.slice(I+2,r-2),o.env.footnotes.refs[":"+v]=-1,b=new o.Token("footnote_reference_open","",1),b.meta={label:v},b.level=o.level++,o.tokens.push(b),s=o.bMarks[n],d=o.tShift[n],t=o.sCount[n],f=o.parentType,T=r,C=k=o.sCount[n]+r-(o.bMarks[n]+o.tShift[n]);r<x&&(a=o.src.charCodeAt(r),_(a));){a===9?k+=4-k%4:k++;r++}return o.tShift[n]=r-T,o.sCount[n]=k-C,o.bMarks[n]=T,o.blkIndent+=4,o.parentType="footnote",o.sCount[n]<o.blkIndent&&(o.sCount[n]+=o.blkIndent),o.md.block.tokenize(o,n,p,!0),o.parentType=f,o.blkIndent-=4,o.tShift[n]=d,o.sCount[n]=t,o.bMarks[n]=s,b=new o.Token("footnote_reference_close","",-1),b.level=--o.level,o.tokens.push(b),!0}function h(o,n){var p,u,s,d,t,f=o.posMax,r=o.pos;return r+2>=f||o.src.charCodeAt(r)!==94||o.src.charCodeAt(r+1)!==91||(p=r+2,u=c(o,r+1),u<0)?!1:(n||(o.env.footnotes||(o.env.footnotes={}),o.env.footnotes.list||(o.env.footnotes.list=[]),s=o.env.footnotes.list.length,o.md.inline.parse(o.src.slice(p,u),o.md,o.env,t=[]),d=o.push("footnote_ref","",0),d.meta={id:s},o.env.footnotes.list[s]={content:o.src.slice(p,u),tokens:t}),o.pos=u+1,o.posMax=f,!0)}function A(o,n){var p,u,s,d,t,f=o.posMax,r=o.pos;if(r+3>f||!o.env.footnotes||!o.env.footnotes.refs||o.src.charCodeAt(r)!==91||o.src.charCodeAt(r+1)!==94)return!1;for(u=r+2;u<f;u++){if(o.src.charCodeAt(u)===32||o.src.charCodeAt(u)===10)return!1;if(o.src.charCodeAt(u)===93)break}return u===r+2||u>=f||(u++,p=o.src.slice(r+2,u-1),typeof o.env.footnotes.refs[":"+p]>"u")?!1:(n||(o.env.footnotes.list||(o.env.footnotes.list=[]),o.env.footnotes.refs[":"+p]<0?(s=o.env.footnotes.list.length,o.env.footnotes.list[s]={label:p,count:0},o.env.footnotes.refs[":"+p]=s):s=o.env.footnotes.refs[":"+p],d=o.env.footnotes.list[s].count,o.env.footnotes.list[s].count++,t=o.push("footnote_ref","",0),t.meta={id:s,subId:d,label:p}),o.pos=u,o.posMax=f,!0)}function m(o){var n,p,u,s,d,t,f,r,v,b,C=!1,k={};if(!!o.env.footnotes&&(o.tokens=o.tokens.filter(function(a){return a.type==="footnote_reference_open"?(C=!0,v=[],b=a.meta.label,!1):a.type==="footnote_reference_close"?(C=!1,k[":"+b]=v,!1):(C&&v.push(a),!C)}),!!o.env.footnotes.list)){for(t=o.env.footnotes.list,f=new o.Token("footnote_block_open","",1),o.tokens.push(f),n=0,p=t.length;n<p;n++){for(f=new o.Token("footnote_open","",1),f.meta={id:n,label:t[n].label},o.tokens.push(f),t[n].tokens?(r=[],f=new o.Token("paragraph_open","p",1),f.block=!0,r.push(f),f=new o.Token("inline","",0),f.children=t[n].tokens,f.content=t[n].content,r.push(f),f=new o.Token("paragraph_close","p",-1),f.block=!0,r.push(f)):t[n].label&&(r=k[":"+t[n].label]),r&&(o.tokens=o.tokens.concat(r)),o.tokens[o.tokens.length-1].type==="paragraph_close"?d=o.tokens.pop():d=null,s=t[n].count>0?t[n].count:1,u=0;u<s;u++)f=new o.Token("footnote_anchor","",0),f.meta={id:n,subId:u,label:t[n].label},o.tokens.push(f);d&&o.tokens.push(d),f=new o.Token("footnote_close","",-1),o.tokens.push(f)}f=new o.Token("footnote_block_close","",-1),o.tokens.push(f)}}e.block.ruler.before("reference","footnote_def",i,{alt:["paragraph","reference"]}),e.inline.ruler.after("image","footnote_inline",h),e.inline.ruler.after("footnote_inline","footnote_ref",A),e.core.ruler.after("inline","footnote_tail",m)}});var K={};D(K,{activate:()=>J});module.exports=P(K);function J(){return{extendMarkdownIt(l){return l.use(w())}}}
