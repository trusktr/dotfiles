const e=require(`./path-browserify-BWikazpY.js`),t=require(`./main-C2nCM8Wt.js`),n=e.__toESM(require(`vscode`)),r=e.__toESM(require(`node:fs`)),i=e.__toESM(require(`node:path`));var a=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.asPromise=exports.thenable=exports.typedArray=exports.stringArray=exports.array=exports.func=exports.error=exports.number=exports.string=exports.boolean=void 0;function t(e){return e===!0||e===!1}exports.boolean=t;function n(e){return typeof e==`string`||e instanceof String}exports.string=n;function r(e){return typeof e==`number`||e instanceof Number}exports.number=r;function i(e){return e instanceof Error}exports.error=i;function a(e){return typeof e==`function`}exports.func=a;function o(e){return Array.isArray(e)}exports.array=o;function s(e){return o(e)&&e.every(e=>n(e))}exports.stringArray=s;function c(e,t){return Array.isArray(e)&&e.every(t)}exports.typedArray=c;function l(e){return e&&a(e.then)}exports.thenable=l;function u(e){return e instanceof Promise?e:l(e)?new Promise((t,n)=>{e.then(e=>t(e),e=>n(e))}):Promise.resolve(e)}exports.asPromise=u}),o=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.forEach=exports.mapAsync=exports.map=exports.clearTestMode=exports.setTestMode=exports.Semaphore=exports.Delayer=void 0;let n=t.require_main$1();var r=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||=new Promise(e=>{this.onSuccess=e}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var e=this.task();return this.task=void 0,e}),(t>=0||this.timeout===void 0)&&(this.timeout=(0,n.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}};exports.Delayer=r;var i=class{constructor(e=1){if(e<=0)throw Error(`Capacity must be greater than 0`);this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,n)=>{this._waiting.push({thunk:e,resolve:t,reject:n}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,n.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw Error(`To many thunks active`);try{let t=e.thunk();t instanceof Promise?t.then(t=>{this._active--,e.resolve(t),this.runNext()},t=>{this._active--,e.reject(t),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};exports.Semaphore=i;let a=!1;function o(){a=!0}exports.setTestMode=o;function s(){a=!1}exports.clearTestMode=s;let c=15;var l=class{constructor(e=c){this.yieldAfter=a===!0?Math.max(e,2):Math.max(e,c),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.counter=0,this.total=0,this.counterInterval=1,this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){let e=Date.now()-this.startTime,t=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||t<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}};async function u(e,t,r,i){if(e.length===0)return[];let a=Array(e.length),o=new l(i?.yieldAfter);function s(n){o.start();for(let r=n;r<e.length;r++)if(a[r]=t(e[r]),o.shouldYield())return i?.yieldCallback&&i.yieldCallback(),r+1;return-1}let c=s(0);for(;c!==-1&&!(r!==void 0&&r.isCancellationRequested);)c=await new Promise(e=>{(0,n.RAL)().timer.setImmediate(()=>{e(s(c))})});return a}exports.map=u;async function d(e,t,r,i){if(e.length===0)return[];let a=Array(e.length),o=new l(i?.yieldAfter);async function s(n){o.start();for(let s=n;s<e.length;s++)if(a[s]=await t(e[s],r),o.shouldYield())return i?.yieldCallback&&i.yieldCallback(),s+1;return-1}let c=await s(0);for(;c!==-1&&!(r!==void 0&&r.isCancellationRequested);)c=await new Promise(e=>{(0,n.RAL)().timer.setImmediate(()=>{e(s(c))})});return a}exports.mapAsync=d;async function f(e,t,r,i){if(e.length===0)return;let a=new l(i?.yieldAfter);function o(n){a.start();for(let r=n;r<e.length;r++)if(t(e[r]),a.shouldYield())return i?.yieldCallback&&i.yieldCallback(),r+1;return-1}let s=o(0);for(;s!==-1&&!(r!==void 0&&r.isCancellationRequested);)s=await new Promise(e=>{(0,n.RAL)().timer.setImmediate(()=>{e(o(s))})})}exports.forEach=f}),s=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0});let t=require(`vscode`);var n=class extends t.CompletionItem{constructor(e){super(e)}};exports.default=n}),c=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0});let t=require(`vscode`);var n=class extends t.CodeLens{constructor(e){super(e)}};exports.default=n}),l=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0});let t=require(`vscode`);var n=class extends t.DocumentLink{constructor(e,t){super(e,t)}};exports.default=n}),u=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0});let t=require(`vscode`);var n=class extends t.CodeAction{constructor(e,t){super(e),this.data=t}};exports.default=n}),d=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.ProtocolDiagnostic=exports.DiagnosticCode=void 0;let t=require(`vscode`),n=a();var r;(function(e){function t(e){let t=e;return t!=null&&(n.number(t.value)||n.string(t.value))&&n.string(t.target)}e.is=t})(r||(exports.DiagnosticCode=r={}));var i=class extends t.Diagnostic{constructor(e,t,n,r){super(e,t,n),this.data=r,this.hasDiagnosticCode=!1}};exports.ProtocolDiagnostic=i}),f=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0});let t=require(`vscode`);var n=class extends t.CallHierarchyItem{constructor(e,t,n,r,i,a,o){super(e,t,n,r,i,a),o!==void 0&&(this.data=o)}};exports.default=n}),p=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0});let t=require(`vscode`);var n=class extends t.TypeHierarchyItem{constructor(e,t,n,r,i,a,o){super(e,t,n,r,i,a),o!==void 0&&(this.data=o)}};exports.default=n}),m=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0});let t=require(`vscode`);var n=class extends t.SymbolInformation{constructor(e,n,r,i,a){let o=!(i instanceof t.Uri);super(e,n,r,o?i:new t.Location(i,new t.Range(0,0,0,0))),this.hasRange=o,a!==void 0&&(this.data=a)}};exports.default=n}),h=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0});let t=require(`vscode`);var n=class extends t.InlayHint{constructor(e,t,n){super(e,t,n)}};exports.default=n}),g=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.createConverter=void 0;let n=require(`vscode`),r=t.require_main$1(),i=a(),g=o(),_=s(),v=c(),y=l(),b=u(),x=d(),ee=f(),te=p(),S=m(),ne=h();var C;(function(e){function t(e){let t=e;return t&&!!t.inserting&&!!t.replacing}e.is=t})(C||={});function re(e){let t=e=>e.toString(),a=e||t;function o(e){return a(e)}function s(e){return{uri:a(e.uri)}}function c(e){return{uri:a(e.uri),languageId:e.languageId,version:e.version,text:e.getText()}}function l(e){return{uri:a(e.uri),version:e.version}}function u(e){return{textDocument:c(e)}}function d(e){let t=e;return!!t.document&&!!t.contentChanges}function f(e){let t=e;return!!t.uri&&!!t.version}function p(e,t,n){if(f(e)){let t={textDocument:{uri:a(e.uri),version:e.version},contentChanges:[{text:e.getText()}]};return t}else if(d(e)){let r=t,i=n,o={textDocument:{uri:a(r),version:i},contentChanges:e.contentChanges.map(e=>{let t=e.range;return{range:{start:{line:t.start.line,character:t.start.character},end:{line:t.end.line,character:t.end.character}},rangeLength:e.rangeLength,text:e.text}})};return o}else throw Error(`Unsupported text document change parameter`)}function m(e){return{textDocument:s(e)}}function h(e,t=!1){let n={textDocument:s(e)};return t&&(n.text=e.getText()),n}function re(e){switch(e){case n.TextDocumentSaveReason.Manual:return r.TextDocumentSaveReason.Manual;case n.TextDocumentSaveReason.AfterDelay:return r.TextDocumentSaveReason.AfterDelay;case n.TextDocumentSaveReason.FocusOut:return r.TextDocumentSaveReason.FocusOut}return r.TextDocumentSaveReason.Manual}function ie(e){return{textDocument:s(e.document),reason:re(e.reason)}}function w(e){return{files:e.files.map(e=>({uri:a(e)}))}}function T(e){return{files:e.files.map(e=>({oldUri:a(e.oldUri),newUri:a(e.newUri)}))}}function ae(e){return{files:e.files.map(e=>({uri:a(e)}))}}function oe(e){return{files:e.files.map(e=>({uri:a(e)}))}}function se(e){return{files:e.files.map(e=>({oldUri:a(e.oldUri),newUri:a(e.newUri)}))}}function ce(e){return{files:e.files.map(e=>({uri:a(e)}))}}function le(e,t){return{textDocument:s(e),position:E(t)}}function ue(e){switch(e){case n.CompletionTriggerKind.TriggerCharacter:return r.CompletionTriggerKind.TriggerCharacter;case n.CompletionTriggerKind.TriggerForIncompleteCompletions:return r.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return r.CompletionTriggerKind.Invoked}}function de(e,t,n){return{textDocument:s(e),position:E(t),context:{triggerKind:ue(n.triggerKind),triggerCharacter:n.triggerCharacter}}}function fe(e){switch(e){case n.SignatureHelpTriggerKind.Invoke:return r.SignatureHelpTriggerKind.Invoked;case n.SignatureHelpTriggerKind.TriggerCharacter:return r.SignatureHelpTriggerKind.TriggerCharacter;case n.SignatureHelpTriggerKind.ContentChange:return r.SignatureHelpTriggerKind.ContentChange}}function pe(e){return{label:e.label}}function me(e){return e.map(pe)}function he(e){return{label:e.label,parameters:me(e.parameters)}}function ge(e){return e.map(he)}function _e(e){return e===void 0?e:{signatures:ge(e.signatures),activeSignature:e.activeSignature,activeParameter:e.activeParameter}}function ve(e,t,n){return{textDocument:s(e),position:E(t),context:{isRetrigger:n.isRetrigger,triggerCharacter:n.triggerCharacter,triggerKind:fe(n.triggerKind),activeSignatureHelp:_e(n.activeSignatureHelp)}}}function E(e){return{line:e.line,character:e.character}}function D(e){return e==null?e:{line:e.line>r.uinteger.MAX_VALUE?r.uinteger.MAX_VALUE:e.line,character:e.character>r.uinteger.MAX_VALUE?r.uinteger.MAX_VALUE:e.character}}function ye(e,t){return g.map(e,D,t)}function be(e){return e.map(D)}function O(e){return e==null?e:{start:D(e.start),end:D(e.end)}}function xe(e){return e.map(O)}function Se(e){return e==null?e:r.Location.create(o(e.uri),O(e.range))}function Ce(e){switch(e){case n.DiagnosticSeverity.Error:return r.DiagnosticSeverity.Error;case n.DiagnosticSeverity.Warning:return r.DiagnosticSeverity.Warning;case n.DiagnosticSeverity.Information:return r.DiagnosticSeverity.Information;case n.DiagnosticSeverity.Hint:return r.DiagnosticSeverity.Hint}}function we(e){if(!e)return;let t=[];for(let n of e){let e=Te(n);e!==void 0&&t.push(e)}return t.length>0?t:void 0}function Te(e){switch(e){case n.DiagnosticTag.Unnecessary:return r.DiagnosticTag.Unnecessary;case n.DiagnosticTag.Deprecated:return r.DiagnosticTag.Deprecated;default:return}}function Ee(e){return{message:e.message,location:Se(e.location)}}function De(e){return e.map(Ee)}function Oe(e){if(e!=null)return i.number(e)||i.string(e)?e:{value:e.value,target:o(e.target)}}function ke(e){let t=r.Diagnostic.create(O(e.range),e.message),n=e instanceof x.ProtocolDiagnostic?e:void 0;n!==void 0&&n.data!==void 0&&(t.data=n.data);let a=Oe(e.code);return x.DiagnosticCode.is(a)?n!==void 0&&n.hasDiagnosticCode?t.code=a:(t.code=a.value,t.codeDescription={href:a.target}):t.code=a,i.number(e.severity)&&(t.severity=Ce(e.severity)),Array.isArray(e.tags)&&(t.tags=we(e.tags)),e.relatedInformation&&(t.relatedInformation=De(e.relatedInformation)),e.source&&(t.source=e.source),t}function Ae(e,t){return e==null?e:g.map(e,ke,t)}function je(e){return e==null?e:e.map(ke)}function Me(e,t){switch(e){case`$string`:return t;case r.MarkupKind.PlainText:return{kind:e,value:t};case r.MarkupKind.Markdown:return{kind:e,value:t.value};default:return`Unsupported Markup content received. Kind is: ${e}`}}function k(e){switch(e){case n.CompletionItemTag.Deprecated:return r.CompletionItemTag.Deprecated}}function Ne(e){if(e===void 0)return e;let t=[];for(let n of e){let e=k(n);e!==void 0&&t.push(e)}return t}function Pe(e,t){return t===void 0?e+1:t}function Fe(e,t=!1){let a,o;i.string(e.label)?a=e.label:(a=e.label.label,t&&(e.label.detail!==void 0||e.label.description!==void 0)&&(o={detail:e.label.detail,description:e.label.description}));let s={label:a};o!==void 0&&(s.labelDetails=o);let c=e instanceof _.default?e:void 0;e.detail&&(s.detail=e.detail),e.documentation&&(!c||c.documentationFormat===`$string`?s.documentation=e.documentation:s.documentation=Me(c.documentationFormat,e.documentation)),e.filterText&&(s.filterText=e.filterText),Ie(s,e),i.number(e.kind)&&(s.kind=Pe(e.kind,c&&c.originalItemKind)),e.sortText&&(s.sortText=e.sortText),e.additionalTextEdits&&(s.additionalTextEdits=ze(e.additionalTextEdits)),e.commitCharacters&&(s.commitCharacters=e.commitCharacters.slice()),e.command&&(s.command=M(e.command)),(e.preselect===!0||e.preselect===!1)&&(s.preselect=e.preselect);let l=Ne(e.tags);if(c){if(c.data!==void 0&&(s.data=c.data),c.deprecated===!0||c.deprecated===!1){if(c.deprecated===!0&&l!==void 0&&l.length>0){let e=l.indexOf(n.CompletionItemTag.Deprecated);e!==-1&&l.splice(e,1)}s.deprecated=c.deprecated}c.insertTextMode!==void 0&&(s.insertTextMode=c.insertTextMode)}return l!==void 0&&l.length>0&&(s.tags=l),s.insertTextMode===void 0&&e.keepWhitespace===!0&&(s.insertTextMode=r.InsertTextMode.adjustIndentation),s}function Ie(e,t){let i=r.InsertTextFormat.PlainText,a,o;t.textEdit?(a=t.textEdit.newText,o=t.textEdit.range):t.insertText instanceof n.SnippetString?(i=r.InsertTextFormat.Snippet,a=t.insertText.value):a=t.insertText,t.range&&(o=t.range),e.insertTextFormat=i,t.fromEdit&&a!==void 0&&o!==void 0?e.textEdit=Le(a,o):e.insertText=a}function Le(e,t){return C.is(t)?r.InsertReplaceEdit.create(e,O(t.inserting),O(t.replacing)):{newText:e,range:O(t)}}function Re(e){return{range:O(e.range),newText:e.newText}}function ze(e){return e==null?e:e.map(Re)}function A(e){return e<=n.SymbolKind.TypeParameter?e+1:r.SymbolKind.Property}function Be(e){return e}function j(e){return e.map(Be)}function Ve(e,t,n){return{textDocument:s(e),position:E(t),context:{includeDeclaration:n.includeDeclaration}}}async function He(e,t){let n=r.CodeAction.create(e.title);if(e instanceof b.default&&e.data!==void 0&&(n.data=e.data),e.kind!==void 0&&(n.kind=qe(e.kind)),e.diagnostics!==void 0&&(n.diagnostics=await Ae(e.diagnostics,t)),e.edit!==void 0)throw Error(`VS Code code actions can only be converted to a protocol code action without an edit.`);return e.command!==void 0&&(n.command=M(e.command)),e.isPreferred!==void 0&&(n.isPreferred=e.isPreferred),e.disabled!==void 0&&(n.disabled={reason:e.disabled.reason}),n}function Ue(e){let t=r.CodeAction.create(e.title);if(e instanceof b.default&&e.data!==void 0&&(t.data=e.data),e.kind!==void 0&&(t.kind=qe(e.kind)),e.diagnostics!==void 0&&(t.diagnostics=je(e.diagnostics)),e.edit!==void 0)throw Error(`VS Code code actions can only be converted to a protocol code action without an edit.`);return e.command!==void 0&&(t.command=M(e.command)),e.isPreferred!==void 0&&(t.isPreferred=e.isPreferred),e.disabled!==void 0&&(t.disabled={reason:e.disabled.reason}),t}async function We(e,t){if(e==null)return e;let n;return e.only&&i.string(e.only.value)&&(n=[e.only.value]),r.CodeActionContext.create(await Ae(e.diagnostics,t),n,Ke(e.triggerKind))}function Ge(e){if(e==null)return e;let t;return e.only&&i.string(e.only.value)&&(t=[e.only.value]),r.CodeActionContext.create(je(e.diagnostics),t,Ke(e.triggerKind))}function Ke(e){switch(e){case n.CodeActionTriggerKind.Invoke:return r.CodeActionTriggerKind.Invoked;case n.CodeActionTriggerKind.Automatic:return r.CodeActionTriggerKind.Automatic;default:return}}function qe(e){if(e!=null)return e.value}function Je(e){return e==null?e:r.InlineValueContext.create(e.frameId,O(e.stoppedLocation))}function Ye(e,t,n){return{context:r.InlineCompletionContext.create(n.triggerKind,n.selectedCompletionInfo),textDocument:s(e),position:D(t)}}function M(e){let t=r.Command.create(e.title,e.command);return e.arguments&&(t.arguments=e.arguments),t}function Xe(e){let t=r.CodeLens.create(O(e.range));return e.command&&(t.command=M(e.command)),e instanceof v.default&&e.data&&(t.data=e.data),t}function Ze(e,t){let n={tabSize:e.tabSize,insertSpaces:e.insertSpaces};return t.trimTrailingWhitespace&&(n.trimTrailingWhitespace=!0),t.trimFinalNewlines&&(n.trimFinalNewlines=!0),t.insertFinalNewline&&(n.insertFinalNewline=!0),n}function N(e){return{textDocument:s(e)}}function Qe(e){return{textDocument:s(e)}}function $e(e){let t=r.DocumentLink.create(O(e.range));e.target&&(t.target=o(e.target)),e.tooltip!==void 0&&(t.tooltip=e.tooltip);let n=e instanceof y.default?e:void 0;return n&&n.data&&(t.data=n.data),t}function P(e){return{textDocument:s(e)}}function et(e){let t={name:e.name,kind:A(e.kind),uri:o(e.uri),range:O(e.range),selectionRange:O(e.selectionRange)};return e.detail!==void 0&&e.detail.length>0&&(t.detail=e.detail),e.tags!==void 0&&(t.tags=j(e.tags)),e instanceof ee.default&&e.data!==void 0&&(t.data=e.data),t}function F(e){let t={name:e.name,kind:A(e.kind),uri:o(e.uri),range:O(e.range),selectionRange:O(e.selectionRange)};return e.detail!==void 0&&e.detail.length>0&&(t.detail=e.detail),e.tags!==void 0&&(t.tags=j(e.tags)),e instanceof te.default&&e.data!==void 0&&(t.data=e.data),t}function I(e){let t=e instanceof S.default?{name:e.name,kind:A(e.kind),location:e.hasRange?Se(e.location):{uri:a(e.location.uri)},data:e.data}:{name:e.name,kind:A(e.kind),location:Se(e.location)};return e.tags!==void 0&&(t.tags=j(e.tags)),e.containerName!==``&&(t.containerName=e.containerName),t}function tt(e){let t=typeof e.label==`string`?e.label:e.label.map(nt),n=r.InlayHint.create(D(e.position),t);return e.kind!==void 0&&(n.kind=e.kind),e.textEdits!==void 0&&(n.textEdits=ze(e.textEdits)),e.tooltip!==void 0&&(n.tooltip=rt(e.tooltip)),e.paddingLeft!==void 0&&(n.paddingLeft=e.paddingLeft),e.paddingRight!==void 0&&(n.paddingRight=e.paddingRight),e instanceof ne.default&&e.data!==void 0&&(n.data=e.data),n}function nt(e){let t=r.InlayHintLabelPart.create(e.value);return e.location!==void 0&&(t.location=Se(e.location)),e.command!==void 0&&(t.command=M(e.command)),e.tooltip!==void 0&&(t.tooltip=rt(e.tooltip)),t}function rt(e){if(typeof e==`string`)return e;let t={kind:r.MarkupKind.Markdown,value:e.value};return t}return{asUri:o,asTextDocumentIdentifier:s,asTextDocumentItem:c,asVersionedTextDocumentIdentifier:l,asOpenTextDocumentParams:u,asChangeTextDocumentParams:p,asCloseTextDocumentParams:m,asSaveTextDocumentParams:h,asWillSaveTextDocumentParams:ie,asDidCreateFilesParams:w,asDidRenameFilesParams:T,asDidDeleteFilesParams:ae,asWillCreateFilesParams:oe,asWillRenameFilesParams:se,asWillDeleteFilesParams:ce,asTextDocumentPositionParams:le,asCompletionParams:de,asSignatureHelpParams:ve,asWorkerPosition:E,asRange:O,asRanges:xe,asPosition:D,asPositions:ye,asPositionsSync:be,asLocation:Se,asDiagnosticSeverity:Ce,asDiagnosticTag:Te,asDiagnostic:ke,asDiagnostics:Ae,asDiagnosticsSync:je,asCompletionItem:Fe,asTextEdit:Re,asSymbolKind:A,asSymbolTag:Be,asSymbolTags:j,asReferenceParams:Ve,asCodeAction:He,asCodeActionSync:Ue,asCodeActionContext:We,asCodeActionContextSync:Ge,asInlineValueContext:Je,asCommand:M,asCodeLens:Xe,asFormattingOptions:Ze,asDocumentSymbolParams:N,asCodeLensParams:Qe,asDocumentLink:$e,asDocumentLinkParams:P,asCallHierarchyItem:et,asTypeHierarchyItem:F,asInlayHint:tt,asWorkspaceSymbol:I,asInlineCompletionParams:Ye}}exports.createConverter=re}),_=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.createConverter=void 0;let n=require(`vscode`),r=t.require_main$1(),i=a(),g=o(),_=s(),v=c(),y=l(),b=u(),x=d(),ee=f(),te=p(),S=m(),ne=h(),C=t.require_main$1();var re;(function(e){function t(e){let t=e;return t&&i.string(t.language)&&i.string(t.value)}e.is=t})(re||={});function ie(e,t,a){let o=e=>n.Uri.parse(e),s=e||o;function c(e){return s(e)}function l(e){let t=[];for(let n of e)if(typeof n==`string`)t.push(n);else if(C.NotebookCellTextDocumentFilter.is(n))if(typeof n.notebook==`string`)t.push({notebookType:n.notebook,language:n.language});else{let e=n.notebook.notebookType??`*`;t.push({notebookType:e,scheme:n.notebook.scheme,pattern:n.notebook.pattern,language:n.language})}else C.TextDocumentFilter.is(n)&&t.push({language:n.language,scheme:n.scheme,pattern:n.pattern});return t}async function u(e,t){return g.map(e,f,t)}function d(e){let t=Array(e.length);for(let n=0;n<e.length;n++)t[n]=f(e[n]);return t}function f(e){let t=new x.ProtocolDiagnostic(w(e.range),e.message,ae(e.severity),e.data);if(e.code!==void 0){if(typeof e.code==`string`||typeof e.code==`number`)r.CodeDescription.is(e.codeDescription)?t.code={value:e.code,target:c(e.codeDescription.href)}:t.code=e.code;else if(x.DiagnosticCode.is(e.code)){t.hasDiagnosticCode=!0;let n=e.code;t.code={value:n.value,target:c(n.target)}}}return e.source&&(t.source=e.source),e.relatedInformation&&(t.relatedInformation=p(e.relatedInformation)),Array.isArray(e.tags)&&(t.tags=m(e.tags)),t}function p(e){let t=Array(e.length);for(let r=0;r<e.length;r++){let i=e[r];t[r]=new n.DiagnosticRelatedInformation(we(i.location),i.message)}return t}function m(e){if(!e)return;let t=[];for(let n of e){let e=h(n);e!==void 0&&t.push(e)}return t.length>0?t:void 0}function h(e){switch(e){case r.DiagnosticTag.Unnecessary:return n.DiagnosticTag.Unnecessary;case r.DiagnosticTag.Deprecated:return n.DiagnosticTag.Deprecated;default:return}}function ie(e){return e?new n.Position(e.line,e.character):void 0}function w(e){return e?new n.Range(e.start.line,e.start.character,e.end.line,e.end.character):void 0}async function T(e,t){return g.map(e,e=>new n.Range(e.start.line,e.start.character,e.end.line,e.end.character),t)}function ae(e){if(e==null)return n.DiagnosticSeverity.Error;switch(e){case r.DiagnosticSeverity.Error:return n.DiagnosticSeverity.Error;case r.DiagnosticSeverity.Warning:return n.DiagnosticSeverity.Warning;case r.DiagnosticSeverity.Information:return n.DiagnosticSeverity.Information;case r.DiagnosticSeverity.Hint:return n.DiagnosticSeverity.Hint}return n.DiagnosticSeverity.Error}function oe(e){if(i.string(e))return ce(e);if(re.is(e)){let t=ce();return t.appendCodeblock(e.value,e.language)}else if(Array.isArray(e)){let t=[];for(let n of e){let e=ce();re.is(n)?e.appendCodeblock(n.value,n.language):e.appendMarkdown(n),t.push(e)}return t}else return ce(e)}function se(e){if(i.string(e))return e;switch(e.kind){case r.MarkupKind.Markdown:return ce(e.value);case r.MarkupKind.PlainText:return e.value;default:return`Unsupported Markup content received. Kind is: ${e.kind}`}}function ce(e){let i;if(e===void 0||typeof e==`string`)i=new n.MarkdownString(e);else switch(e.kind){case r.MarkupKind.Markdown:i=new n.MarkdownString(e.value);break;case r.MarkupKind.PlainText:i=new n.MarkdownString,i.appendText(e.value);break;default:i=new n.MarkdownString,i.appendText(`Unsupported Markup content received. Kind is: ${e.kind}`);break}return i.isTrusted=t,i.supportHtml=a,i}function le(e){if(e)return new n.Hover(oe(e.contents),w(e.range))}async function ue(e,t,r){if(!e)return;if(Array.isArray(e))return g.map(e,e=>he(e,t),r);let i=e,{defaultRange:a,commitCharacters:o}=de(i,t),s=await g.map(i.items,e=>he(e,o,a,i.itemDefaults?.insertTextMode,i.itemDefaults?.insertTextFormat,i.itemDefaults?.data),r);return new n.CompletionList(s,i.isIncomplete)}function de(e,t){let n=e.itemDefaults?.editRange,i=e.itemDefaults?.commitCharacters??t;return r.Range.is(n)?{defaultRange:w(n),commitCharacters:i}:n===void 0?{defaultRange:void 0,commitCharacters:i}:{defaultRange:{inserting:w(n.insert),replacing:w(n.replace)},commitCharacters:i}}function fe(e){return r.CompletionItemKind.Text<=e&&e<=r.CompletionItemKind.TypeParameter?[e-1,void 0]:[n.CompletionItemKind.Text,e]}function pe(e){switch(e){case r.CompletionItemTag.Deprecated:return n.CompletionItemTag.Deprecated}}function me(e){if(e==null)return[];let t=[];for(let n of e){let e=pe(n);e!==void 0&&t.push(e)}return t}function he(e,t,a,o,s,c){let l=me(e.tags),u=ge(e),d=new _.default(u);e.detail&&(d.detail=e.detail),e.documentation&&(d.documentation=se(e.documentation),d.documentationFormat=i.string(e.documentation)?`$string`:e.documentation.kind),e.filterText&&(d.filterText=e.filterText);let f=_e(e,a,s);if(f&&(d.insertText=f.text,d.range=f.range,d.fromEdit=f.fromEdit),i.number(e.kind)){let[t,n]=fe(e.kind);d.kind=t,n&&(d.originalItemKind=n)}e.sortText&&(d.sortText=e.sortText),e.additionalTextEdits&&(d.additionalTextEdits=ye(e.additionalTextEdits));let p=e.commitCharacters===void 0?t:i.stringArray(e.commitCharacters)?e.commitCharacters:void 0;p&&(d.commitCharacters=p.slice()),e.command&&(d.command=A(e.command)),(e.deprecated===!0||e.deprecated===!1)&&(d.deprecated=e.deprecated,e.deprecated===!0&&l.push(n.CompletionItemTag.Deprecated)),(e.preselect===!0||e.preselect===!1)&&(d.preselect=e.preselect);let m=e.data??c;m!==void 0&&(d.data=m),l.length>0&&(d.tags=l);let h=e.insertTextMode??o;return h!==void 0&&(d.insertTextMode=h,h===r.InsertTextMode.asIs&&(d.keepWhitespace=!0)),d}function ge(e){return r.CompletionItemLabelDetails.is(e.labelDetails)?{label:e.label,detail:e.labelDetails.detail,description:e.labelDetails.description}:e.label}function _e(e,t,i){let a=e.insertTextFormat??i;if(e.textEdit!==void 0||t!==void 0){let[i,o]=e.textEdit===void 0?[t,e.textEditText??e.label]:ve(e.textEdit);return a===r.InsertTextFormat.Snippet?{text:new n.SnippetString(o),range:i,fromEdit:!0}:{text:o,range:i,fromEdit:!0}}else if(e.insertText)return a===r.InsertTextFormat.Snippet?{text:new n.SnippetString(e.insertText),fromEdit:!1}:{text:e.insertText,fromEdit:!1};else return}function ve(e){return r.InsertReplaceEdit.is(e)?[{inserting:w(e.insert),replacing:w(e.replace)},e.newText]:[w(e.range),e.newText]}function E(e){if(e)return new n.TextEdit(w(e.range),e.newText)}async function D(e,t){if(e)return g.map(e,E,t)}function ye(e){if(!e)return;let t=Array(e.length);for(let n=0;n<e.length;n++)t[n]=E(e[n]);return t}async function be(e,t){if(!e)return;let r=new n.SignatureHelp;return i.number(e.activeSignature)?r.activeSignature=e.activeSignature:r.activeSignature=0,i.number(e.activeParameter)?r.activeParameter=e.activeParameter:r.activeParameter=0,e.signatures&&(r.signatures=await O(e.signatures,t)),r}async function O(e,t){return g.mapAsync(e,xe,t)}async function xe(e,t){let r=new n.SignatureInformation(e.label);return e.documentation!==void 0&&(r.documentation=se(e.documentation)),e.parameters!==void 0&&(r.parameters=await Se(e.parameters,t)),e.activeParameter!==void 0&&(r.activeParameter=e.activeParameter),r}function Se(e,t){return g.map(e,Ce,t)}function Ce(e){let t=new n.ParameterInformation(e.label);return e.documentation&&(t.documentation=se(e.documentation)),t}function we(e){return e?new n.Location(s(e.uri),w(e.range)):void 0}async function Te(e,t){if(e)return Oe(e,t)}async function Ee(e,t){if(e)return Oe(e,t)}function De(e){if(!e)return;let t={targetUri:s(e.targetUri),targetRange:w(e.targetRange),originSelectionRange:w(e.originSelectionRange),targetSelectionRange:w(e.targetSelectionRange)};if(!t.targetSelectionRange)throw Error(`targetSelectionRange must not be undefined or null`);return t}async function Oe(e,t){if(e)if(i.array(e)){if(e.length===0)return[];if(r.LocationLink.is(e[0])){let n=e;return g.map(n,De,t)}else{let n=e;return g.map(n,we,t)}}else if(r.LocationLink.is(e))return[De(e)];else return we(e)}async function ke(e,t){if(e)return g.map(e,we,t)}async function Ae(e,t){if(e)return g.map(e,je,t)}function je(e){let t=new n.DocumentHighlight(w(e.range));return i.number(e.kind)&&(t.kind=Me(e.kind)),t}function Me(e){switch(e){case r.DocumentHighlightKind.Text:return n.DocumentHighlightKind.Text;case r.DocumentHighlightKind.Read:return n.DocumentHighlightKind.Read;case r.DocumentHighlightKind.Write:return n.DocumentHighlightKind.Write}return n.DocumentHighlightKind.Text}async function k(e,t){if(e)return g.map(e,Ie,t)}function Ne(e){return e<=r.SymbolKind.TypeParameter?e-1:n.SymbolKind.Property}function Pe(e){switch(e){case r.SymbolTag.Deprecated:return n.SymbolTag.Deprecated;default:return}}function Fe(e){if(e==null)return;let t=[];for(let n of e){let e=Pe(n);e!==void 0&&t.push(e)}return t.length===0?void 0:t}function Ie(e){let t=e.data,r=e.location,i=r.range===void 0||t!==void 0?new S.default(e.name,Ne(e.kind),e.containerName??``,r.range===void 0?s(r.uri):new n.Location(s(e.location.uri),w(r.range)),t):new n.SymbolInformation(e.name,Ne(e.kind),e.containerName??``,new n.Location(s(e.location.uri),w(r.range)));return ze(i,e),i}async function Le(e,t){if(e!=null)return g.map(e,Re,t)}function Re(e){let t=new n.DocumentSymbol(e.name,e.detail||``,Ne(e.kind),w(e.range),w(e.selectionRange));if(ze(t,e),e.children!==void 0&&e.children.length>0){let n=[];for(let t of e.children)n.push(Re(t));t.children=n}return t}function ze(e,t){e.tags=Fe(t.tags),t.deprecated&&(e.tags?e.tags.includes(n.SymbolTag.Deprecated)||(e.tags=e.tags.concat(n.SymbolTag.Deprecated)):e.tags=[n.SymbolTag.Deprecated])}function A(e){let t={title:e.title,command:e.command};return e.arguments&&(t.arguments=e.arguments),t}async function Be(e,t){if(e)return g.map(e,A,t)}let j=new Map;j.set(r.CodeActionKind.Empty,n.CodeActionKind.Empty),j.set(r.CodeActionKind.QuickFix,n.CodeActionKind.QuickFix),j.set(r.CodeActionKind.Refactor,n.CodeActionKind.Refactor),j.set(r.CodeActionKind.RefactorExtract,n.CodeActionKind.RefactorExtract),j.set(r.CodeActionKind.RefactorInline,n.CodeActionKind.RefactorInline),j.set(r.CodeActionKind.RefactorRewrite,n.CodeActionKind.RefactorRewrite),j.set(r.CodeActionKind.Source,n.CodeActionKind.Source),j.set(r.CodeActionKind.SourceOrganizeImports,n.CodeActionKind.SourceOrganizeImports);function Ve(e){if(e==null)return;let t=j.get(e);if(t)return t;let r=e.split(`.`);t=n.CodeActionKind.Empty;for(let e of r)t=t.append(e);return t}function He(e){if(e!=null)return e.map(e=>Ve(e))}async function Ue(e,t){if(e==null)return;let n=new b.default(e.title,e.data);return e.kind!==void 0&&(n.kind=Ve(e.kind)),e.diagnostics!==void 0&&(n.diagnostics=d(e.diagnostics)),e.edit!==void 0&&(n.edit=await qe(e.edit,t)),e.command!==void 0&&(n.command=A(e.command)),e.isPreferred!==void 0&&(n.isPreferred=e.isPreferred),e.disabled!==void 0&&(n.disabled={reason:e.disabled.reason}),n}function We(e,t){return g.mapAsync(e,async e=>r.Command.is(e)?A(e):Ue(e,t),t)}function Ge(e){if(!e)return;let t=new v.default(w(e.range));return e.command&&(t.command=A(e.command)),e.data!==void 0&&e.data!==null&&(t.data=e.data),t}async function Ke(e,t){if(e)return g.map(e,Ge,t)}async function qe(e,t){if(!e)return;let i=new Map;if(e.changeAnnotations!==void 0){let n=e.changeAnnotations;await g.forEach(Object.keys(n),e=>{let t=Je(n[e]);i.set(e,t)},t)}let a=e=>{if(e!==void 0)return i.get(e)},o=new n.WorkspaceEdit;if(e.documentChanges){let n=e.documentChanges;await g.forEach(n,e=>{if(r.CreateFile.is(e))o.createFile(s(e.uri),e.options,a(e.annotationId));else if(r.RenameFile.is(e))o.renameFile(s(e.oldUri),s(e.newUri),e.options,a(e.annotationId));else if(r.DeleteFile.is(e))o.deleteFile(s(e.uri),e.options,a(e.annotationId));else if(r.TextDocumentEdit.is(e)){let t=s(e.textDocument.uri);for(let n of e.edits)r.AnnotatedTextEdit.is(n)?o.replace(t,w(n.range),n.newText,a(n.annotationId)):o.replace(t,w(n.range),n.newText)}else throw Error(`Unknown workspace edit change received:\n${JSON.stringify(e,void 0,4)}`)},t)}else if(e.changes){let n=e.changes;await g.forEach(Object.keys(n),e=>{o.set(s(e),ye(n[e]))},t)}return o}function Je(e){if(e!==void 0)return{label:e.label,needsConfirmation:!!e.needsConfirmation,description:e.description}}function Ye(e){let t=w(e.range),n=e.target?c(e.target):void 0,r=new y.default(t,n);return e.tooltip!==void 0&&(r.tooltip=e.tooltip),e.data!==void 0&&e.data!==null&&(r.data=e.data),r}async function M(e,t){if(e)return g.map(e,Ye,t)}function Xe(e){return new n.Color(e.red,e.green,e.blue,e.alpha)}function Ze(e){return new n.ColorInformation(w(e.range),Xe(e.color))}async function N(e,t){if(e)return g.map(e,Ze,t)}function Qe(e){let t=new n.ColorPresentation(e.label);return t.additionalTextEdits=ye(e.additionalTextEdits),e.textEdit&&(t.textEdit=E(e.textEdit)),t}async function $e(e,t){if(e)return g.map(e,Qe,t)}function P(e){if(e)switch(e){case r.FoldingRangeKind.Comment:return n.FoldingRangeKind.Comment;case r.FoldingRangeKind.Imports:return n.FoldingRangeKind.Imports;case r.FoldingRangeKind.Region:return n.FoldingRangeKind.Region}}function et(e){return new n.FoldingRange(e.startLine,e.endLine,P(e.kind))}async function F(e,t){if(e)return g.map(e,et,t)}function I(e){return new n.SelectionRange(w(e.range),e.parent?I(e.parent):void 0)}async function tt(e,t){return Array.isArray(e)?g.map(e,I,t):[]}function nt(e){return r.InlineValueText.is(e)?new n.InlineValueText(w(e.range),e.text):r.InlineValueVariableLookup.is(e)?new n.InlineValueVariableLookup(w(e.range),e.variableName,e.caseSensitiveLookup):new n.InlineValueEvaluatableExpression(w(e.range),e.expression)}async function rt(e,t){return Array.isArray(e)?g.map(e,nt,t):[]}async function L(e,t){let n=typeof e.label==`string`?e.label:await g.map(e.label,it,t),r=new ne.default(ie(e.position),n);return e.kind!==void 0&&(r.kind=e.kind),e.textEdits!==void 0&&(r.textEdits=await D(e.textEdits,t)),e.tooltip!==void 0&&(r.tooltip=at(e.tooltip)),e.paddingLeft!==void 0&&(r.paddingLeft=e.paddingLeft),e.paddingRight!==void 0&&(r.paddingRight=e.paddingRight),e.data!==void 0&&(r.data=e.data),r}function it(e){let t=new n.InlayHintLabelPart(e.value);return e.location!==void 0&&(t.location=we(e.location)),e.tooltip!==void 0&&(t.tooltip=at(e.tooltip)),e.command!==void 0&&(t.command=A(e.command)),t}function at(e){return typeof e==`string`?e:ce(e)}async function ot(e,t){if(Array.isArray(e))return g.mapAsync(e,L,t)}function st(e){if(e===null)return;let t=new ee.default(Ne(e.kind),e.name,e.detail||``,c(e.uri),w(e.range),w(e.selectionRange),e.data);return e.tags!==void 0&&(t.tags=Fe(e.tags)),t}async function R(e,t){if(e!==null)return g.map(e,st,t)}async function ct(e,t){return new n.CallHierarchyIncomingCall(st(e.from),await T(e.fromRanges,t))}async function z(e,t){if(e!==null)return g.mapAsync(e,ct,t)}async function lt(e,t){return new n.CallHierarchyOutgoingCall(st(e.to),await T(e.fromRanges,t))}async function ut(e,t){if(e!==null)return g.mapAsync(e,lt,t)}async function dt(e,t){if(e!=null)return new n.SemanticTokens(new Uint32Array(e.data),e.resultId)}function ft(e){return new n.SemanticTokensEdit(e.start,e.deleteCount,e.data===void 0?void 0:new Uint32Array(e.data))}async function B(e,t){if(e!=null)return new n.SemanticTokensEdits(e.edits.map(ft),e.resultId)}function pt(e){return e}async function mt(e,t){if(e!=null)return new n.LinkedEditingRanges(await T(e.ranges,t),ht(e.wordPattern))}function ht(e){if(e!=null)return new RegExp(e)}function gt(e){if(e===null)return;let t=new te.default(Ne(e.kind),e.name,e.detail||``,c(e.uri),w(e.range),w(e.selectionRange),e.data);return e.tags!==void 0&&(t.tags=Fe(e.tags)),t}async function _t(e,t){if(e!==null)return g.map(e,gt,t)}function vt(e){if(i.string(e))return e;if(r.RelativePattern.is(e)){if(r.URI.is(e.baseUri))return new n.RelativePattern(c(e.baseUri),e.pattern);if(r.WorkspaceFolder.is(e.baseUri)){let t=n.workspace.getWorkspaceFolder(c(e.baseUri.uri));return t===void 0?void 0:new n.RelativePattern(t,e.pattern)}}}async function yt(e,t){if(!e)return;if(Array.isArray(e))return g.map(e,e=>bt(e),t);let r=e,i=await g.map(r.items,e=>bt(e),t);return new n.InlineCompletionList(i)}function bt(e){let t;t=typeof e.insertText==`string`?e.insertText:new n.SnippetString(e.insertText.value);let r;e.command&&(r=A(e.command));let i=new n.InlineCompletionItem(t,w(e.range),r);return e.filterText&&(i.filterText=e.filterText),i}return{asUri:c,asDocumentSelector:l,asDiagnostics:u,asDiagnostic:f,asRange:w,asRanges:T,asPosition:ie,asDiagnosticSeverity:ae,asDiagnosticTag:h,asHover:le,asCompletionResult:ue,asCompletionItem:he,asTextEdit:E,asTextEdits:D,asSignatureHelp:be,asSignatureInformations:O,asSignatureInformation:xe,asParameterInformations:Se,asParameterInformation:Ce,asDeclarationResult:Te,asDefinitionResult:Ee,asLocation:we,asReferences:ke,asDocumentHighlights:Ae,asDocumentHighlight:je,asDocumentHighlightKind:Me,asSymbolKind:Ne,asSymbolTag:Pe,asSymbolTags:Fe,asSymbolInformations:k,asSymbolInformation:Ie,asDocumentSymbols:Le,asDocumentSymbol:Re,asCommand:A,asCommands:Be,asCodeAction:Ue,asCodeActionKind:Ve,asCodeActionKinds:He,asCodeActionResult:We,asCodeLens:Ge,asCodeLenses:Ke,asWorkspaceEdit:qe,asDocumentLink:Ye,asDocumentLinks:M,asFoldingRangeKind:P,asFoldingRange:et,asFoldingRanges:F,asColor:Xe,asColorInformation:Ze,asColorInformations:N,asColorPresentation:Qe,asColorPresentations:$e,asSelectionRange:I,asSelectionRanges:tt,asInlineValue:nt,asInlineValues:rt,asInlayHint:L,asInlayHints:ot,asSemanticTokensLegend:pt,asSemanticTokens:dt,asSemanticTokensEdit:ft,asSemanticTokensEdits:B,asCallHierarchyItem:st,asCallHierarchyItems:R,asCallHierarchyIncomingCall:ct,asCallHierarchyIncomingCalls:z,asCallHierarchyOutgoingCall:lt,asCallHierarchyOutgoingCalls:ut,asLinkedEditingRanges:mt,asTypeHierarchyItem:gt,asTypeHierarchyItems:_t,asGlobPattern:vt,asInlineCompletionResult:yt,asInlineCompletionItem:bt}}exports.createConverter=ie}),v=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.generateUuid=exports.parse=exports.isUUID=exports.v4=exports.empty=void 0;var t=class{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},n=class e extends t{static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return e._oneOf(e._chars)}constructor(){super([e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),`-`,e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),`-`,`4`,e._randomHex(),e._randomHex(),e._randomHex(),`-`,e._oneOf(e._timeHighBits),e._randomHex(),e._randomHex(),e._randomHex(),`-`,e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex(),e._randomHex()].join(``))}};n._chars=[`0`,`1`,`2`,`3`,`4`,`5`,`6`,`6`,`7`,`8`,`9`,`a`,`b`,`c`,`d`,`e`,`f`],n._timeHighBits=[`8`,`9`,`a`,`b`],exports.empty=new t(`00000000-0000-0000-0000-000000000000`);function r(){return new n}exports.v4=r;let i=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function a(e){return i.test(e)}exports.isUUID=a;function o(e){if(!a(e))throw Error(`invalid uuid`);return new t(e)}exports.parse=o;function s(){return r().asHex()}exports.generateUuid=s}),y=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.ProgressPart=void 0;let n=require(`vscode`),r=t.require_main$1(),i=a();var o=class{constructor(e,t,n){this._client=e,this._token=t,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(r.WorkDoneProgress.type,this._token,e=>{switch(e.kind){case`begin`:this.begin(e);break;case`report`:this.report(e);break;case`end`:this.done(),n&&n(this);break}})}begin(e){this._infinite=e.percentage===void 0,this._lspProgressDisposable!==void 0&&n.window.withProgress({location:n.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},async(t,n)=>{if(this._lspProgressDisposable!==void 0)return this._progress=t,this._cancellationToken=n,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(r.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((e,t)=>{this._resolve=e,this._reject=t})})}report(e){if(this._infinite&&i.string(e.message))this._progress!==void 0&&this._progress.report({message:e.message});else if(i.number(e.percentage)){let t=Math.max(0,Math.min(e.percentage,100)),n=Math.max(0,t-this._reported);this._reported+=n,this._progress!==void 0&&this._progress.report({message:e.message,increment:n})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}};exports.ProgressPart=o}),b=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.WorkspaceFeature=exports.TextDocumentLanguageFeature=exports.TextDocumentEventFeature=exports.DynamicDocumentFeature=exports.DynamicFeature=exports.StaticFeature=exports.ensure=exports.LSPCancellationError=void 0;let n=require(`vscode`),r=t.require_main$1(),i=a(),o=v();var s=class extends n.CancellationError{constructor(e){super(),this.data=e}};exports.LSPCancellationError=s;function c(e,t){return e[t]===void 0&&(e[t]={}),e[t]}exports.ensure=c;var l;(function(e){function t(e){let t=e;return t!=null&&i.func(t.fillClientCapabilities)&&i.func(t.initialize)&&i.func(t.getState)&&i.func(t.clear)&&(t.fillInitializeParams===void 0||i.func(t.fillInitializeParams))}e.is=t})(l||(exports.StaticFeature=l={}));var u;(function(e){function t(e){let t=e;return t!=null&&i.func(t.fillClientCapabilities)&&i.func(t.initialize)&&i.func(t.getState)&&i.func(t.clear)&&(t.fillInitializeParams===void 0||i.func(t.fillInitializeParams))&&i.func(t.register)&&i.func(t.unregister)&&t.registrationType!==void 0}e.is=t})(u||(exports.DynamicFeature=u={}));var d=class{constructor(e){this._client=e}getState(){let e=this.getDocumentSelectors(),t=0;for(let r of e){t++;for(let e of n.workspace.textDocuments)if(n.languages.match(r,e)>0)return{kind:`document`,id:this.registrationType.method,registrations:!0,matches:!0}}let r=t>0;return{kind:`document`,id:this.registrationType.method,registrations:r,matches:!1}}};exports.DynamicDocumentFeature=d;var f=class extends d{static textDocumentFilter(e,t){for(let r of e)if(n.languages.match(r,t)>0)return!0;return!1}constructor(e,t,r,i,a,o,s){super(e),this._event=t,this._type=r,this._middleware=i,this._createParams=a,this._textDocument=o,this._selectorFilter=s,this._selectors=new Map,this._onNotificationSent=new n.EventEmitter}getStateInfo(){return[this._selectors.values(),!1]}getDocumentSelectors(){return this._selectors.values()}register(e){e.registerOptions.documentSelector&&(this._listener||=this._event(e=>{this.callback(e).catch(e=>{this._client.error(`Sending document notification ${this._type.method} failed.`,e)})}),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){let t=async e=>{let t=this._createParams(e);await this._client.sendNotification(this._type,t),this.notificationSent(this.getTextDocument(e),this._type,t)};if(this.matches(e)){let n=this._middleware();return n?n(e,e=>t(e)):t(e)}}matches(e){return this._client.hasDedicatedTextSynchronizationFeature(this._textDocument(e))?!1:!this._selectorFilter||this._selectorFilter(this._selectors.values(),e)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,n){this._onNotificationSent.fire({textDocument:e,type:t,params:n})}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(let t of this._selectors.values())if(n.languages.match(t,e)>0)return{send:e=>this.callback(e)}}};exports.TextDocumentEventFeature=f;var p=class extends d{constructor(e,t){super(e),this._registrationType=t,this._registrations=new Map}*getDocumentSelectors(){for(let e of this._registrations.values()){let t=e.data.registerOptions.documentSelector;if(t===null)continue;yield this._client.protocol2CodeConverter.asDocumentSelector(t)}}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,t){if(t){if(r.TextDocumentRegistrationOptions.is(t)){let n=r.StaticRegistrationOptions.hasId(t)?t.id:o.generateUuid(),i=t.documentSelector??e;if(i)return[n,Object.assign({},t,{documentSelector:i})]}else if(i.boolean(t)&&t===!0||r.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];let n=i.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[o.generateUuid(),n]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(e,t){if(!(!e||!t))return i.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(let t of this._registrations.values()){let r=t.data.registerOptions.documentSelector;if(r!==null&&n.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(r),e)>0)return t.provider}}getAllProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};exports.TextDocumentLanguageFeature=p;var m=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}getState(){let e=this._registrations.size>0;return{kind:`workspace`,id:this._registrationType.method,registrations:e}}get registrationType(){return this._registrationType}register(e){let t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};exports.WorkspaceFeature=m}),x=e.__commonJSMin((exports,t)=>{let n=typeof process==`object`&&process&&process.platform===`win32`;t.exports=n?{sep:`\\`}:{sep:`/`}}),ee=e.__commonJSMin((exports,n)=>{let r=n.exports=(e,t,n={})=>(y(t),!n.nocomment&&t.charAt(0)===`#`?!1:new C(t,n).match(e));n.exports=r;let i=x();r.sep=i.sep;let a=Symbol(`globstar **`);r.GLOBSTAR=a;let o=e.require_brace_expansion(),s={"!":{open:`(?:(?!(?:`,close:`))[^/]*?)`},"?":{open:`(?:`,close:`)?`},"+":{open:`(?:`,close:`)+`},"*":{open:`(?:`,close:`)*`},"@":{open:`(?:`,close:`)`}},c=`[^/]`,l=c+`*?`,u=`(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?`,d=`(?:(?!(?:\\/|^)\\.).)*?`,f=e=>e.split(``).reduce((e,t)=>(e[t]=!0,e),{}),p=f(`().*{}+?[]^$\\!`),m=f(`[.(`),h=/\/+/;r.filter=(e,t={})=>(n,i,a)=>r(n,e,t);let g=(e,t={})=>{let n={};return Object.keys(e).forEach(t=>n[t]=e[t]),Object.keys(t).forEach(e=>n[e]=t[e]),n};r.defaults=e=>{if(!e||typeof e!=`object`||!Object.keys(e).length)return r;let t=r,n=(n,r,i)=>t(n,r,g(e,i));return n.Minimatch=class extends t.Minimatch{constructor(t,n){super(t,g(e,n))}},n.Minimatch.defaults=n=>t.defaults(g(e,n)).Minimatch,n.filter=(n,r)=>t.filter(n,g(e,r)),n.defaults=n=>t.defaults(g(e,n)),n.makeRe=(n,r)=>t.makeRe(n,g(e,r)),n.braceExpand=(n,r)=>t.braceExpand(n,g(e,r)),n.match=(n,r,i)=>t.match(n,r,g(e,i)),n},r.braceExpand=(e,t)=>_(e,t);let _=(e,t={})=>(y(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:o(e)),v=1024*64,y=e=>{if(typeof e!=`string`)throw TypeError(`invalid pattern`);if(e.length>v)throw TypeError(`pattern is too long`)},b=Symbol(`subparse`);r.makeRe=(e,t)=>new C(e,t||{}).makeRe(),r.match=(e,t,n={})=>{let r=new C(t,n);return e=e.filter(e=>r.match(e)),r.options.nonull&&!e.length&&e.push(t),e};let ee=e=>e.replace(/\\(.)/g,`$1`),te=e=>e.replace(/\\([^-\]])/g,`$1`),S=e=>e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,`\\$&`),ne=e=>e.replace(/[[\]\\]/g,`\\$&`);var C=class{constructor(e,t){y(e),t||={},this.options=t,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,`/`)),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){let e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)===`#`){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();let n=this.globSet=this.braceExpand();t.debug&&(this.debug=(...e)=>console.error(...e)),this.debug(this.pattern,n),n=this.globParts=n.map(e=>e.split(h)),this.debug(this.pattern,n),n=n.map((e,t,n)=>e.map(this.parse,this)),this.debug(this.pattern,n),n=n.filter(e=>e.indexOf(!1)===-1),this.debug(this.pattern,n),this.set=n}parseNegate(){if(this.options.nonegate)return;let e=this.pattern,t=!1,n=0;for(let r=0;r<e.length&&e.charAt(r)===`!`;r++)t=!t,n++;n&&(this.pattern=e.slice(n)),this.negate=t}matchOne(e,t,n){var r=this.options;this.debug(`matchOne`,{this:this,file:e,pattern:t}),this.debug(`matchOne`,e.length,t.length);for(var i=0,o=0,s=e.length,c=t.length;i<s&&o<c;i++,o++){this.debug(`matchOne loop`);var l=t[o],u=e[i];if(this.debug(t,l,u),l===!1)return!1;if(l===a){this.debug(`GLOBSTAR`,[t,l,u]);var d=i,f=o+1;if(f===c){for(this.debug(`** at the end`);i<s;i++)if(e[i]===`.`||e[i]===`..`||!r.dot&&e[i].charAt(0)===`.`)return!1;return!0}for(;d<s;){var p=e[d];if(this.debug(`
globstar while`,e,d,t,f,p),this.matchOne(e.slice(d),t.slice(f),n))return this.debug(`globstar found match!`,d,s,p),!0;if(p===`.`||p===`..`||!r.dot&&p.charAt(0)===`.`){this.debug(`dot detected!`,e,d,t,f);break}this.debug(`globstar swallow a segment, and continue`),d++}return!!(n&&(this.debug(`
>>> no match, partial?`,e,d,t,f),d===s))}var m;if(typeof l==`string`?(m=u===l,this.debug(`string match`,l,u,m)):(m=u.match(l),this.debug(`pattern match`,l,u,m)),!m)return!1}if(i===s&&o===c)return!0;if(i===s)return n;if(o===c)return i===s-1&&e[i]===``;throw Error(`wtf?`)}braceExpand(){return _(this.pattern,this.options)}parse(e,t){y(e);let n=this.options;if(e===`**`)if(n.noglobstar)e=`*`;else return a;if(e===``)return``;let r=``,i=!1,o=!1,u=[],d=[],f,h=!1,g=-1,_=-1,v,x,S,C=e.charAt(0)===`.`,re=n.dot||C,ie=()=>C?``:re?`(?!(?:^|\\/)\\.{1,2}(?:$|\\/))`:`(?!\\.)`,w=e=>e.charAt(0)===`.`?``:n.dot?`(?!(?:^|\\/)\\.{1,2}(?:$|\\/))`:`(?!\\.)`,T=()=>{if(f){switch(f){case`*`:r+=l,i=!0;break;case`?`:r+=c,i=!0;break;default:r+=`\\`+f;break}this.debug(`clearStateChar %j %j`,f,r),f=!1}};for(let t=0,a;t<e.length&&(a=e.charAt(t));t++){if(this.debug(`%s	%s %s %j`,e,t,r,a),o){if(a===`/`)return!1;p[a]&&(r+=`\\`),r+=a,o=!1;continue}switch(a){case`/`:return!1;case`\\`:if(h&&e.charAt(t+1)===`-`){r+=a;continue}T(),o=!0;continue;case`?`:case`*`:case`+`:case`@`:case`!`:if(this.debug(`%s	%s %s %j <-- stateChar`,e,t,r,a),h){this.debug(`  in class`),a===`!`&&t===_+1&&(a=`^`),r+=a;continue}this.debug(`call clearStateChar %j`,f),T(),f=a,n.noext&&T();continue;case`(`:{if(h){r+=`(`;continue}if(!f){r+=`\\(`;continue}let n={type:f,start:t-1,reStart:r.length,open:s[f].open,close:s[f].close};this.debug(this.pattern,`	`,n),u.push(n),r+=n.open,n.start===0&&n.type!==`!`&&(C=!0,r+=w(e.slice(t+1))),this.debug(`plType %j %j`,f,r),f=!1;continue}case`)`:{let e=u[u.length-1];if(h||!e){r+=`\\)`;continue}u.pop(),T(),i=!0,x=e,r+=x.close,x.type===`!`&&d.push(Object.assign(x,{reEnd:r.length}));continue}case`|`:{let n=u[u.length-1];if(h||!n){r+=`\\|`;continue}T(),r+=`|`,n.start===0&&n.type!==`!`&&(C=!0,r+=w(e.slice(t+1)));continue}case`[`:if(T(),h){r+=`\\`+a;continue}h=!0,_=t,g=r.length,r+=a;continue;case`]`:if(t===_+1||!h){r+=`\\`+a;continue}v=e.substring(_+1,t);try{RegExp(`[`+ne(te(v))+`]`),r+=a}catch{r=r.substring(0,g)+`(?:$.)`}i=!0,h=!1;continue;default:T(),p[a]&&!(a===`^`&&h)&&(r+=`\\`),r+=a;break}}for(h&&(v=e.slice(_+1),S=this.parse(v,b),r=r.substring(0,g)+`\\[`+S[0],i||=S[1]),x=u.pop();x;x=u.pop()){let e;e=r.slice(x.reStart+x.open.length),this.debug(`setting tail`,r,x),e=e.replace(/((?:\\{2}){0,64})(\\?)\|/g,(e,t,n)=>(n||=`\\`,t+t+n+`|`)),this.debug(`tail=%j
   %s`,e,e,x,r);let t=x.type===`*`?l:x.type===`?`?c:`\\`+x.type;i=!0,r=r.slice(0,x.reStart)+t+`\\(`+e}T(),o&&(r+=`\\\\`);let ae=m[r.charAt(0)];for(let e=d.length-1;e>-1;e--){let n=d[e],i=r.slice(0,n.reStart),a=r.slice(n.reStart,n.reEnd-8),o=r.slice(n.reEnd),s=r.slice(n.reEnd-8,n.reEnd)+o,c=i.split(`)`).length,l=i.split(`(`).length-c,u=o;for(let e=0;e<l;e++)u=u.replace(/\)[+*?]?/,``);o=u;let f=o===``&&t!==b?`(?:$|\\/)`:``;r=i+a+o+f+s}if(r!==``&&i&&(r=`(?=.)`+r),ae&&(r=ie()+r),t===b)return[r,i];if(n.nocase&&!i&&(i=e.toUpperCase()!==e.toLowerCase()),!i)return ee(e);let oe=n.nocase?`i`:``;try{return Object.assign(RegExp(`^`+r+`$`,oe),{_glob:e,_src:r})}catch{return RegExp(`$.`)}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let t=this.options,n=t.noglobstar?l:t.dot?u:d,r=t.nocase?`i`:``,i=e.map(e=>(e=e.map(e=>typeof e==`string`?S(e):e===a?a:e._src).reduce((e,t)=>(e[e.length-1]===a&&t===a||e.push(t),e),[]),e.forEach((t,r)=>{t!==a||e[r-1]===a||(r===0?e.length>1?e[r+1]=`(?:\\/|`+n+`\\/)?`+e[r+1]:e[r]=n:r===e.length-1?e[r-1]+=`(?:\\/|`+n+`)?`:(e[r-1]+=`(?:\\/|\\/`+n+`\\/)`+e[r+1],e[r+1]=a))}),e.filter(e=>e!==a).join(`/`))).join(`|`);i=`^(?:`+i+`)$`,this.negate&&(i=`^(?!`+i+`).*$`);try{this.regexp=new RegExp(i,r)}catch{this.regexp=!1}return this.regexp}match(e,t=this.partial){if(this.debug(`match`,e,this.pattern),this.comment)return!1;if(this.empty)return e===``;if(e===`/`&&t)return!0;let n=this.options;i.sep!==`/`&&(e=e.split(i.sep).join(`/`)),e=e.split(h),this.debug(this.pattern,`split`,e);let r=this.set;this.debug(this.pattern,`set`,r);let a;for(let t=e.length-1;t>=0&&(a=e[t],!a);t--);for(let i=0;i<r.length;i++){let o=r[i],s=e;n.matchBase&&o.length===1&&(s=[a]);let c=this.matchOne(s,o,t);if(c)return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}static defaults(e){return r.defaults(e).Minimatch}};r.Minimatch=C}),te=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.DiagnosticFeature=exports.DiagnosticPullMode=exports.vsdiag=void 0;let n=ee(),r=require(`vscode`),i=t.require_main$1(),a=v(),o=b();function s(e,t){return e[t]===void 0&&(e[t]={}),e[t]}var c;(function(e){let t;(function(e){e.full=`full`,e.unChanged=`unChanged`})(t=e.DocumentDiagnosticReportKind||={})})(c||(exports.vsdiag=c={}));var l;(function(e){e.onType=`onType`,e.onSave=`onSave`})(l||(exports.DiagnosticPullMode=l={}));var u;(function(e){e.active=`open`,e.reschedule=`reschedule`,e.outDated=`drop`})(u||={});var d=class e{constructor(){this.open=new Set,this._onOpen=new r.EventEmitter,this._onClose=new r.EventEmitter,e.fillTabResources(this.open);let t=t=>{if(t.closed.length===0&&t.opened.length===0)return;let n=this.open,i=new Set;e.fillTabResources(i);let a=new Set,o=new Set(i);for(let e of n.values())i.has(e)?o.delete(e):a.add(e);if(this.open=i,a.size>0){let e=new Set;for(let t of a)e.add(r.Uri.parse(t));this._onClose.fire(e)}if(o.size>0){let e=new Set;for(let t of o)e.add(r.Uri.parse(t));this._onOpen.fire(e)}};r.window.tabGroups.onDidChangeTabs===void 0?this.disposable={dispose:()=>{}}:this.disposable=r.window.tabGroups.onDidChangeTabs(t)}get onClose(){return this._onClose.event}get onOpen(){return this._onOpen.event}dispose(){this.disposable.dispose()}isActive(e){return e instanceof r.Uri?r.window.activeTextEditor?.document.uri===e:r.window.activeTextEditor?.document===e}isVisible(e){let t=e instanceof r.Uri?e:e.uri;return this.open.has(t.toString())}getTabResources(){let t=new Set;return e.fillTabResources(new Set,t),t}static fillTabResources(e,t){let n=e??new Set;for(let e of r.window.tabGroups.all)for(let i of e.tabs){let e=i.input,a;e instanceof r.TabInputText?a=e.uri:e instanceof r.TabInputTextDiff?a=e.modified:e instanceof r.TabInputCustom&&(a=e.uri),a!==void 0&&!n.has(a.toString())&&(n.add(a.toString()),t!==void 0&&t.add(a))}}},f;(function(e){e[e.document=1]=`document`,e[e.workspace=2]=`workspace`})(f||={});var p;(function(e){function t(e){return e instanceof r.Uri?e.toString():e.uri.toString()}e.asKey=t})(p||={});var m=class{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,t,n){let i=e===f.document?this.documentPullStates:this.workspacePullStates,[a,o,s]=t instanceof r.Uri?[t.toString(),t,n]:[t.uri.toString(),t.uri,t.version],c=i.get(a);return c===void 0&&(c={document:o,pulledVersion:s,resultId:void 0},i.set(a,c)),c}update(e,t,n,i){let a=e===f.document?this.documentPullStates:this.workspacePullStates,[o,s,c,l]=t instanceof r.Uri?[t.toString(),t,n,i]:[t.uri.toString(),t.uri,t.version,n],u=a.get(o);u===void 0?(u={document:s,pulledVersion:c,resultId:l},a.set(o,u)):(u.pulledVersion=c,u.resultId=l)}unTrack(e,t){let n=p.asKey(t),r=e===f.document?this.documentPullStates:this.workspacePullStates;r.delete(n)}tracks(e,t){let n=p.asKey(t),r=e===f.document?this.documentPullStates:this.workspacePullStates;return r.has(n)}getResultId(e,t){let n=p.asKey(t),r=e===f.document?this.documentPullStates:this.workspacePullStates;return r.get(n)?.resultId}getAllResultIds(){let e=[];for(let[t,n]of this.workspacePullStates)this.documentPullStates.has(t)&&(n=this.documentPullStates.get(t)),n.resultId!==void 0&&e.push({uri:t,value:n.resultId});return e}},h=class{constructor(e,t,n){this.client=e,this.tabs=t,this.options=n,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new r.EventEmitter,this.provider=this.createProvider(),this.diagnostics=r.languages.createDiagnosticCollection(n.identifier),this.openRequests=new Map,this.documentStates=new m,this.workspaceErrorCounter=0}knows(e,t){let n=t instanceof r.Uri?t:t.uri;return this.documentStates.tracks(e,t)||this.openRequests.has(n.toString())}forget(e,t){this.documentStates.unTrack(e,t)}pull(e,t){if(this.isDisposed)return;let n=e instanceof r.Uri?e:e.uri;this.pullAsync(e).then(()=>{t&&t()},e=>{this.client.error(`Document pull failed for text document ${n.toString()}`,e,!1)})}async pullAsync(e,t){if(this.isDisposed)return;let n=e instanceof r.Uri,a=n?e:e.uri,s=a.toString();t=n?t:e.version;let l=this.openRequests.get(s),d=n?this.documentStates.track(f.document,e,t):this.documentStates.track(f.document,e);if(l===void 0){let n=new r.CancellationTokenSource;this.openRequests.set(s,{state:u.active,document:e,version:t,tokenSource:n});let l,p;try{l=await this.provider.provideDiagnostics(e,d.resultId,n.token)??{kind:c.DocumentDiagnosticReportKind.full,items:[]}}catch(t){if(t instanceof o.LSPCancellationError&&i.DiagnosticServerCancellationData.is(t.data)&&t.data.retriggerRequest===!1&&(p={state:u.outDated,document:e}),p===void 0&&t instanceof r.CancellationError)p={state:u.reschedule,document:e};else throw t}if(p??=this.openRequests.get(s),p===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${s}`),this.diagnostics.delete(a);return}if(this.openRequests.delete(s),!this.tabs.isVisible(e)){this.documentStates.unTrack(f.document,e);return}if(p.state===u.outDated)return;l!==void 0&&(l.kind===c.DocumentDiagnosticReportKind.full&&this.diagnostics.set(a,l.items),d.pulledVersion=t,d.resultId=l.resultId),p.state===u.reschedule&&this.pull(e)}else l.state===u.active?(l.tokenSource.cancel(),this.openRequests.set(s,{state:u.reschedule,document:l.document})):l.state===u.outDated&&this.openRequests.set(s,{state:u.reschedule,document:l.document})}forgetDocument(e){let t=e instanceof r.Uri?e:e.uri,n=t.toString(),i=this.openRequests.get(n);this.options.workspaceDiagnostics?i===void 0?this.pull(e,()=>{this.forget(f.document,e)}):this.openRequests.set(n,{state:u.reschedule,document:e}):(i!==void 0&&(i.state===u.active&&i.tokenSource.cancel(),this.openRequests.set(n,{state:u.outDated,document:e})),this.diagnostics.delete(t),this.forget(f.document,e))}pullWorkspace(){this.isDisposed||this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,i.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},e=>{!(e instanceof o.LSPCancellationError)&&!i.DiagnosticServerCancellationData.is(e.data)&&(this.client.error(`Workspace diagnostic pull failed.`,e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,i.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics||this.isDisposed)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new r.CancellationTokenSource;let e=this.documentStates.getAllResultIds().map(e=>({uri:this.client.protocol2CodeConverter.asUri(e.uri),value:e.value}));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,e=>{if(!(!e||this.isDisposed))for(let t of e.items)t.kind===c.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(f.document,t.uri)||this.diagnostics.set(t.uri,t.items)),this.documentStates.update(f.workspace,t.uri,t.version??void 0,t.resultId)})}createProvider(){let e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(e,t,n)=>{let a=(e,t,n)=>{let a={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(e instanceof r.Uri?e:e.uri)},previousResultId:t};return this.isDisposed===!0||!this.client.isRunning()?{kind:c.DocumentDiagnosticReportKind.full,items:[]}:this.client.sendRequest(i.DocumentDiagnosticRequest.type,a,n).then(async e=>e==null||this.isDisposed||n.isCancellationRequested?{kind:c.DocumentDiagnosticReportKind.full,items:[]}:e.kind===i.DocumentDiagnosticReportKind.Full?{kind:c.DocumentDiagnosticReportKind.full,resultId:e.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(e.items,n)}:{kind:c.DocumentDiagnosticReportKind.unChanged,resultId:e.resultId},e=>this.client.handleFailedRequest(i.DocumentDiagnosticRequest.type,n,e,{kind:c.DocumentDiagnosticReportKind.full,items:[]}))},o=this.client.middleware;return o.provideDiagnostics?o.provideDiagnostics(e,t,n,a):a(e,t,n)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(e,t,n)=>{let r=async e=>e.kind===i.DocumentDiagnosticReportKind.Full?{kind:c.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(e.uri),resultId:e.resultId,version:e.version,items:await this.client.protocol2CodeConverter.asDiagnostics(e.items,t)}:{kind:c.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(e.uri),resultId:e.resultId,version:e.version},o=e=>{let t=[];for(let n of e)t.push({uri:this.client.code2ProtocolConverter.asUri(n.uri),value:n.value});return t},s=(e,t)=>{let s=(0,a.generateUuid)(),c=this.client.onProgress(i.WorkspaceDiagnosticRequest.partialResult,s,async e=>{if(e==null){n(null);return}let t={items:[]};for(let n of e.items)try{t.items.push(await r(n))}catch(e){this.client.error(`Converting workspace diagnostics failed.`,e)}n(t)}),l={identifier:this.options.identifier,previousResultIds:o(e),partialResultToken:s};return this.isDisposed===!0||!this.client.isRunning()?{items:[]}:this.client.sendRequest(i.WorkspaceDiagnosticRequest.type,l,t).then(async e=>{if(t.isCancellationRequested)return{items:[]};let i={items:[]};for(let t of e.items)i.items.push(await r(t));return c.dispose(),n(i),{items:[]}},e=>(c.dispose(),this.client.handleFailedRequest(i.DocumentDiagnosticRequest.type,t,e,{items:[]})))},l=this.client.middleware;return l.provideWorkspaceDiagnostics?l.provideWorkspaceDiagnostics(e,t,n,s):s(e,t,n)}),e}dispose(){this.isDisposed=!0,this.workspaceCancellation?.cancel(),this.workspaceTimeout?.dispose();for(let[e,t]of this.openRequests)t.state===u.active&&t.tokenSource.cancel(),this.openRequests.set(e,{state:u.outDated,document:t.document});this.diagnostics.dispose()}},g=class{constructor(e){this.diagnosticRequestor=e,this.documents=new i.LinkedMap,this.isDisposed=!1}add(e){if(this.isDisposed===!0)return;let t=p.asKey(e);this.documents.has(t)||(this.documents.set(t,e,i.Touch.Last),this.trigger())}remove(e){let t=p.asKey(e);this.documents.delete(t),this.documents.size===0?this.stop():t===this.endDocumentKey()&&(this.endDocument=this.documents.last)}trigger(){if(this.isDisposed!==!0){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,i.RAL)().timer.setInterval(()=>{let e=this.documents.first;if(e!==void 0){let t=p.asKey(e);this.diagnosticRequestor.pull(e),this.documents.set(t,e,i.Touch.Last),t===this.endDocumentKey()&&this.stop()}},200)}}dispose(){this.isDisposed=!0,this.stop(),this.documents.clear()}stop(){this.intervalHandle?.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}endDocumentKey(){return this.endDocument===void 0?void 0:p.asKey(this.endDocument)}},_=class{constructor(e,t,a){let o=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},s=e.protocol2CodeConverter.asDocumentSelector(a.documentSelector),c=[],u=e=>{let t=a.documentSelector;if(o.match!==void 0)return o.match(t,e);for(let r of t){if(!i.TextDocumentFilter.is(r))continue;if(typeof r==`string`||r.language!==void 0&&r.language!==`*`||r.scheme!==void 0&&r.scheme!==`*`&&r.scheme!==e.scheme)return!1;if(r.pattern!==void 0){let t=new n.Minimatch(r.pattern,{noext:!0});if(!t.makeRe()||!t.match(e.fsPath))return!1}}return!0},d=e=>e instanceof r.Uri?u(e):r.languages.match(s,e)>0&&t.isVisible(e),p=e=>e instanceof r.Uri?this.activeTextDocument?.uri.toString()===e.toString():this.activeTextDocument===e;this.diagnosticRequestor=new h(e,t,a),this.backgroundScheduler=new g(this.diagnosticRequestor);let m=e=>{!d(e)||!a.interFileDependencies||p(e)||this.backgroundScheduler.add(e)};this.activeTextDocument=r.window.activeTextEditor?.document,r.window.onDidChangeActiveTextEditor(e=>{let t=this.activeTextDocument;this.activeTextDocument=e?.document,t!==void 0&&m(t),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});let _=e.getFeature(i.DidOpenTextDocumentNotification.method);c.push(_.onNotificationSent(e=>{let t=e.textDocument;this.diagnosticRequestor.knows(f.document,t)||d(t)&&this.diagnosticRequestor.pull(t,()=>{m(t)})})),c.push(t.onOpen(e=>{for(let t of e){if(this.diagnosticRequestor.knows(f.document,t))continue;let e=t.toString(),n;for(let t of r.workspace.textDocuments)if(e===t.uri.toString()){n=t;break}n!==void 0&&d(n)&&this.diagnosticRequestor.pull(n,()=>{m(n)})}}));let v=new Set;for(let e of r.workspace.textDocuments)d(e)&&(this.diagnosticRequestor.pull(e,()=>{m(e)}),v.add(e.uri.toString()));if(o.onTabs===!0)for(let e of t.getTabResources())!v.has(e.toString())&&d(e)&&this.diagnosticRequestor.pull(e,()=>{m(e)});if(o.onChange===!0){let t=e.getFeature(i.DidChangeTextDocumentNotification.method);c.push(t.onNotificationSent(async e=>{let t=e.textDocument;(o.filter===void 0||!o.filter(t,l.onType))&&this.diagnosticRequestor.knows(f.document,t)&&this.diagnosticRequestor.pull(t,()=>{this.backgroundScheduler.trigger()})}))}if(o.onSave===!0){let t=e.getFeature(i.DidSaveTextDocumentNotification.method);c.push(t.onNotificationSent(e=>{let t=e.textDocument;(o.filter===void 0||!o.filter(t,l.onSave))&&this.diagnosticRequestor.knows(f.document,t)&&this.diagnosticRequestor.pull(e.textDocument,()=>{this.backgroundScheduler.trigger()})}))}let y=e.getFeature(i.DidCloseTextDocumentNotification.method);c.push(y.onNotificationSent(e=>{this.cleanUpDocument(e.textDocument)})),t.onClose(e=>{for(let t of e)this.cleanUpDocument(t)}),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(let e of r.workspace.textDocuments)d(e)&&this.diagnosticRequestor.pull(e)}),a.workspaceDiagnostics===!0&&a.identifier!==`da348dc5-c30a-4515-9d98-31ff3be38d14`&&this.diagnosticRequestor.pullWorkspace(),this.disposable=r.Disposable.from(...c,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}cleanUpDocument(e){this.diagnosticRequestor.knows(f.document,e)&&(this.diagnosticRequestor.forgetDocument(e),this.backgroundScheduler.remove(e))}},y=class extends o.TextDocumentLanguageFeature{constructor(e){super(e,i.DocumentDiagnosticRequest.type)}fillClientCapabilities(e){let t=s(s(e,`textDocument`),`diagnostic`);t.dynamicRegistration=!0,t.relatedDocumentSupport=!1,s(s(e,`workspace`),`diagnostics`).refreshSupport=!0}initialize(e,t){let n=this._client;n.onRequest(i.DiagnosticRefreshRequest.type,async()=>{for(let e of this.getAllProviders())e.onDidChangeDiagnosticsEmitter.fire()});let[r,a]=this.getRegistration(t,e.diagnosticProvider);!r||!a||this.register({id:r,registerOptions:a})}clear(){this.tabs!==void 0&&(this.tabs.dispose(),this.tabs=void 0),super.clear()}registerLanguageProvider(e){this.tabs===void 0&&(this.tabs=new d);let t=new _(this._client,this.tabs,e);return[t.disposable,t]}};exports.DiagnosticFeature=y}),S=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.NotebookDocumentSyncFeature=void 0;let n=require(`vscode`),r=ee(),i=t.require_main$1(),o=v(),s=a();function c(e,t){return e[t]===void 0&&(e[t]={}),e[t]}var l;(function(e){let t;(function(t){function r(e,t){return{version:e.version,uri:t.asUri(e.uri)}}t.asVersionedNotebookDocumentIdentifier=r;function a(e,t,n){let r=i.NotebookDocument.create(n.asUri(e.uri),e.notebookType,e.version,o(t,n));return Object.keys(e.metadata).length>0&&(r.metadata=c(e.metadata)),r}t.asNotebookDocument=a;function o(e,t){return e.map(e=>l(e,t))}t.asNotebookCells=o;function c(e){let t=new Set;return d(t,e)}t.asMetadata=c;function l(e,t){let n=i.NotebookCell.create(u(e.kind),t.asUri(e.document.uri));return Object.keys(e.metadata).length>0&&(n.metadata=c(e.metadata)),e.executionSummary!==void 0&&s.number(e.executionSummary.executionOrder)&&s.boolean(e.executionSummary.success)&&(n.executionSummary={executionOrder:e.executionSummary.executionOrder,success:e.executionSummary.success}),n}t.asNotebookCell=l;function u(e){switch(e){case n.NotebookCellKind.Markup:return i.NotebookCellKind.Markup;case n.NotebookCellKind.Code:return i.NotebookCellKind.Code}}function d(e,t){if(e.has(t))throw Error(`Can't deep copy cyclic structures.`);if(Array.isArray(t)){let n=[];for(let r of t)if(typeof r==`object`&&r||Array.isArray(r))n.push(d(e,r));else{if(r instanceof RegExp)throw Error(`Can't transfer regular expressions to the server`);n.push(r)}return n}else{let n=Object.keys(t),r=Object.create(null);for(let i of n){let n=t[i];if(typeof n==`object`&&n||Array.isArray(n))r[i]=d(e,n);else{if(n instanceof RegExp)throw Error(`Can't transfer regular expressions to the server`);r[i]=n}}return r}}function f(e,t){let n=t.asChangeTextDocumentParams(e,e.document.uri,e.document.version);return{document:n.textDocument,changes:n.contentChanges}}t.asTextContentChange=f;function p(t,n){let r=Object.create(null);if(t.metadata&&(r.metadata=e.c2p.asMetadata(t.metadata)),t.cells!==void 0){let i=Object.create(null),a=t.cells;a.structure&&(i.structure={array:{start:a.structure.array.start,deleteCount:a.structure.array.deleteCount,cells:a.structure.array.cells===void 0?void 0:a.structure.array.cells.map(t=>e.c2p.asNotebookCell(t,n))},didOpen:a.structure.didOpen===void 0?void 0:a.structure.didOpen.map(e=>n.asOpenTextDocumentParams(e.document).textDocument),didClose:a.structure.didClose===void 0?void 0:a.structure.didClose.map(e=>n.asCloseTextDocumentParams(e.document).textDocument)}),a.data!==void 0&&(i.data=a.data.map(t=>e.c2p.asNotebookCell(t,n))),a.textContent!==void 0&&(i.textContent=a.textContent.map(t=>e.c2p.asTextContentChange(t,n))),Object.keys(i).length>0&&(r.cells=i)}return r}t.asNotebookDocumentChangeEvent=p})(t=e.c2p||={})})(l||={});var u;(function(e){function t(e,t,r){let i=e.length,a=t.length,o=0;for(;o<a&&o<i&&n(e[o],t[o],r);)o++;if(o<a&&o<i){let s=i-1,c=a-1;for(;s>=0&&c>=0&&n(e[s],t[c],r);)s--,c--;let l=s+1-o,u=o===c+1?void 0:t.slice(o,c+1);return u===void 0?{start:o,deleteCount:l}:{start:o,deleteCount:l,cells:u}}else if(o<a)return{start:o,deleteCount:0,cells:t.slice(o)};else if(o<i)return{start:o,deleteCount:i-o};else return}e.computeDiff=t;function n(e,t,n=!0){return e.kind!==t.kind||e.document.uri.toString()!==t.document.uri.toString()||e.document.languageId!==t.document.languageId||!r(e.executionSummary,t.executionSummary)?!1:!n||n&&a(e.metadata,t.metadata)}function r(e,t){return e===t?!0:e===void 0||t===void 0?!1:e.executionOrder===t.executionOrder&&e.success===t.success&&i(e.timing,t.timing)}function i(e,t){return e===t?!0:e===void 0||t===void 0?!1:e.startTime===t.startTime&&e.endTime===t.endTime}function a(e,t){if(e===t)return!0;if(e==null||t==null||typeof e!=typeof t||typeof e!=`object`)return!1;let n=Array.isArray(e),r=Array.isArray(t);if(n!==r)return!1;if(n&&r){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!a(e[n],t[n]))return!1}if(o(e)&&o(t)){let n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length||(n.sort(),r.sort(),!a(n,r)))return!1;for(let r=0;r<n.length;r++){let i=n[r];if(!a(e[i],t[i]))return!1}return!0}return!1}function o(e){return typeof e==`object`&&!!e}e.isObjectLiteral=o})(u||={});var d;(function(e){function t(e,t){if(typeof e==`string`)return e===`*`||t.notebookType===e;if(e.notebookType!==void 0&&e.notebookType!==`*`&&t.notebookType!==e.notebookType)return!1;let n=t.uri;if(e.scheme!==void 0&&e.scheme!==`*`&&n.scheme!==e.scheme)return!1;if(e.pattern!==void 0){let t=new r.Minimatch(e.pattern,{noext:!0});if(!t.makeRe()||!t.match(n.fsPath))return!1}return!0}e.matchNotebook=t})(d||={});var f;(function(e){function t(e){let t=e.notebookSelector,r=[];for(let e of t){let t=(typeof e.notebook==`string`?e.notebook:e.notebook?.notebookType)??`*`,i=typeof e.notebook==`string`?void 0:e.notebook?.scheme,a=typeof e.notebook==`string`?void 0:e.notebook?.pattern;if(e.cells!==void 0)for(let o of e.cells)r.push(n(t,i,a,o.language));else r.push(n(t,i,a,void 0))}return r}e.asDocumentSelector=t;function n(e,t,n,r){return t===void 0&&n===void 0?{notebook:e,language:r}:{notebook:{notebookType:e,scheme:t,pattern:n},language:r}}})(f||={});var p;(function(e){function t(e){return{cells:e,uris:new Set(e.map(e=>e.document.uri.toString()))}}e.create=t})(p||={});var m=class{constructor(e,t){this.client=e,this.options=t,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector(f.asDocumentSelector(t)),n.workspace.onDidOpenNotebookDocument(e=>{this.notebookDidOpen.add(e.uri.toString()),this.didOpen(e)},void 0,this.disposables);for(let e of n.workspace.notebookDocuments)this.notebookDidOpen.add(e.uri.toString()),this.didOpen(e);n.workspace.onDidChangeNotebookDocument(e=>this.didChangeNotebookDocument(e),void 0,this.disposables),this.options.save===!0&&n.workspace.onDidSaveNotebookDocument(e=>this.didSave(e),void 0,this.disposables),n.workspace.onDidCloseNotebookDocument(e=>{this.didClose(e),this.notebookDidOpen.delete(e.uri.toString())},void 0,this.disposables)}getState(){for(let e of n.workspace.notebookDocuments){let t=this.getMatchingCells(e);if(t!==void 0)return{kind:`document`,id:`$internal`,registrations:!0,matches:!0}}return{kind:`document`,id:`$internal`,registrations:!0,matches:!1}}get mode(){return`notebook`}handles(e){return n.languages.match(this.selector,e)>0}didOpenNotebookCellTextDocument(e,t){if(n.languages.match(this.selector,t.document)===0||!this.notebookDidOpen.has(e.uri.toString()))return;let r=this.notebookSyncInfo.get(e.uri.toString()),i=this.cellMatches(e,t);if(r!==void 0){let n=r.uris.has(t.document.uri.toString());if(i&&n||!i&&!n)return;if(i){let t=this.getMatchingCells(e);if(t!==void 0){let n=this.asNotebookDocumentChangeEvent(e,void 0,r,t);n!==void 0&&this.doSendChange(n,t).catch(()=>{})}}}else i&&this.doSendOpen(e,[t]).catch(()=>{})}didChangeNotebookCellTextDocument(e,t){n.languages.match(this.selector,t.document)!==0&&this.doSendChange({notebook:e,cells:{textContent:[t]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(e,t){let n=this.notebookSyncInfo.get(e.uri.toString());if(n===void 0)return;let r=t.document.uri,i=n.cells.findIndex(e=>e.document.uri.toString()===r.toString());if(i!==-1)if(i===0&&n.cells.length===1)this.doSendClose(e,n.cells).catch(()=>{});else{let t=n.cells.slice(),r=t.splice(i,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:i,deleteCount:1},didClose:r}}},t).catch(()=>{})}}dispose(){for(let e of this.disposables)e.dispose()}didOpen(e,t=this.getMatchingCells(e),n=this.notebookSyncInfo.get(e.uri.toString())){if(n!==void 0)if(t!==void 0){let r=this.asNotebookDocumentChangeEvent(e,void 0,n,t);r!==void 0&&this.doSendChange(r,t).catch(()=>{})}else this.doSendClose(e,[]).catch(()=>{});else{if(t===void 0)return;this.doSendOpen(e,t).catch(()=>{})}}didChangeNotebookDocument(e){let t=e.notebook,n=this.notebookSyncInfo.get(t.uri.toString());if(n===void 0){if(e.contentChanges.length===0)return;let r=this.getMatchingCells(t);if(r===void 0)return;this.didOpen(t,r,n)}else{let r=this.getMatchingCells(t);if(r===void 0){this.didClose(t,n);return}let i=this.asNotebookDocumentChangeEvent(e.notebook,e,n,r);i!==void 0&&this.doSendChange(i,r).catch(()=>{})}}didSave(e){let t=this.notebookSyncInfo.get(e.uri.toString());t!==void 0&&this.doSendSave(e).catch(()=>{})}didClose(e,t=this.notebookSyncInfo.get(e.uri.toString())){if(t===void 0)return;let n=e.getCells().filter(e=>t.uris.has(e.document.uri.toString()));this.doSendClose(e,n).catch(()=>{})}async sendDidOpenNotebookDocument(e){let t=this.getMatchingCells(e);if(t!==void 0)return this.doSendOpen(e,t)}async doSendOpen(e,t){let n=async(e,t)=>{let n=l.c2p.asNotebookDocument(e,t,this.client.code2ProtocolConverter),r=t.map(e=>this.client.code2ProtocolConverter.asTextDocumentItem(e.document));try{await this.client.sendNotification(i.DidOpenNotebookDocumentNotification.type,{notebookDocument:n,cellTextDocuments:r})}catch(e){throw this.client.error(`Sending DidOpenNotebookDocumentNotification failed`,e),e}},r=this.client.middleware?.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),p.create(t)),r?.didOpen===void 0?n(e,t):r.didOpen(e,t,n)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,t=this.getMatchingCells(e.notebook)){let n=async e=>{try{await this.client.sendNotification(i.DidChangeNotebookDocumentNotification.type,{notebookDocument:l.c2p.asVersionedNotebookDocumentIdentifier(e.notebook,this.client.code2ProtocolConverter),change:l.c2p.asNotebookDocumentChangeEvent(e,this.client.code2ProtocolConverter)})}catch(e){throw this.client.error(`Sending DidChangeNotebookDocumentNotification failed`,e),e}},r=this.client.middleware?.notebooks;return e.cells?.structure!==void 0&&this.notebookSyncInfo.set(e.notebook.uri.toString(),p.create(t??[])),r?.didChange===void 0?n(e):r?.didChange(e,n)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){let t=async e=>{try{await this.client.sendNotification(i.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(e.uri)}})}catch(e){throw this.client.error(`Sending DidSaveNotebookDocumentNotification failed`,e),e}},n=this.client.middleware?.notebooks;return n?.didSave===void 0?t(e):n.didSave(e,t)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,t){let n=async(e,t)=>{try{await this.client.sendNotification(i.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(e.uri)},cellTextDocuments:t.map(e=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(e.document))})}catch(e){throw this.client.error(`Sending DidCloseNotebookDocumentNotification failed`,e),e}},r=this.client.middleware?.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),r?.didClose===void 0?n(e,t):r.didClose(e,t,n)}asNotebookDocumentChangeEvent(e,t,n,r){if(t!==void 0&&t.notebook!==e)throw Error(`Notebook must be identical`);let i={notebook:e};t?.metadata!==void 0&&(i.metadata=l.c2p.asMetadata(t.metadata));let a;if(t?.cellChanges!==void 0&&t.cellChanges.length>0){let e=[];a=new Set(r.map(e=>e.document.uri.toString()));for(let n of t.cellChanges)a.has(n.cell.document.uri.toString())&&(n.executionSummary!==void 0||n.metadata!==void 0)&&e.push(n.cell);e.length>0&&(i.cells=i.cells??{},i.cells.data=e)}if((t?.contentChanges!==void 0&&t.contentChanges.length>0||t===void 0)&&n!==void 0&&r!==void 0){let e=n.cells,t=r,a=u.computeDiff(e,t,!1),o,s;if(a!==void 0){o=a.cells===void 0?new Map:new Map(a.cells.map(e=>[e.document.uri.toString(),e])),s=a.deleteCount===0?new Map:new Map(e.slice(a.start,a.start+a.deleteCount).map(e=>[e.document.uri.toString(),e]));for(let e of Array.from(s.keys()))o.has(e)&&(s.delete(e),o.delete(e));i.cells=i.cells??{};let t=[],n=[];if(o.size>0||s.size>0){for(let e of o.values())t.push(e);for(let e of s.values())n.push(e)}i.cells.structure={array:a,didOpen:t,didClose:n}}}return Object.keys(i).length>1?i:void 0}getMatchingCells(e,t=e.getCells()){if(this.options.notebookSelector!==void 0){for(let n of this.options.notebookSelector)if(n.notebook===void 0||d.matchNotebook(n.notebook,e)){let r=this.filterCells(e,t,n.cells);return r.length===0?void 0:r}}}cellMatches(e,t){let n=this.getMatchingCells(e,[t]);return n!==void 0&&n[0]===t}filterCells(e,t,n){let r=n===void 0?t:t.filter(e=>{let t=e.document.languageId;return n.some(e=>e.language===`*`||t===e.language)});return typeof this.client.clientOptions.notebookDocumentOptions?.filterCells==`function`?this.client.clientOptions.notebookDocumentOptions.filterCells(e,r):r}},h=class e{constructor(t){this.client=t,this.registrations=new Map,this.registrationType=i.NotebookDocumentSyncRegistrationType.type,n.workspace.onDidOpenTextDocument(t=>{if(t.uri.scheme!==e.CellScheme)return;let[n,r]=this.findNotebookDocumentAndCell(t);if(!(n===void 0||r===void 0))for(let e of this.registrations.values())e instanceof m&&e.didOpenNotebookCellTextDocument(n,r)}),n.workspace.onDidChangeTextDocument(t=>{if(t.contentChanges.length===0)return;let n=t.document;if(n.uri.scheme!==e.CellScheme)return;let[r]=this.findNotebookDocumentAndCell(n);if(r!==void 0)for(let e of this.registrations.values())e instanceof m&&e.didChangeNotebookCellTextDocument(r,t)}),n.workspace.onDidCloseTextDocument(t=>{if(t.uri.scheme!==e.CellScheme)return;let[n,r]=this.findNotebookDocumentAndCell(t);if(!(n===void 0||r===void 0))for(let e of this.registrations.values())e instanceof m&&e.didCloseNotebookCellTextDocument(n,r)})}getState(){if(this.registrations.size===0)return{kind:`document`,id:this.registrationType.method,registrations:!1,matches:!1};for(let e of this.registrations.values()){let t=e.getState();if(t.kind===`document`&&t.registrations===!0&&t.matches===!0)return{kind:`document`,id:this.registrationType.method,registrations:!0,matches:!0}}return{kind:`document`,id:this.registrationType.method,registrations:!0,matches:!1}}fillClientCapabilities(e){let t=c(c(e,`notebookDocument`),`synchronization`);t.dynamicRegistration=!0,t.executionSummarySupport=!0}preInitialize(e){let t=e.notebookDocumentSync;t!==void 0&&(this.dedicatedChannel=this.client.protocol2CodeConverter.asDocumentSelector(f.asDocumentSelector(t)))}initialize(e){let t=e.notebookDocumentSync;if(t===void 0)return;let n=t.id??o.generateUuid();this.register({id:n,registerOptions:t})}register(e){let t=new m(this.client,e.registerOptions);this.registrations.set(e.id,t)}unregister(e){let t=this.registrations.get(e);t&&t.dispose()}clear(){for(let e of this.registrations.values())e.dispose();this.registrations.clear()}handles(t){if(t.uri.scheme!==e.CellScheme)return!1;if(this.dedicatedChannel!==void 0&&n.languages.match(this.dedicatedChannel,t)>0)return!0;for(let e of this.registrations.values())if(e.handles(t))return!0;return!1}getProvider(e){for(let t of this.registrations.values())if(t.handles(e.document))return t}findNotebookDocumentAndCell(e){let t=e.uri.toString();for(let e of n.workspace.notebookDocuments)for(let n of e.getCells())if(n.document.uri.toString()===t)return[e,n];return[void 0,void 0]}};exports.NotebookDocumentSyncFeature=h,h.CellScheme=`vscode-notebook-cell`}),ne=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.SyncConfigurationFeature=exports.toJSONObject=exports.ConfigurationFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=a(),o=v(),s=b();var c=class{constructor(e){this._client=e}getState(){return{kind:`static`}}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(r.ConfigurationRequest.type,(t,n)=>{let r=e=>{let t=[];for(let n of e.items){let e=n.scopeUri!==void 0&&n.scopeUri!==null?this._client.protocol2CodeConverter.asUri(n.scopeUri):void 0;t.push(this.getConfiguration(e,n.section===null?void 0:n.section))}return t},i=e.middleware.workspace;return i&&i.configuration?i.configuration(t,n,r):r(t,n)})}getConfiguration(e,t){let r=null;if(t){let i=t.lastIndexOf(`.`);if(i===-1)r=l(n.workspace.getConfiguration(void 0,e).get(t));else{let a=n.workspace.getConfiguration(t.substr(0,i),e);a&&(r=l(a.get(t.substr(i+1))))}}else{let t=n.workspace.getConfiguration(void 0,e);r={};for(let e of Object.keys(t))t.has(e)&&(r[e]=l(t.get(e)))}return r===void 0&&(r=null),r}clear(){}};exports.ConfigurationFeature=c;function l(e){if(e){if(Array.isArray(e))return e.map(l);if(typeof e==`object`){let t=Object.create(null);for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=l(e[n]));return t}}return e}exports.toJSONObject=l;var u=class{constructor(e){this._client=e,this.isCleared=!1,this._listeners=new Map}getState(){return{kind:`workspace`,id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return r.DidChangeConfigurationNotification.type}fillClientCapabilities(e){(0,s.ensure)((0,s.ensure)(e,`workspace`),`didChangeConfiguration`).dynamicRegistration=!0}initialize(){this.isCleared=!1;let e=this._client.clientOptions.synchronize?.configurationSection;e!==void 0&&this.register({id:o.generateUuid(),registerOptions:{section:e}})}register(e){let t=n.workspace.onDidChangeConfiguration(t=>{this.onDidChangeConfiguration(e.registerOptions.section,t)});this._listeners.set(e.id,t),e.registerOptions.section!==void 0&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear(),this.isCleared=!0}onDidChangeConfiguration(e,t){if(this.isCleared)return;let n;if(n=i.string(e)?[e]:e,n!==void 0&&t!==void 0){let e=n.some(e=>t.affectsConfiguration(e));if(!e)return}let a=async e=>e===void 0?this._client.sendNotification(r.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(r.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(e)}),o=this._client.middleware.workspace?.didChangeConfiguration;(o?o(n,a):a(n)).catch(e=>{this._client.error(`Sending notification ${r.DidChangeConfigurationNotification.type.method} failed`,e)})}extractSettingsInformation(e){function t(e,t){let n=e;for(let e=0;e<t.length-1;e++){let r=n[t[e]];r||(r=Object.create(null),n[t[e]]=r),n=r}return n}let r=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,i=Object.create(null);for(let a=0;a<e.length;a++){let o=e[a],s=o.indexOf(`.`),c=null;if(c=s>=0?n.workspace.getConfiguration(o.substr(0,s),r).get(o.substr(s+1)):n.workspace.getConfiguration(void 0,r).get(o),c){let n=e[a].split(`.`);t(i,n)[n[n.length-1]]=l(c)}}return i}};exports.SyncConfigurationFeature=u}),C=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.DidSaveTextDocumentFeature=exports.WillSaveWaitUntilFeature=exports.WillSaveFeature=exports.DidChangeTextDocumentFeature=exports.DidCloseTextDocumentFeature=exports.DidOpenTextDocumentFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b(),a=v();var o=class extends i.TextDocumentEventFeature{constructor(e,t){super(e,n.workspace.onDidOpenTextDocument,r.DidOpenTextDocumentNotification.type,()=>e.middleware.didOpen,t=>e.code2ProtocolConverter.asOpenTextDocumentParams(t),e=>e,i.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){(0,i.ensure)((0,i.ensure)(e,`textDocument`),`synchronization`).dynamicRegistration=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.openClose&&this.register({id:a.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return r.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;let t=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);n.workspace.textDocuments.forEach(e=>{let r=e.uri.toString();if(!this._syncedDocuments.has(r)&&n.languages.match(t,e)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e)){let t=this._client.middleware,n=e=>this._client.sendNotification(this._type,this._createParams(e));(t.didOpen?t.didOpen(e,n):n(e)).catch(e=>{this._client.error(`Sending document notification ${this._type.method} failed`,e)}),this._syncedDocuments.set(r,e)}})}getTextDocument(e){return e}notificationSent(e,t,n){this._syncedDocuments.set(e.uri.toString(),e),super.notificationSent(e,t,n)}};exports.DidOpenTextDocumentFeature=o;var s=class extends i.TextDocumentEventFeature{constructor(e,t,a){super(e,n.workspace.onDidCloseTextDocument,r.DidCloseTextDocumentNotification.type,()=>e.middleware.didClose,t=>e.code2ProtocolConverter.asCloseTextDocumentParams(t),e=>e,i.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t,this._pendingTextDocumentChanges=a}get registrationType(){return r.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){(0,i.ensure)((0,i.ensure)(e,`textDocument`),`synchronization`).dynamicRegistration=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.openClose&&this.register({id:a.generateUuid(),registerOptions:{documentSelector:t}})}async callback(e){await super.callback(e),this._pendingTextDocumentChanges.delete(e.uri.toString())}getTextDocument(e){return e}notificationSent(e,t,n){this._syncedDocuments.delete(e.uri.toString()),super.notificationSent(e,t,n)}unregister(e){let t=this._selectors.get(e);super.unregister(e);let r=this._selectors.values();this._syncedDocuments.forEach(e=>{if(n.languages.match(t,e)>0&&!this._selectorFilter(r,e)&&!this._client.hasDedicatedTextSynchronizationFeature(e)){let t=this._client.middleware,n=e=>this._client.sendNotification(this._type,this._createParams(e));this._syncedDocuments.delete(e.uri.toString()),(t.didClose?t.didClose(e,n):n(e)).catch(e=>{this._client.error(`Sending document notification ${this._type.method} failed`,e)})}})}};exports.DidCloseTextDocumentFeature=s;var c=class extends i.DynamicDocumentFeature{constructor(e,t){super(e),this._changeData=new Map,this._onNotificationSent=new n.EventEmitter,this._onPendingChangeAdded=new n.EventEmitter,this._pendingTextDocumentChanges=t,this._syncKind=r.TextDocumentSyncKind.None}get onNotificationSent(){return this._onNotificationSent.event}get onPendingChangeAdded(){return this._onPendingChangeAdded.event}get syncKind(){return this._syncKind}get registrationType(){return r.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){(0,i.ensure)((0,i.ensure)(e,`textDocument`),`synchronization`).dynamicRegistration=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.change!==void 0&&n.change!==r.TextDocumentSyncKind.None&&this.register({id:a.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:n.change})})}register(e){e.registerOptions.documentSelector&&(this._listener||=n.workspace.onDidChangeTextDocument(this.callback,this),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}),this.updateSyncKind(e.registerOptions.syncKind))}*getDocumentSelectors(){for(let e of this._changeData.values())yield e.documentSelector}async callback(e){if(e.contentChanges.length===0)return;let t=e.document.uri,i=e.document.version,a=[];for(let o of this._changeData.values())if(n.languages.match(o.documentSelector,e.document)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let n=this._client.middleware;if(o.syncKind===r.TextDocumentSyncKind.Incremental){let o=async e=>{let n=this._client.code2ProtocolConverter.asChangeTextDocumentParams(e,t,i);await this._client.sendNotification(r.DidChangeTextDocumentNotification.type,n),this.notificationSent(e.document,r.DidChangeTextDocumentNotification.type,n)};a.push(n.didChange?n.didChange(e,e=>o(e)):o(e))}else if(o.syncKind===r.TextDocumentSyncKind.Full){let t=async e=>{let t=e.document.uri.toString();this._pendingTextDocumentChanges.set(t,e.document),this._onPendingChangeAdded.fire()};a.push(n.didChange?n.didChange(e,e=>t(e)):t(e))}}return Promise.all(a).then(void 0,e=>{throw this._client.error(`Sending document notification ${r.DidChangeTextDocumentNotification.type.method} failed`,e),e})}notificationSent(e,t,n){this._onNotificationSent.fire({textDocument:e,type:t,params:n})}unregister(e){if(this._changeData.delete(e),this._changeData.size===0)this._listener&&(this._listener.dispose(),this._listener=void 0),this._syncKind=r.TextDocumentSyncKind.None;else{this._syncKind=r.TextDocumentSyncKind.None;for(let e of this._changeData.values())if(this.updateSyncKind(e.syncKind),this._syncKind===r.TextDocumentSyncKind.Full)break}}clear(){this._pendingTextDocumentChanges.clear(),this._changeData.clear(),this._syncKind=r.TextDocumentSyncKind.None,this._listener&&(this._listener.dispose(),this._listener=void 0)}getPendingDocumentChanges(e){if(this._pendingTextDocumentChanges.size===0)return[];let t;if(e.size===0)t=Array.from(this._pendingTextDocumentChanges.values()),this._pendingTextDocumentChanges.clear();else{t=[];for(let n of this._pendingTextDocumentChanges)e.has(n[0])||(t.push(n[1]),this._pendingTextDocumentChanges.delete(n[0]))}return t}getProvider(e){for(let t of this._changeData.values())if(n.languages.match(t.documentSelector,e)>0)return{send:e=>this.callback(e)}}updateSyncKind(e){if(this._syncKind!==r.TextDocumentSyncKind.Full)switch(e){case r.TextDocumentSyncKind.Full:this._syncKind=e;break;case r.TextDocumentSyncKind.Incremental:this._syncKind===r.TextDocumentSyncKind.None&&(this._syncKind=r.TextDocumentSyncKind.Incremental);break}}};exports.DidChangeTextDocumentFeature=c;var l=class extends i.TextDocumentEventFeature{constructor(e){super(e,n.workspace.onWillSaveTextDocument,r.WillSaveTextDocumentNotification.type,()=>e.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),e=>e.document,(e,t)=>i.TextDocumentEventFeature.textDocumentFilter(e,t.document))}get registrationType(){return r.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){let t=(0,i.ensure)((0,i.ensure)(e,`textDocument`),`synchronization`);t.willSave=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.willSave&&this.register({id:a.generateUuid(),registerOptions:{documentSelector:t}})}getTextDocument(e){return e.document}};exports.WillSaveFeature=l;var u=class extends i.DynamicDocumentFeature{constructor(e){super(e),this._selectors=new Map}getDocumentSelectors(){return this._selectors.values()}get registrationType(){return r.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){let t=(0,i.ensure)((0,i.ensure)(e,`textDocument`),`synchronization`);t.willSaveWaitUntil=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.willSaveWaitUntil&&this.register({id:a.generateUuid(),registerOptions:{documentSelector:t}})}register(e){e.registerOptions.documentSelector&&(this._listener||=n.workspace.onWillSaveTextDocument(this.callback,this),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(i.TextDocumentEventFeature.textDocumentFilter(this._selectors.values(),e.document)&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let t=this._client.middleware,n=e=>this._client.sendRequest(r.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(e)).then(async e=>{let t=await this._client.protocol2CodeConverter.asTextEdits(e);return t===void 0?[]:t});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,n):n(e))}}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}};exports.WillSaveWaitUntilFeature=u;var d=class extends i.TextDocumentEventFeature{constructor(e){super(e,n.workspace.onDidSaveTextDocument,r.DidSaveTextDocumentNotification.type,()=>e.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),e=>e,i.TextDocumentEventFeature.textDocumentFilter),this._includeText=!1}get registrationType(){return r.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){(0,i.ensure)((0,i.ensure)(e,`textDocument`),`synchronization`).didSave=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;if(t&&n&&n.save){let e=typeof n.save==`boolean`?{includeText:!1}:{includeText:!!n.save.includeText};this.register({id:a.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},e)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}getTextDocument(e){return e}};exports.DidSaveTextDocumentFeature=d}),re=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.CompletionItemFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b(),a=v(),o=[r.CompletionItemKind.Text,r.CompletionItemKind.Method,r.CompletionItemKind.Function,r.CompletionItemKind.Constructor,r.CompletionItemKind.Field,r.CompletionItemKind.Variable,r.CompletionItemKind.Class,r.CompletionItemKind.Interface,r.CompletionItemKind.Module,r.CompletionItemKind.Property,r.CompletionItemKind.Unit,r.CompletionItemKind.Value,r.CompletionItemKind.Enum,r.CompletionItemKind.Keyword,r.CompletionItemKind.Snippet,r.CompletionItemKind.Color,r.CompletionItemKind.File,r.CompletionItemKind.Reference,r.CompletionItemKind.Folder,r.CompletionItemKind.EnumMember,r.CompletionItemKind.Constant,r.CompletionItemKind.Struct,r.CompletionItemKind.Event,r.CompletionItemKind.Operator,r.CompletionItemKind.TypeParameter];var s=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.CompletionRequest.type),this.labelDetailsSupport=new Map}fillClientCapabilities(e){let t=(0,i.ensure)((0,i.ensure)(e,`textDocument`),`completion`);t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[r.MarkupKind.Markdown,r.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[r.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:[`documentation`,`detail`,`additionalTextEdits`]},insertTextModeSupport:{valueSet:[r.InsertTextMode.asIs,r.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},t.insertTextMode=r.InsertTextMode.adjustIndentation,t.completionItemKind={valueSet:o},t.completionList={itemDefaults:[`commitCharacters`,`editRange`,`insertTextFormat`,`insertTextMode`,`data`]}}initialize(e,t){let n=this.getRegistrationOptions(t,e.completionProvider);n&&this.register({id:a.generateUuid(),registerOptions:n})}registerLanguageProvider(e,t){this.labelDetailsSupport.set(t,!!e.completionItem?.labelDetailsSupport);let i=e.triggerCharacters??[],a=e.allCommitCharacters,o=e.documentSelector,s={provideCompletionItems:(e,t,n,i)=>{let o=this._client,s=this._client.middleware,c=(e,t,n,i)=>o.sendRequest(r.CompletionRequest.type,o.code2ProtocolConverter.asCompletionParams(e,t,n),i).then(e=>i.isCancellationRequested?null:o.protocol2CodeConverter.asCompletionResult(e,a,i),e=>o.handleFailedRequest(r.CompletionRequest.type,i,e,null));return s.provideCompletionItem?s.provideCompletionItem(e,t,i,n,c):c(e,t,i,n)},resolveCompletionItem:e.resolveProvider?(e,n)=>{let i=this._client,a=this._client.middleware,o=(e,n)=>i.sendRequest(r.CompletionResolveRequest.type,i.code2ProtocolConverter.asCompletionItem(e,!!this.labelDetailsSupport.get(t)),n).then(e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asCompletionItem(e),t=>i.handleFailedRequest(r.CompletionResolveRequest.type,n,t,e));return a.resolveCompletionItem?a.resolveCompletionItem(e,n,o):o(e,n)}:void 0};return[n.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(o),s,...i),s]}};exports.CompletionItemFeature=s}),ie=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.HoverFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b(),a=v();var o=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.HoverRequest.type)}fillClientCapabilities(e){let t=(0,i.ensure)((0,i.ensure)(e,`textDocument`),`hover`);t.dynamicRegistration=!0,t.contentFormat=[r.MarkupKind.Markdown,r.MarkupKind.PlainText]}initialize(e,t){let n=this.getRegistrationOptions(t,e.hoverProvider);n&&this.register({id:a.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideHover:(e,t,n)=>{let i=this._client,a=(e,t,n)=>i.sendRequest(r.HoverRequest.type,i.code2ProtocolConverter.asTextDocumentPositionParams(e,t),n).then(e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asHover(e),e=>i.handleFailedRequest(r.HoverRequest.type,n,e,null)),o=i.middleware;return o.provideHover?o.provideHover(e,t,n,a):a(e,t,n)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return n.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};exports.HoverFeature=o}),w=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.DefinitionFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b(),a=v();var o=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.DefinitionRequest.type)}fillClientCapabilities(e){let t=(0,i.ensure)((0,i.ensure)(e,`textDocument`),`definition`);t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.definitionProvider);n&&this.register({id:a.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideDefinition:(e,t,n)=>{let i=this._client,a=(e,t,n)=>i.sendRequest(r.DefinitionRequest.type,i.code2ProtocolConverter.asTextDocumentPositionParams(e,t),n).then(e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asDefinitionResult(e,n),e=>i.handleFailedRequest(r.DefinitionRequest.type,n,e,null)),o=i.middleware;return o.provideDefinition?o.provideDefinition(e,t,n,a):a(e,t,n)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return n.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};exports.DefinitionFeature=o}),T=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.SignatureHelpFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b(),a=v();var o=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=(0,i.ensure)((0,i.ensure)(e,`textDocument`),`signatureHelp`);t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[r.MarkupKind.Markdown,r.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.signatureHelpProvider);n&&this.register({id:a.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t={provideSignatureHelp:(e,t,n,i)=>{let a=this._client,o=(e,t,n,i)=>a.sendRequest(r.SignatureHelpRequest.type,a.code2ProtocolConverter.asSignatureHelpParams(e,t,n),i).then(e=>i.isCancellationRequested?null:a.protocol2CodeConverter.asSignatureHelp(e,i),e=>a.handleFailedRequest(r.SignatureHelpRequest.type,i,e,null)),s=a.middleware;return s.provideSignatureHelp?s.provideSignatureHelp(e,t,i,n,o):o(e,t,i,n)}};return[this.registerProvider(e,t),t]}registerProvider(e,t){let r=this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector);if(e.retriggerCharacters===void 0){let i=e.triggerCharacters||[];return n.languages.registerSignatureHelpProvider(r,t,...i)}else{let i={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};return n.languages.registerSignatureHelpProvider(r,t,i)}}};exports.SignatureHelpFeature=o}),ae=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.DocumentHighlightFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b(),a=v();var o=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.DocumentHighlightRequest.type)}fillClientCapabilities(e){(0,i.ensure)((0,i.ensure)(e,`textDocument`),`documentHighlight`).dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentHighlightProvider);n&&this.register({id:a.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,i={provideDocumentHighlights:(e,t,n)=>{let i=this._client,a=(e,t,n)=>i.sendRequest(r.DocumentHighlightRequest.type,i.code2ProtocolConverter.asTextDocumentPositionParams(e,t),n).then(e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asDocumentHighlights(e,n),e=>i.handleFailedRequest(r.DocumentHighlightRequest.type,n,e,null)),o=i.middleware;return o.provideDocumentHighlights?o.provideDocumentHighlights(e,t,n,a):a(e,t,n)}};return[n.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),i]}};exports.DocumentHighlightFeature=o}),oe=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.DocumentSymbolFeature=exports.SupportedSymbolTags=exports.SupportedSymbolKinds=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b(),a=v();exports.SupportedSymbolKinds=[r.SymbolKind.File,r.SymbolKind.Module,r.SymbolKind.Namespace,r.SymbolKind.Package,r.SymbolKind.Class,r.SymbolKind.Method,r.SymbolKind.Property,r.SymbolKind.Field,r.SymbolKind.Constructor,r.SymbolKind.Enum,r.SymbolKind.Interface,r.SymbolKind.Function,r.SymbolKind.Variable,r.SymbolKind.Constant,r.SymbolKind.String,r.SymbolKind.Number,r.SymbolKind.Boolean,r.SymbolKind.Array,r.SymbolKind.Object,r.SymbolKind.Key,r.SymbolKind.Null,r.SymbolKind.EnumMember,r.SymbolKind.Struct,r.SymbolKind.Event,r.SymbolKind.Operator,r.SymbolKind.TypeParameter],exports.SupportedSymbolTags=[r.SymbolTag.Deprecated];var o=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.DocumentSymbolRequest.type)}fillClientCapabilities(t){let n=(0,i.ensure)((0,i.ensure)(t,`textDocument`),`documentSymbol`);n.dynamicRegistration=!0,n.symbolKind={valueSet:exports.SupportedSymbolKinds},n.hierarchicalDocumentSymbolSupport=!0,n.tagSupport={valueSet:exports.SupportedSymbolTags},n.labelSupport=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentSymbolProvider);n&&this.register({id:a.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,i={provideDocumentSymbols:(e,t)=>{let n=this._client,i=async(e,t)=>{try{let i=await n.sendRequest(r.DocumentSymbolRequest.type,n.code2ProtocolConverter.asDocumentSymbolParams(e),t);if(t.isCancellationRequested||i==null)return null;if(i.length===0)return[];{let e=i[0];return r.DocumentSymbol.is(e)?await n.protocol2CodeConverter.asDocumentSymbols(i,t):await n.protocol2CodeConverter.asSymbolInformations(i,t)}}catch(e){return n.handleFailedRequest(r.DocumentSymbolRequest.type,t,e,null)}},a=n.middleware;return a.provideDocumentSymbols?a.provideDocumentSymbols(e,t,i):i(e,t)}},a=e.label===void 0?void 0:{label:e.label};return[n.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i,a),i]}};exports.DocumentSymbolFeature=o}),se=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.WorkspaceSymbolFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b(),a=oe(),o=v();var s=class extends i.WorkspaceFeature{constructor(e){super(e,r.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=(0,i.ensure)((0,i.ensure)(e,`workspace`),`symbol`);t.dynamicRegistration=!0,t.symbolKind={valueSet:a.SupportedSymbolKinds},t.tagSupport={valueSet:a.SupportedSymbolTags},t.resolveSupport={properties:[`location.range`]}}initialize(e){e.workspaceSymbolProvider&&this.register({id:o.generateUuid(),registerOptions:e.workspaceSymbolProvider===!0?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){let t={provideWorkspaceSymbols:(e,t)=>{let n=this._client,i=(e,t)=>n.sendRequest(r.WorkspaceSymbolRequest.type,{query:e},t).then(e=>t.isCancellationRequested?null:n.protocol2CodeConverter.asSymbolInformations(e,t),e=>n.handleFailedRequest(r.WorkspaceSymbolRequest.type,t,e,null)),a=n.middleware;return a.provideWorkspaceSymbols?a.provideWorkspaceSymbols(e,t,i):i(e,t)},resolveWorkspaceSymbol:e.resolveProvider===!0?(e,t)=>{let n=this._client,i=(e,t)=>n.sendRequest(r.WorkspaceSymbolResolveRequest.type,n.code2ProtocolConverter.asWorkspaceSymbol(e),t).then(e=>t.isCancellationRequested?null:n.protocol2CodeConverter.asSymbolInformation(e),e=>n.handleFailedRequest(r.WorkspaceSymbolResolveRequest.type,t,e,null)),a=n.middleware;return a.resolveWorkspaceSymbol?a.resolveWorkspaceSymbol(e,t,i):i(e,t)}:void 0};return[n.languages.registerWorkspaceSymbolProvider(t),t]}};exports.WorkspaceSymbolFeature=s}),ce=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.ReferencesFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b(),a=v();var o=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.ReferencesRequest.type)}fillClientCapabilities(e){(0,i.ensure)((0,i.ensure)(e,`textDocument`),`references`).dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.referencesProvider);n&&this.register({id:a.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideReferences:(e,t,n,i)=>{let a=this._client,o=(e,t,n,i)=>a.sendRequest(r.ReferencesRequest.type,a.code2ProtocolConverter.asReferenceParams(e,t,n),i).then(e=>i.isCancellationRequested?null:a.protocol2CodeConverter.asReferences(e,i),e=>a.handleFailedRequest(r.ReferencesRequest.type,i,e,null)),s=a.middleware;return s.provideReferences?s.provideReferences(e,t,n,i,o):o(e,t,n,i)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return n.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};exports.ReferencesFeature=o}),le=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.CodeActionFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=v(),a=b();var o=class extends a.TextDocumentLanguageFeature{constructor(e){super(e,r.CodeActionRequest.type)}fillClientCapabilities(e){let t=(0,a.ensure)((0,a.ensure)(e,`textDocument`),`codeAction`);t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:[`edit`]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[r.CodeActionKind.Empty,r.CodeActionKind.QuickFix,r.CodeActionKind.Refactor,r.CodeActionKind.RefactorExtract,r.CodeActionKind.RefactorInline,r.CodeActionKind.RefactorRewrite,r.CodeActionKind.Source,r.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.codeActionProvider);n&&this.register({id:i.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,i={provideCodeActions:(e,t,n,i)=>{let a=this._client,o=async(e,t,n,i)=>{let o={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(e),range:a.code2ProtocolConverter.asRange(t),context:a.code2ProtocolConverter.asCodeActionContextSync(n)};return a.sendRequest(r.CodeActionRequest.type,o,i).then(e=>i.isCancellationRequested||e==null?null:a.protocol2CodeConverter.asCodeActionResult(e,i),e=>a.handleFailedRequest(r.CodeActionRequest.type,i,e,null))},s=a.middleware;return s.provideCodeActions?s.provideCodeActions(e,t,n,i,o):o(e,t,n,i)},resolveCodeAction:e.resolveProvider?(e,t)=>{let n=this._client,i=this._client.middleware,a=async(e,t)=>n.sendRequest(r.CodeActionResolveRequest.type,n.code2ProtocolConverter.asCodeActionSync(e),t).then(r=>t.isCancellationRequested?e:n.protocol2CodeConverter.asCodeAction(r,t),i=>n.handleFailedRequest(r.CodeActionResolveRequest.type,t,i,e));return i.resolveCodeAction?i.resolveCodeAction(e,t,a):a(e,t)}:void 0};return[n.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),i]}};exports.CodeActionFeature=o}),ue=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.CodeLensFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=v(),a=b();var o=class extends a.TextDocumentLanguageFeature{constructor(e){super(e,r.CodeLensRequest.type)}fillClientCapabilities(e){(0,a.ensure)((0,a.ensure)(e,`textDocument`),`codeLens`).dynamicRegistration=!0,(0,a.ensure)((0,a.ensure)(e,`workspace`),`codeLens`).refreshSupport=!0}initialize(e,t){let n=this._client;n.onRequest(r.CodeLensRefreshRequest.type,async()=>{for(let e of this.getAllProviders())e.onDidChangeCodeLensEmitter.fire()});let a=this.getRegistrationOptions(t,e.codeLensProvider);a&&this.register({id:i.generateUuid(),registerOptions:a})}registerLanguageProvider(e){let t=e.documentSelector,i=new n.EventEmitter,a={onDidChangeCodeLenses:i.event,provideCodeLenses:(e,t)=>{let n=this._client,i=(e,t)=>n.sendRequest(r.CodeLensRequest.type,n.code2ProtocolConverter.asCodeLensParams(e),t).then(e=>t.isCancellationRequested?null:n.protocol2CodeConverter.asCodeLenses(e,t),e=>n.handleFailedRequest(r.CodeLensRequest.type,t,e,null)),a=n.middleware;return a.provideCodeLenses?a.provideCodeLenses(e,t,i):i(e,t)},resolveCodeLens:e.resolveProvider?(e,t)=>{let n=this._client,i=(e,t)=>n.sendRequest(r.CodeLensResolveRequest.type,n.code2ProtocolConverter.asCodeLens(e),t).then(r=>t.isCancellationRequested?e:n.protocol2CodeConverter.asCodeLens(r),i=>n.handleFailedRequest(r.CodeLensResolveRequest.type,t,i,e)),a=n.middleware;return a.resolveCodeLens?a.resolveCodeLens(e,t,i):i(e,t)}:void 0};return[n.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),a),{provider:a,onDidChangeCodeLensEmitter:i}]}};exports.CodeLensFeature=o}),de=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.DocumentOnTypeFormattingFeature=exports.DocumentRangeFormattingFeature=exports.DocumentFormattingFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=v(),a=b();var o;(function(e){function t(e){let t=n.workspace.getConfiguration(`files`,e);return{trimTrailingWhitespace:t.get(`trimTrailingWhitespace`),trimFinalNewlines:t.get(`trimFinalNewlines`),insertFinalNewline:t.get(`insertFinalNewline`)}}e.fromConfiguration=t})(o||={});var s=class extends a.TextDocumentLanguageFeature{constructor(e){super(e,r.DocumentFormattingRequest.type)}fillClientCapabilities(e){(0,a.ensure)((0,a.ensure)(e,`textDocument`),`formatting`).dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentFormattingProvider);n&&this.register({id:i.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,i={provideDocumentFormattingEdits:(e,t,n)=>{let i=this._client,a=(e,t,n)=>{let a={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e),options:i.code2ProtocolConverter.asFormattingOptions(t,o.fromConfiguration(e))};return i.sendRequest(r.DocumentFormattingRequest.type,a,n).then(e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asTextEdits(e,n),e=>i.handleFailedRequest(r.DocumentFormattingRequest.type,n,e,null))},s=i.middleware;return s.provideDocumentFormattingEdits?s.provideDocumentFormattingEdits(e,t,n,a):a(e,t,n)}};return[n.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),i]}};exports.DocumentFormattingFeature=s;var c=class extends a.TextDocumentLanguageFeature{constructor(e){super(e,r.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){let t=(0,a.ensure)((0,a.ensure)(e,`textDocument`),`rangeFormatting`);t.dynamicRegistration=!0,t.rangesSupport=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);n&&this.register({id:i.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,i={provideDocumentRangeFormattingEdits:(e,t,n,i)=>{let a=this._client,s=(e,t,n,i)=>{let s={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(e),range:a.code2ProtocolConverter.asRange(t),options:a.code2ProtocolConverter.asFormattingOptions(n,o.fromConfiguration(e))};return a.sendRequest(r.DocumentRangeFormattingRequest.type,s,i).then(e=>i.isCancellationRequested?null:a.protocol2CodeConverter.asTextEdits(e,i),e=>a.handleFailedRequest(r.DocumentRangeFormattingRequest.type,i,e,null))},c=a.middleware;return c.provideDocumentRangeFormattingEdits?c.provideDocumentRangeFormattingEdits(e,t,n,i,s):s(e,t,n,i)}};return e.rangesSupport&&(i.provideDocumentRangesFormattingEdits=(e,t,n,i)=>{let a=this._client,s=(e,t,n,i)=>{let s={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(e),ranges:a.code2ProtocolConverter.asRanges(t),options:a.code2ProtocolConverter.asFormattingOptions(n,o.fromConfiguration(e))};return a.sendRequest(r.DocumentRangesFormattingRequest.type,s,i).then(e=>i.isCancellationRequested?null:a.protocol2CodeConverter.asTextEdits(e,i),e=>a.handleFailedRequest(r.DocumentRangesFormattingRequest.type,i,e,null))},c=a.middleware;return c.provideDocumentRangesFormattingEdits?c.provideDocumentRangesFormattingEdits(e,t,n,i,s):s(e,t,n,i)}),[n.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),i]}};exports.DocumentRangeFormattingFeature=c;var l=class extends a.TextDocumentLanguageFeature{constructor(e){super(e,r.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){(0,a.ensure)((0,a.ensure)(e,`textDocument`),`onTypeFormatting`).dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);n&&this.register({id:i.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,i={provideOnTypeFormattingEdits:(e,t,n,i,a)=>{let s=this._client,c=(e,t,n,i,a)=>{let c={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(e),position:s.code2ProtocolConverter.asPosition(t),ch:n,options:s.code2ProtocolConverter.asFormattingOptions(i,o.fromConfiguration(e))};return s.sendRequest(r.DocumentOnTypeFormattingRequest.type,c,a).then(e=>a.isCancellationRequested?null:s.protocol2CodeConverter.asTextEdits(e,a),e=>s.handleFailedRequest(r.DocumentOnTypeFormattingRequest.type,a,e,null))},l=s.middleware;return l.provideOnTypeFormattingEdits?l.provideOnTypeFormattingEdits(e,t,n,i,a,c):c(e,t,n,i,a)}},a=e.moreTriggerCharacter||[];return[n.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i,e.firstTriggerCharacter,...a),i]}};exports.DocumentOnTypeFormattingFeature=l}),fe=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.RenameFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=v(),o=a(),s=b();var c=class extends s.TextDocumentLanguageFeature{constructor(e){super(e,r.RenameRequest.type)}fillClientCapabilities(e){let t=(0,s.ensure)((0,s.ensure)(e,`textDocument`),`rename`);t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=r.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.renameProvider);n&&(o.boolean(e.renameProvider)&&(n.prepareProvider=!1),this.register({id:i.generateUuid(),registerOptions:n}))}registerLanguageProvider(e){let t=e.documentSelector,n={provideRenameEdits:(e,t,n,i)=>{let a=this._client,o=(e,t,n,i)=>{let o={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(e),position:a.code2ProtocolConverter.asPosition(t),newName:n};return a.sendRequest(r.RenameRequest.type,o,i).then(e=>i.isCancellationRequested?null:a.protocol2CodeConverter.asWorkspaceEdit(e,i),e=>a.handleFailedRequest(r.RenameRequest.type,i,e,null,!1))},s=a.middleware;return s.provideRenameEdits?s.provideRenameEdits(e,t,n,i,o):o(e,t,n,i)},prepareRename:e.prepareProvider?(e,t,n)=>{let i=this._client,a=(e,t,n)=>{let a={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e),position:i.code2ProtocolConverter.asPosition(t)};return i.sendRequest(r.PrepareRenameRequest.type,a,n).then(e=>n.isCancellationRequested?null:r.Range.is(e)?i.protocol2CodeConverter.asRange(e):this.isDefaultBehavior(e)?e.defaultBehavior===!0?null:Promise.reject(Error(`The element can't be renamed.`)):e&&r.Range.is(e.range)?{range:i.protocol2CodeConverter.asRange(e.range),placeholder:e.placeholder}:Promise.reject(Error(`The element can't be renamed.`)),e=>{throw typeof e.message==`string`?Error(e.message):Error(`The element can't be renamed.`)})},o=i.middleware;return o.prepareRename?o.prepareRename(e,t,n,a):a(e,t,n)}:void 0};return[this.registerProvider(t,n),n]}registerProvider(e,t){return n.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}isDefaultBehavior(e){let t=e;return t&&o.boolean(t.defaultBehavior)}};exports.RenameFeature=c}),pe=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.DocumentLinkFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b(),a=v();var o=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.DocumentLinkRequest.type)}fillClientCapabilities(e){let t=(0,i.ensure)((0,i.ensure)(e,`textDocument`),`documentLink`);t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentLinkProvider);n&&this.register({id:a.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,i={provideDocumentLinks:(e,t)=>{let n=this._client,i=(e,t)=>n.sendRequest(r.DocumentLinkRequest.type,n.code2ProtocolConverter.asDocumentLinkParams(e),t).then(e=>t.isCancellationRequested?null:n.protocol2CodeConverter.asDocumentLinks(e,t),e=>n.handleFailedRequest(r.DocumentLinkRequest.type,t,e,null)),a=n.middleware;return a.provideDocumentLinks?a.provideDocumentLinks(e,t,i):i(e,t)},resolveDocumentLink:e.resolveProvider?(e,t)=>{let n=this._client,i=(e,t)=>n.sendRequest(r.DocumentLinkResolveRequest.type,n.code2ProtocolConverter.asDocumentLink(e),t).then(r=>t.isCancellationRequested?e:n.protocol2CodeConverter.asDocumentLink(r),i=>n.handleFailedRequest(r.DocumentLinkResolveRequest.type,t,i,e)),a=n.middleware;return a.resolveDocumentLink?a.resolveDocumentLink(e,t,i):i(e,t)}:void 0};return[n.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),i]}};exports.DocumentLinkFeature=o}),me=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.ExecuteCommandFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=v(),a=b();var o=class{constructor(e){this._client=e,this._commands=new Map}getState(){return{kind:`workspace`,id:this.registrationType.method,registrations:this._commands.size>0}}get registrationType(){return r.ExecuteCommandRequest.type}fillClientCapabilities(e){(0,a.ensure)((0,a.ensure)(e,`workspace`),`executeCommand`).dynamicRegistration=!0}initialize(e){e.executeCommandProvider&&this.register({id:i.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){let t=this._client,i=t.middleware,a=(e,n)=>{let i={command:e,arguments:n};return t.sendRequest(r.ExecuteCommandRequest.type,i).then(void 0,e=>t.handleFailedRequest(r.ExecuteCommandRequest.type,void 0,e,void 0))};if(e.registerOptions.commands){let t=[];for(let r of e.registerOptions.commands)t.push(n.commands.registerCommand(r,(...e)=>i.executeCommand?i.executeCommand(r,e,a):a(r,e)));this._commands.set(e.id,t)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(e=>e.dispose())}clear(){this._commands.forEach(e=>{e.forEach(e=>e.dispose())}),this._commands.clear()}};exports.ExecuteCommandFeature=o}),he=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.FileSystemWatcherFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b();var a=class{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}getState(){return{kind:`workspace`,id:this.registrationType.method,registrations:this._watchers.size>0}}get registrationType(){return r.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){(0,i.ensure)((0,i.ensure)(e,`workspace`),`didChangeWatchedFiles`).dynamicRegistration=!0,(0,i.ensure)((0,i.ensure)(e,`workspace`),`didChangeWatchedFiles`).relativePatternSupport=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;let t=[];for(let i of e.registerOptions.watchers){let e=this._client.protocol2CodeConverter.asGlobPattern(i.globPattern);if(e===void 0)continue;let a=!0,o=!0,s=!0;i.kind!==void 0&&i.kind!==null&&(a=(i.kind&r.WatchKind.Create)!==0,o=(i.kind&r.WatchKind.Change)!==0,s=(i.kind&r.WatchKind.Delete)!==0);let c=n.workspace.createFileSystemWatcher(e,!a,!o,!s);this.hookListeners(c,a,o,s,t),t.push(c)}this._watchers.set(e.id,t)}registerRaw(e,t){let n=[];for(let e of t)this.hookListeners(e,!0,!0,!0,n);this._watchers.set(e,n)}hookListeners(e,t,n,i,a){t&&e.onDidCreate(e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:r.FileChangeType.Created}),null,a),n&&e.onDidChange(e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:r.FileChangeType.Changed}),null,a),i&&e.onDidDelete(e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:r.FileChangeType.Deleted}),null,a)}unregister(e){let t=this._watchers.get(e);if(t)for(let e of t)e.dispose()}clear(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}};exports.FileSystemWatcherFeature=a}),ge=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.ColorProviderFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b();var a=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.DocumentColorRequest.type)}fillClientCapabilities(e){(0,i.ensure)((0,i.ensure)(e,`textDocument`),`colorProvider`).dynamicRegistration=!0}initialize(e,t){let[n,r]=this.getRegistration(t,e.colorProvider);!n||!r||this.register({id:n,registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,i={provideColorPresentations:(e,t,n)=>{let i=this._client,a=(e,t,n)=>{let a={color:e,textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(t.document),range:i.code2ProtocolConverter.asRange(t.range)};return i.sendRequest(r.ColorPresentationRequest.type,a,n).then(e=>n.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(e,n),e=>i.handleFailedRequest(r.ColorPresentationRequest.type,n,e,null))},o=i.middleware;return o.provideColorPresentations?o.provideColorPresentations(e,t,n,a):a(e,t,n)},provideDocumentColors:(e,t)=>{let n=this._client,i=(e,t)=>{let i={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e)};return n.sendRequest(r.DocumentColorRequest.type,i,t).then(e=>t.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(e,t),e=>n.handleFailedRequest(r.DocumentColorRequest.type,t,e,null))},a=n.middleware;return a.provideDocumentColors?a.provideDocumentColors(e,t,i):i(e,t)}};return[n.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),i]}};exports.ColorProviderFeature=a}),_e=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.ImplementationFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b();var a=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.ImplementationRequest.type)}fillClientCapabilities(e){let t=(0,i.ensure)((0,i.ensure)(e,`textDocument`),`implementation`);t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[n,r]=this.getRegistration(t,e.implementationProvider);!n||!r||this.register({id:n,registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,n={provideImplementation:(e,t,n)=>{let i=this._client,a=(e,t,n)=>i.sendRequest(r.ImplementationRequest.type,i.code2ProtocolConverter.asTextDocumentPositionParams(e,t),n).then(e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asDefinitionResult(e,n),e=>i.handleFailedRequest(r.ImplementationRequest.type,n,e,null)),o=i.middleware;return o.provideImplementation?o.provideImplementation(e,t,n,a):a(e,t,n)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return n.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};exports.ImplementationFeature=a}),ve=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.TypeDefinitionFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b();var a=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.TypeDefinitionRequest.type)}fillClientCapabilities(e){(0,i.ensure)((0,i.ensure)(e,`textDocument`),`typeDefinition`).dynamicRegistration=!0;let t=(0,i.ensure)((0,i.ensure)(e,`textDocument`),`typeDefinition`);t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[n,r]=this.getRegistration(t,e.typeDefinitionProvider);!n||!r||this.register({id:n,registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,n={provideTypeDefinition:(e,t,n)=>{let i=this._client,a=(e,t,n)=>i.sendRequest(r.TypeDefinitionRequest.type,i.code2ProtocolConverter.asTextDocumentPositionParams(e,t),n).then(e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asDefinitionResult(e,n),e=>i.handleFailedRequest(r.TypeDefinitionRequest.type,n,e,null)),o=i.middleware;return o.provideTypeDefinition?o.provideTypeDefinition(e,t,n,a):a(e,t,n)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return n.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};exports.TypeDefinitionFeature=a}),E=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.WorkspaceFoldersFeature=exports.arrayDiff=void 0;let n=v(),r=require(`vscode`),i=t.require_main$1();function a(e,t){if(e!=null)return e[t]}function o(e,t){return e.filter(e=>t.indexOf(e)<0)}exports.arrayDiff=o;var s=class{constructor(e){this._client=e,this._listeners=new Map}getState(){return{kind:`workspace`,id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return i.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){let t=r.workspace.workspaceFolders;this.initializeWithFolders(t),t===void 0?e.workspaceFolders=null:e.workspaceFolders=t.map(e=>this.asProtocol(e))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){let t=this._client;t.onRequest(i.WorkspaceFoldersRequest.type,e=>{let n=()=>{let e=r.workspace.workspaceFolders;if(e===void 0)return null;let t=e.map(e=>this.asProtocol(e));return t},i=t.middleware.workspace;return i&&i.workspaceFolders?i.workspaceFolders(e,n):n(e)});let o=a(a(a(e,`workspace`),`workspaceFolders`),`changeNotifications`),s;typeof o==`string`?s=o:o===!0&&(s=n.generateUuid()),s&&this.register({id:s,registerOptions:void 0})}sendInitialEvent(e){let t;if(this._initialFolders&&e){let n=o(this._initialFolders,e),r=o(e,this._initialFolders);(r.length>0||n.length>0)&&(t=this.doSendEvent(r,n))}else this._initialFolders?t=this.doSendEvent([],this._initialFolders):e&&(t=this.doSendEvent(e,[]));t!==void 0&&t.catch(e=>{this._client.error(`Sending notification ${i.DidChangeWorkspaceFoldersNotification.type.method} failed`,e)})}doSendEvent(e,t){let n={event:{added:e.map(e=>this.asProtocol(e)),removed:t.map(e=>this.asProtocol(e))}};return this._client.sendNotification(i.DidChangeWorkspaceFoldersNotification.type,n)}register(e){let t=e.id,n=this._client,a=r.workspace.onDidChangeWorkspaceFolders(e=>{let t=e=>this.doSendEvent(e.added,e.removed),r=n.middleware.workspace,a=r&&r.didChangeWorkspaceFolders?r.didChangeWorkspaceFolders(e,t):t(e);a.catch(e=>{this._client.error(`Sending notification ${i.DidChangeWorkspaceFoldersNotification.type.method} failed`,e)})});this._listeners.set(t,a),this.sendInitialEvent(r.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);t!==void 0&&(this._listeners.delete(e),t.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return e===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}};exports.WorkspaceFoldersFeature=s}),D=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.FoldingRangeFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b();var a=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=(0,i.ensure)((0,i.ensure)(e,`textDocument`),`foldingRange`);t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0,t.foldingRangeKind={valueSet:[r.FoldingRangeKind.Comment,r.FoldingRangeKind.Imports,r.FoldingRangeKind.Region]},t.foldingRange={collapsedText:!1},(0,i.ensure)((0,i.ensure)(e,`workspace`),`foldingRange`).refreshSupport=!0}initialize(e,t){this._client.onRequest(r.FoldingRangeRefreshRequest.type,async()=>{for(let e of this.getAllProviders())e.onDidChangeFoldingRange.fire()});let[n,i]=this.getRegistration(t,e.foldingRangeProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,i=new n.EventEmitter,a={onDidChangeFoldingRanges:i.event,provideFoldingRanges:(e,t,n)=>{let i=this._client,a=(e,t,n)=>{let a={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e)};return i.sendRequest(r.FoldingRangeRequest.type,a,n).then(e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asFoldingRanges(e,n),e=>i.handleFailedRequest(r.FoldingRangeRequest.type,n,e,null))},o=i.middleware;return o.provideFoldingRanges?o.provideFoldingRanges(e,t,n,a):a(e,t,n)}};return[n.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),a),{provider:a,onDidChangeFoldingRange:i}]}};exports.FoldingRangeFeature=a}),ye=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.DeclarationFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b();var a=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.DeclarationRequest.type)}fillClientCapabilities(e){let t=(0,i.ensure)((0,i.ensure)(e,`textDocument`),`declaration`);t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[n,r]=this.getRegistration(t,e.declarationProvider);!n||!r||this.register({id:n,registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,n={provideDeclaration:(e,t,n)=>{let i=this._client,a=(e,t,n)=>i.sendRequest(r.DeclarationRequest.type,i.code2ProtocolConverter.asTextDocumentPositionParams(e,t),n).then(e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asDeclarationResult(e,n),e=>i.handleFailedRequest(r.DeclarationRequest.type,n,e,null)),o=i.middleware;return o.provideDeclaration?o.provideDeclaration(e,t,n,a):a(e,t,n)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return n.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};exports.DeclarationFeature=a}),be=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.SelectionRangeFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b();var a=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.SelectionRangeRequest.type)}fillClientCapabilities(e){let t=(0,i.ensure)((0,i.ensure)(e,`textDocument`),`selectionRange`);t.dynamicRegistration=!0}initialize(e,t){let[n,r]=this.getRegistration(t,e.selectionRangeProvider);!n||!r||this.register({id:n,registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,n={provideSelectionRanges:(e,t,n)=>{let i=this._client,a=async(e,t,n)=>{let a={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e),positions:i.code2ProtocolConverter.asPositionsSync(t,n)};return i.sendRequest(r.SelectionRangeRequest.type,a,n).then(e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asSelectionRanges(e,n),e=>i.handleFailedRequest(r.SelectionRangeRequest.type,n,e,null))},o=i.middleware;return o.provideSelectionRanges?o.provideSelectionRanges(e,t,n,a):a(e,t,n)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return n.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};exports.SelectionRangeFeature=a}),O=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.ProgressFeature=void 0;let n=t.require_main$1(),r=y();function i(e,t){return e[t]===void 0&&(e[t]=Object.create(null)),e[t]}var a=class{constructor(e){this._client=e,this.activeParts=new Set}getState(){return{kind:`window`,id:n.WorkDoneProgressCreateRequest.method,registrations:this.activeParts.size>0}}fillClientCapabilities(e){i(e,`window`).workDoneProgress=!0}initialize(){let e=this._client,t=e=>{this.activeParts.delete(e)},i=e=>{this.activeParts.add(new r.ProgressPart(this._client,e.token,t))};e.onRequest(n.WorkDoneProgressCreateRequest.type,i)}clear(){for(let e of this.activeParts)e.done();this.activeParts.clear()}};exports.ProgressFeature=a}),xe=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.CallHierarchyFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b();var a=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareCallHierarchy(e,t,n){let i=this.client,a=this.middleware,o=(e,t,n)=>{let a=i.code2ProtocolConverter.asTextDocumentPositionParams(e,t);return i.sendRequest(r.CallHierarchyPrepareRequest.type,a,n).then(e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyItems(e,n),e=>i.handleFailedRequest(r.CallHierarchyPrepareRequest.type,n,e,null))};return a.prepareCallHierarchy?a.prepareCallHierarchy(e,t,n,o):o(e,t,n)}provideCallHierarchyIncomingCalls(e,t){let n=this.client,i=this.middleware,a=(e,t)=>{let i={item:n.code2ProtocolConverter.asCallHierarchyItem(e)};return n.sendRequest(r.CallHierarchyIncomingCallsRequest.type,i,t).then(e=>t.isCancellationRequested?null:n.protocol2CodeConverter.asCallHierarchyIncomingCalls(e,t),e=>n.handleFailedRequest(r.CallHierarchyIncomingCallsRequest.type,t,e,null))};return i.provideCallHierarchyIncomingCalls?i.provideCallHierarchyIncomingCalls(e,t,a):a(e,t)}provideCallHierarchyOutgoingCalls(e,t){let n=this.client,i=this.middleware,a=(e,t)=>{let i={item:n.code2ProtocolConverter.asCallHierarchyItem(e)};return n.sendRequest(r.CallHierarchyOutgoingCallsRequest.type,i,t).then(e=>t.isCancellationRequested?null:n.protocol2CodeConverter.asCallHierarchyOutgoingCalls(e,t),e=>n.handleFailedRequest(r.CallHierarchyOutgoingCallsRequest.type,t,e,null))};return i.provideCallHierarchyOutgoingCalls?i.provideCallHierarchyOutgoingCalls(e,t,a):a(e,t)}},o=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=e,n=(0,i.ensure)((0,i.ensure)(t,`textDocument`),`callHierarchy`);n.dynamicRegistration=!0}initialize(e,t){let[n,r]=this.getRegistration(t,e.callHierarchyProvider);!n||!r||this.register({id:n,registerOptions:r})}registerLanguageProvider(e){let t=this._client,r=new a(t);return[n.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};exports.CallHierarchyFeature=o}),Se=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.SemanticTokensFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b(),o=a();var s=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){let t=(0,i.ensure)((0,i.ensure)(e,`textDocument`),`semanticTokens`);t.dynamicRegistration=!0,t.tokenTypes=[r.SemanticTokenTypes.namespace,r.SemanticTokenTypes.type,r.SemanticTokenTypes.class,r.SemanticTokenTypes.enum,r.SemanticTokenTypes.interface,r.SemanticTokenTypes.struct,r.SemanticTokenTypes.typeParameter,r.SemanticTokenTypes.parameter,r.SemanticTokenTypes.variable,r.SemanticTokenTypes.property,r.SemanticTokenTypes.enumMember,r.SemanticTokenTypes.event,r.SemanticTokenTypes.function,r.SemanticTokenTypes.method,r.SemanticTokenTypes.macro,r.SemanticTokenTypes.keyword,r.SemanticTokenTypes.modifier,r.SemanticTokenTypes.comment,r.SemanticTokenTypes.string,r.SemanticTokenTypes.number,r.SemanticTokenTypes.regexp,r.SemanticTokenTypes.operator,r.SemanticTokenTypes.decorator],t.tokenModifiers=[r.SemanticTokenModifiers.declaration,r.SemanticTokenModifiers.definition,r.SemanticTokenModifiers.readonly,r.SemanticTokenModifiers.static,r.SemanticTokenModifiers.deprecated,r.SemanticTokenModifiers.abstract,r.SemanticTokenModifiers.async,r.SemanticTokenModifiers.modification,r.SemanticTokenModifiers.documentation,r.SemanticTokenModifiers.defaultLibrary],t.formats=[r.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,t.serverCancelSupport=!0,t.augmentsSyntaxTokens=!0,(0,i.ensure)((0,i.ensure)(e,`workspace`),`semanticTokens`).refreshSupport=!0}initialize(e,t){let n=this._client;n.onRequest(r.SemanticTokensRefreshRequest.type,async()=>{for(let e of this.getAllProviders())e.onDidChangeSemanticTokensEmitter.fire()});let[i,a]=this.getRegistration(t,e.semanticTokensProvider);!i||!a||this.register({id:i,registerOptions:a})}registerLanguageProvider(e){let t=e.documentSelector,i=o.boolean(e.full)?e.full:e.full!==void 0,a=e.full!==void 0&&typeof e.full!=`boolean`&&e.full.delta===!0,s=new n.EventEmitter,c=i?{onDidChangeSemanticTokens:s.event,provideDocumentSemanticTokens:(e,t)=>{let n=this._client,i=n.middleware,a=(e,t)=>{let i={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e)};return n.sendRequest(r.SemanticTokensRequest.type,i,t).then(e=>t.isCancellationRequested?null:n.protocol2CodeConverter.asSemanticTokens(e,t),e=>n.handleFailedRequest(r.SemanticTokensRequest.type,t,e,null))};return i.provideDocumentSemanticTokens?i.provideDocumentSemanticTokens(e,t,a):a(e,t)},provideDocumentSemanticTokensEdits:a?(e,t,n)=>{let i=this._client,a=i.middleware,o=(e,t,n)=>{let a={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e),previousResultId:t};return i.sendRequest(r.SemanticTokensDeltaRequest.type,a,n).then(async e=>n.isCancellationRequested?null:r.SemanticTokens.is(e)?await i.protocol2CodeConverter.asSemanticTokens(e,n):await i.protocol2CodeConverter.asSemanticTokensEdits(e,n),e=>i.handleFailedRequest(r.SemanticTokensDeltaRequest.type,n,e,null))};return a.provideDocumentSemanticTokensEdits?a.provideDocumentSemanticTokensEdits(e,t,n,o):o(e,t,n)}:void 0}:void 0,l=e.range===!0,u=l?{provideDocumentRangeSemanticTokens:(e,t,n)=>{let i=this._client,a=i.middleware,o=(e,t,n)=>{let a={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e),range:i.code2ProtocolConverter.asRange(t)};return i.sendRequest(r.SemanticTokensRangeRequest.type,a,n).then(e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asSemanticTokens(e,n),e=>i.handleFailedRequest(r.SemanticTokensRangeRequest.type,n,e,null))};return a.provideDocumentRangeSemanticTokens?a.provideDocumentRangeSemanticTokens(e,t,n,o):o(e,t,n)}}:void 0,d=[],f=this._client,p=f.protocol2CodeConverter.asSemanticTokensLegend(e.legend),m=f.protocol2CodeConverter.asDocumentSelector(t);return c!==void 0&&d.push(n.languages.registerDocumentSemanticTokensProvider(m,c,p)),u!==void 0&&d.push(n.languages.registerDocumentRangeSemanticTokensProvider(m,u,p)),[new n.Disposable(()=>d.forEach(e=>e.dispose())),{range:u,full:c,onDidChangeSemanticTokensEmitter:s}]}};exports.SemanticTokensFeature=s}),Ce=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.WillDeleteFilesFeature=exports.WillRenameFilesFeature=exports.WillCreateFilesFeature=exports.DidDeleteFilesFeature=exports.DidRenameFilesFeature=exports.DidCreateFilesFeature=void 0;let n=require(`vscode`),r=ee(),i=t.require_main$1(),a=v();function o(e,t){return e[t]===void 0&&(e[t]={}),e[t]}function s(e,t){return e[t]}function c(e,t,n){e[t]=n}var l=class e{constructor(e,t,n,r,i){this._client=e,this._event=t,this._registrationType=n,this._clientCapability=r,this._serverCapability=i,this._filters=new Map}getState(){return{kind:`workspace`,id:this._registrationType.method,registrations:this._filters.size>0}}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){let t=o(o(e,`workspace`),`fileOperations`);c(t,`dynamicRegistration`,!0),c(t,this._clientCapability,!0)}initialize(e){let t=e.workspace?.fileOperations,n=t===void 0?void 0:s(t,this._serverCapability);if(n?.filters!==void 0)try{this.register({id:a.generateUuid(),registerOptions:{filters:n.filters}})}catch(e){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${e}`)}}register(t){this._listener||=this._event(this.send,this);let n=t.registerOptions.filters.map(t=>{let n=new r.Minimatch(t.pattern.glob,e.asMinimatchOptions(t.pattern.options));if(!n.makeRe())throw Error(`Invalid pattern ${t.pattern.glob}!`);return{scheme:t.scheme,matcher:n,kind:t.pattern.matches}});this._filters.set(t.id,n)}unregister(e){this._filters.delete(e),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(t){return e.getFileType(t)}async filter(t,r){let a=await Promise.all(t.files.map(async t=>{let a=r(t),o=a.fsPath.replace(/\\/g,`/`);for(let t of this._filters.values())for(let r of t){if(r.scheme!==void 0&&r.scheme!==a.scheme)continue;if(r.matcher.match(o)){if(r.kind===void 0)return!0;let e=await this.getFileType(a);if(e===void 0)return this._client.error(`Failed to determine file type for ${a.toString()}.`),!0;if(e===n.FileType.File&&r.kind===i.FileOperationPatternKind.file||e===n.FileType.Directory&&r.kind===i.FileOperationPatternKind.folder)return!0}else if(r.kind===i.FileOperationPatternKind.folder){let t=await e.getFileType(a);if(t===n.FileType.Directory&&r.matcher.match(`${o}/`))return!0}}return!1})),o=t.files.filter((e,t)=>a[t]);return{...t,files:o}}static async getFileType(e){try{return(await n.workspace.fs.stat(e)).type}catch{return}}static asMinimatchOptions(e){let t={dot:!0};return e?.ignoreCase===!0&&(t.nocase=!0),t}},u=class extends l{constructor(e,t,n,r,i,a,o){super(e,t,n,r,i),this._notificationType=n,this._accessUri=a,this._createParams=o}async send(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let e=async e=>this._client.sendNotification(this._notificationType,this._createParams(e));return this.doSend(t,e)}}},d=class extends u{constructor(){super(...arguments),this._fsPathFileTypes=new Map}async getFileType(e){let t=e.fsPath;if(this._fsPathFileTypes.has(t))return this._fsPathFileTypes.get(t);let n=await l.getFileType(e);return n&&this._fsPathFileTypes.set(t,n),n}async cacheFileTypes(e,t){await this.filter(e,t)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}clear(){super.clear(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}},f=class extends u{constructor(e){super(e,n.workspace.onDidCreateFiles,i.DidCreateFilesNotification.type,`didCreate`,`didCreate`,e=>e,e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,t){let n=this._client.middleware.workspace;return n?.didCreateFiles?n.didCreateFiles(e,t):t(e)}};exports.DidCreateFilesFeature=f;var p=class extends d{constructor(e){super(e,n.workspace.onDidRenameFiles,i.DidRenameFilesNotification.type,`didRename`,`didRename`,e=>e.oldUri,e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||=n.workspace.onWillRenameFiles(this.willRename,this),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,e=>e.oldUri))}doSend(e,t){this.clearFileTypeCache();let n=this._client.middleware.workspace;return n?.didRenameFiles?n.didRenameFiles(e,t):t(e)}};exports.DidRenameFilesFeature=p;var m=class extends d{constructor(e){super(e,n.workspace.onDidDeleteFiles,i.DidDeleteFilesNotification.type,`didDelete`,`didDelete`,e=>e,e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||=n.workspace.onWillDeleteFiles(this.willDelete,this),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,e=>e))}doSend(e,t){this.clearFileTypeCache();let n=this._client.middleware.workspace;return n?.didDeleteFiles?n.didDeleteFiles(e,t):t(e)}};exports.DidDeleteFilesFeature=m;var h=class extends l{constructor(e,t,n,r,i,a,o){super(e,t,n,r,i),this._requestType=n,this._accessUri=a,this._createParams=o}async send(e){let t=this.waitUntil(e);e.waitUntil(t)}async waitUntil(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let e=e=>this._client.sendRequest(this._requestType,this._createParams(e),e.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(t,e)}else return}},g=class extends h{constructor(e){super(e,n.workspace.onWillCreateFiles,i.WillCreateFilesRequest.type,`willCreate`,`willCreate`,e=>e,e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,t){let n=this._client.middleware.workspace;return n?.willCreateFiles?n.willCreateFiles(e,t):t(e)}};exports.WillCreateFilesFeature=g;var _=class extends h{constructor(e){super(e,n.workspace.onWillRenameFiles,i.WillRenameFilesRequest.type,`willRename`,`willRename`,e=>e.oldUri,e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,t){let n=this._client.middleware.workspace;return n?.willRenameFiles?n.willRenameFiles(e,t):t(e)}};exports.WillRenameFilesFeature=_;var y=class extends h{constructor(e){super(e,n.workspace.onWillDeleteFiles,i.WillDeleteFilesRequest.type,`willDelete`,`willDelete`,e=>e,e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,t){let n=this._client.middleware.workspace;return n?.willDeleteFiles?n.willDeleteFiles(e,t):t(e)}};exports.WillDeleteFilesFeature=y}),we=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.LinkedEditingFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b();var a=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){let t=(0,i.ensure)((0,i.ensure)(e,`textDocument`),`linkedEditingRange`);t.dynamicRegistration=!0}initialize(e,t){let[n,r]=this.getRegistration(t,e.linkedEditingRangeProvider);!n||!r||this.register({id:n,registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,n={provideLinkedEditingRanges:(e,t,n)=>{let i=this._client,a=(e,t,n)=>i.sendRequest(r.LinkedEditingRangeRequest.type,i.code2ProtocolConverter.asTextDocumentPositionParams(e,t),n).then(e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asLinkedEditingRanges(e,n),e=>i.handleFailedRequest(r.LinkedEditingRangeRequest.type,n,e,null)),o=i.middleware;return o.provideLinkedEditingRange?o.provideLinkedEditingRange(e,t,n,a):a(e,t,n)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return n.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};exports.LinkedEditingFeature=a}),Te=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.TypeHierarchyFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b();var a=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareTypeHierarchy(e,t,n){let i=this.client,a=this.middleware,o=(e,t,n)=>{let a=i.code2ProtocolConverter.asTextDocumentPositionParams(e,t);return i.sendRequest(r.TypeHierarchyPrepareRequest.type,a,n).then(e=>n.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(e,n),e=>i.handleFailedRequest(r.TypeHierarchyPrepareRequest.type,n,e,null))};return a.prepareTypeHierarchy?a.prepareTypeHierarchy(e,t,n,o):o(e,t,n)}provideTypeHierarchySupertypes(e,t){let n=this.client,i=this.middleware,a=(e,t)=>{let i={item:n.code2ProtocolConverter.asTypeHierarchyItem(e)};return n.sendRequest(r.TypeHierarchySupertypesRequest.type,i,t).then(e=>t.isCancellationRequested?null:n.protocol2CodeConverter.asTypeHierarchyItems(e,t),e=>n.handleFailedRequest(r.TypeHierarchySupertypesRequest.type,t,e,null))};return i.provideTypeHierarchySupertypes?i.provideTypeHierarchySupertypes(e,t,a):a(e,t)}provideTypeHierarchySubtypes(e,t){let n=this.client,i=this.middleware,a=(e,t)=>{let i={item:n.code2ProtocolConverter.asTypeHierarchyItem(e)};return n.sendRequest(r.TypeHierarchySubtypesRequest.type,i,t).then(e=>t.isCancellationRequested?null:n.protocol2CodeConverter.asTypeHierarchyItems(e,t),e=>n.handleFailedRequest(r.TypeHierarchySubtypesRequest.type,t,e,null))};return i.provideTypeHierarchySubtypes?i.provideTypeHierarchySubtypes(e,t,a):a(e,t)}},o=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=(0,i.ensure)((0,i.ensure)(e,`textDocument`),`typeHierarchy`);t.dynamicRegistration=!0}initialize(e,t){let[n,r]=this.getRegistration(t,e.typeHierarchyProvider);!n||!r||this.register({id:n,registerOptions:r})}registerLanguageProvider(e){let t=this._client,r=new a(t);return[n.languages.registerTypeHierarchyProvider(t.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};exports.TypeHierarchyFeature=o}),Ee=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.InlineValueFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b();var a=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.InlineValueRequest.type)}fillClientCapabilities(e){(0,i.ensure)((0,i.ensure)(e,`textDocument`),`inlineValue`).dynamicRegistration=!0,(0,i.ensure)((0,i.ensure)(e,`workspace`),`inlineValue`).refreshSupport=!0}initialize(e,t){this._client.onRequest(r.InlineValueRefreshRequest.type,async()=>{for(let e of this.getAllProviders())e.onDidChangeInlineValues.fire()});let[n,i]=this.getRegistration(t,e.inlineValueProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,i=new n.EventEmitter,a={onDidChangeInlineValues:i.event,provideInlineValues:(e,t,n,i)=>{let a=this._client,o=(e,t,n,i)=>{let o={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(e),range:a.code2ProtocolConverter.asRange(t),context:a.code2ProtocolConverter.asInlineValueContext(n)};return a.sendRequest(r.InlineValueRequest.type,o,i).then(e=>i.isCancellationRequested?null:a.protocol2CodeConverter.asInlineValues(e,i),e=>a.handleFailedRequest(r.InlineValueRequest.type,i,e,null))},s=a.middleware;return s.provideInlineValues?s.provideInlineValues(e,t,n,i,o):o(e,t,n,i)}};return[this.registerProvider(t,a),{provider:a,onDidChangeInlineValues:i}]}registerProvider(e,t){return n.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};exports.InlineValueFeature=a}),De=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.InlayHintsFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b();var a=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.InlayHintRequest.type)}fillClientCapabilities(e){let t=(0,i.ensure)((0,i.ensure)(e,`textDocument`),`inlayHint`);t.dynamicRegistration=!0,t.resolveSupport={properties:[`tooltip`,`textEdits`,`label.tooltip`,`label.location`,`label.command`]},(0,i.ensure)((0,i.ensure)(e,`workspace`),`inlayHint`).refreshSupport=!0}initialize(e,t){this._client.onRequest(r.InlayHintRefreshRequest.type,async()=>{for(let e of this.getAllProviders())e.onDidChangeInlayHints.fire()});let[n,i]=this.getRegistration(t,e.inlayHintProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,i=new n.EventEmitter,a={onDidChangeInlayHints:i.event,provideInlayHints:(e,t,n)=>{let i=this._client,a=async(e,t,n)=>{let a={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e),range:i.code2ProtocolConverter.asRange(t)};try{let e=await i.sendRequest(r.InlayHintRequest.type,a,n);return n.isCancellationRequested?null:i.protocol2CodeConverter.asInlayHints(e,n)}catch(e){return i.handleFailedRequest(r.InlayHintRequest.type,n,e,null)}},o=i.middleware;return o.provideInlayHints?o.provideInlayHints(e,t,n,a):a(e,t,n)}};return a.resolveInlayHint=e.resolveProvider===!0?(e,t)=>{let n=this._client,i=async(e,t)=>{try{let i=await n.sendRequest(r.InlayHintResolveRequest.type,n.code2ProtocolConverter.asInlayHint(e),t);if(t.isCancellationRequested)return null;let a=n.protocol2CodeConverter.asInlayHint(i,t);return t.isCancellationRequested?null:a}catch(e){return n.handleFailedRequest(r.InlayHintResolveRequest.type,t,e,null)}},a=n.middleware;return a.resolveInlayHint?a.resolveInlayHint(e,t,i):i(e,t)}:void 0,[this.registerProvider(t,a),{provider:a,onDidChangeInlayHints:i}]}registerProvider(e,t){return n.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};exports.InlayHintsFeature=a}),Oe=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.InlineCompletionItemFeature=void 0;let n=require(`vscode`),r=t.require_main$1(),i=b(),a=v();var o=class extends i.TextDocumentLanguageFeature{constructor(e){super(e,r.InlineCompletionRequest.type)}fillClientCapabilities(e){let t=(0,i.ensure)((0,i.ensure)(e,`textDocument`),`inlineCompletion`);t.dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.inlineCompletionProvider);n&&this.register({id:a.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,i={provideInlineCompletionItems:(e,t,n,i)=>{let a=this._client,o=this._client.middleware,s=(e,t,n,i)=>a.sendRequest(r.InlineCompletionRequest.type,a.code2ProtocolConverter.asInlineCompletionParams(e,t,n),i).then(e=>i.isCancellationRequested?null:a.protocol2CodeConverter.asInlineCompletionResult(e,i),e=>a.handleFailedRequest(r.InlineCompletionRequest.type,i,e,null));return o.provideInlineCompletionItems?o.provideInlineCompletionItems(e,t,n,i,s):s(e,t,n,i)}};return[n.languages.registerInlineCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),i]}};exports.InlineCompletionItemFeature=o}),ke=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.ProposedFeatures=exports.BaseLanguageClient=exports.MessageTransports=exports.SuspendMode=exports.State=exports.CloseAction=exports.ErrorAction=exports.RevealOutputChannelOn=void 0;let n=require(`vscode`),r=t.require_main$1(),i=g(),s=_(),c=a(),l=o(),u=v(),d=y(),f=b(),p=te(),m=S(),h=ne(),x=C(),ee=re(),ke=ie(),Ae=w(),je=T(),Me=ae(),k=oe(),Ne=se(),Pe=ce(),Fe=le(),Ie=ue(),Le=de(),Re=fe(),ze=pe(),A=me(),Be=he(),j=ge(),Ve=_e(),He=ve(),Ue=E(),We=D(),Ge=ye(),Ke=be(),qe=O(),Je=xe(),Ye=Se(),M=Ce(),Xe=we(),Ze=Te(),N=Ee(),Qe=De(),$e=Oe();var P;(function(e){e[e.Debug=0]=`Debug`,e[e.Info=1]=`Info`,e[e.Warn=2]=`Warn`,e[e.Error=3]=`Error`,e[e.Never=4]=`Never`})(P||(exports.RevealOutputChannelOn=P={}));var et;(function(e){e[e.Continue=1]=`Continue`,e[e.Shutdown=2]=`Shutdown`})(et||(exports.ErrorAction=et={}));var F;(function(e){e[e.DoNotRestart=1]=`DoNotRestart`,e[e.Restart=2]=`Restart`})(F||(exports.CloseAction=F={}));var I;(function(e){e[e.Stopped=1]=`Stopped`,e[e.Starting=3]=`Starting`,e[e.Running=2]=`Running`})(I||(exports.State=I={}));var tt;(function(e){e.off=`off`,e.on=`on`})(tt||(exports.SuspendMode=tt={}));var nt;(function(e){function t(e){return e==null?!1:typeof e==`boolean`||typeof e==`object`&&e&&c.stringArray(e.enabledCommands)?e:!1}e.sanitizeIsTrusted=t})(nt||={});var rt=class{constructor(e,t){this.client=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,n){return n&&n<=3?{action:et.Continue}:{action:et.Shutdown}}closed(){if(this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount)return{action:F.Restart};{let e=this.restarts[this.restarts.length-1]-this.restarts[0];return e<=3*60*1e3?{action:F.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:F.Restart})}}},L;(function(e){e.Initial=`initial`,e.Starting=`starting`,e.StartFailed=`startFailed`,e.Running=`running`,e.Stopping=`stopping`,e.Stopped=`stopped`})(L||={});var it;(function(e){function t(e){let t=e;return t&&r.MessageReader.is(e.reader)&&r.MessageWriter.is(e.writer)}e.is=t})(it||(exports.MessageTransports=it={}));var at=class e{constructor(e,t,n){this._traceFormat=r.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:`idle`},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new l.Semaphore(1),this._id=e,this._name=t,n||={};let a={isTrusted:!1,supportHtml:!1};n.markdown!==void 0&&(a.isTrusted=nt.sanitizeIsTrusted(n.markdown.isTrusted),a.supportHtml=n.markdown.supportHtml===!0),this._clientOptions={documentSelector:n.documentSelector??[],synchronize:n.synchronize??{},diagnosticCollectionName:n.diagnosticCollectionName,outputChannelName:n.outputChannelName??this._name,revealOutputChannelOn:n.revealOutputChannelOn??P.Error,stdioEncoding:n.stdioEncoding??`utf8`,initializationOptions:n.initializationOptions,initializationFailedHandler:n.initializationFailedHandler,progressOnInitialization:!!n.progressOnInitialization,errorHandler:n.errorHandler??this.createDefaultErrorHandler(n.connectionOptions?.maxRestartCount),middleware:n.middleware??{},uriConverters:n.uriConverters,workspaceFolder:n.workspaceFolder,connectionOptions:n.connectionOptions,markdown:a,diagnosticPullOptions:n.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:n.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=L.Initial,this._ignoredRegistrations=new Set,this._listeners=[],this._notificationHandlers=new Map,this._pendingNotificationHandlers=new Map,this._notificationDisposables=new Map,this._requestHandlers=new Map,this._pendingRequestHandlers=new Map,this._requestDisposables=new Map,this._progressHandlers=new Map,this._pendingProgressHandlers=new Map,this._progressDisposables=new Map,this._connection=void 0,this._initializeResult=void 0,n.outputChannel?(this._outputChannel=n.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=n.traceOutputChannel,this._diagnostics=void 0,this._pendingOpenNotifications=new Set,this._pendingChangeSemaphore=new l.Semaphore(1),this._pendingChangeDelayer=new l.Delayer(250),this._fileEvents=[],this._fileEventDelayer=new l.Delayer(250),this._onStop=void 0,this._telemetryEmitter=new r.Emitter,this._stateChangeEmitter=new r.Emitter,this._trace=r.Trace.Off,this._tracer={log:(e,t)=>{c.string(e)?this.logTrace(e,t):this.logObjectTrace(e)}},this._c2p=i.createConverter(n.uriConverters?n.uriConverters.code2Protocol:void 0),this._p2c=s.createConverter(n.uriConverters?n.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get name(){return this._name}get middleware(){return this._clientOptions.middleware??Object.create(null)}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||=n.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}get state(){return this.getPublicState()}get $state(){return this._state}set $state(e){let t=this.getPublicState();this._state=e;let n=this.getPublicState();n!==t&&this._stateChangeEmitter.fire({oldState:t,newState:n})}getPublicState(){switch(this.$state){case L.Starting:return I.Starting;case L.Running:return I.Running;default:return I.Stopped}}get initializeResult(){return this._initializeResult}async sendRequest(e,...t){if(this.$state===L.StartFailed||this.$state===L.Stopping||this.$state===L.Stopped)return Promise.reject(new r.ResponseError(r.ErrorCodes.ConnectionInactive,`Client is not running`));let n=await this.$start();this._didChangeTextDocumentFeature.syncKind===r.TextDocumentSyncKind.Full&&await this.sendPendingFullTextDocumentChanges(n);let i=this._clientOptions.middleware?.sendRequest;if(i!==void 0){let a,o;return t.length===1?r.CancellationToken.is(t[0])?o=t[0]:a=t[0]:t.length===2&&(a=t[0],o=t[1]),i(e,a,o,(e,t,r)=>{let i=[];return t!==void 0&&i.push(t),r!==void 0&&i.push(r),n.sendRequest(e,...i)})}else return n.sendRequest(e,...t)}onRequest(e,t){let n=typeof e==`string`?e:e.method;this._requestHandlers.set(n,t);let r=this.activeConnection(),i;return r===void 0?(this._pendingRequestHandlers.set(n,t),i={dispose:()=>{this._pendingRequestHandlers.delete(n);let e=this._requestDisposables.get(n);e!==void 0&&(e.dispose(),this._requestDisposables.delete(n))}}):(this._requestDisposables.set(n,r.onRequest(e,t)),i={dispose:()=>{let e=this._requestDisposables.get(n);e!==void 0&&(e.dispose(),this._requestDisposables.delete(n))}}),{dispose:()=>{this._requestHandlers.delete(n),i.dispose()}}}async sendNotification(e,t){if(this.$state===L.StartFailed||this.$state===L.Stopping||this.$state===L.Stopped)return Promise.reject(new r.ResponseError(r.ErrorCodes.ConnectionInactive,`Client is not running`));let n=this._didChangeTextDocumentFeature.syncKind===r.TextDocumentSyncKind.Full,i;n&&typeof e!=`string`&&e.method===r.DidOpenTextDocumentNotification.method&&(i=t?.textDocument.uri,this._pendingOpenNotifications.add(i));let a=await this.$start();n&&await this.sendPendingFullTextDocumentChanges(a),i!==void 0&&this._pendingOpenNotifications.delete(i);let o=this._clientOptions.middleware?.sendNotification;return o?o(e,a.sendNotification.bind(a),t):a.sendNotification(e,t)}onNotification(e,t){let n=typeof e==`string`?e:e.method;this._notificationHandlers.set(n,t);let r=this.activeConnection(),i;return r===void 0?(this._pendingNotificationHandlers.set(n,t),i={dispose:()=>{this._pendingNotificationHandlers.delete(n);let e=this._notificationDisposables.get(n);e!==void 0&&(e.dispose(),this._notificationDisposables.delete(n))}}):(this._notificationDisposables.set(n,r.onNotification(e,t)),i={dispose:()=>{let e=this._notificationDisposables.get(n);e!==void 0&&(e.dispose(),this._notificationDisposables.delete(n))}}),{dispose:()=>{this._notificationHandlers.delete(n),i.dispose()}}}async sendProgress(e,t,n){if(this.$state===L.StartFailed||this.$state===L.Stopping||this.$state===L.Stopped)return Promise.reject(new r.ResponseError(r.ErrorCodes.ConnectionInactive,`Client is not running`));try{let r=await this.$start();return r.sendProgress(e,t,n)}catch(e){throw this.error(`Sending progress for token ${t} failed.`,e),e}}onProgress(e,t,n){this._progressHandlers.set(t,{type:e,handler:n});let i=this.activeConnection(),a,o=this._clientOptions.middleware?.handleWorkDoneProgress,s=r.WorkDoneProgress.is(e)&&o!==void 0?e=>{o(t,e,()=>n(e))}:n;return i===void 0?(this._pendingProgressHandlers.set(t,{type:e,handler:n}),a={dispose:()=>{this._pendingProgressHandlers.delete(t);let e=this._progressDisposables.get(t);e!==void 0&&(e.dispose(),this._progressDisposables.delete(t))}}):(this._progressDisposables.set(t,i.onProgress(e,t,s)),a={dispose:()=>{let e=this._progressDisposables.get(t);e!==void 0&&(e.dispose(),this._progressDisposables.delete(t))}}),{dispose:()=>{this._progressHandlers.delete(t),a.dispose()}}}createDefaultErrorHandler(e){if(e!==void 0&&e<0)throw Error(`Invalid maxRestartCount: ${e}`);return new rt(this,e??4)}async setTrace(e){this._trace=e;let t=this.activeConnection();t!==void 0&&await t.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}data2String(e){if(e instanceof r.ResponseError){let t=e;return`  Message: ${t.message}\n  Code: ${t.code} ${t.data?`
`+t.data.toString():``}`}return e instanceof Error?c.string(e.stack)?e.stack:e.message:c.string(e)?e:e.toString()}debug(e,t,n=!0){this.logOutputMessage(r.MessageType.Debug,P.Debug,`Debug`,e,t,n)}info(e,t,n=!0){this.logOutputMessage(r.MessageType.Info,P.Info,`Info`,e,t,n)}warn(e,t,n=!0){this.logOutputMessage(r.MessageType.Warning,P.Warn,`Warn`,e,t,n)}error(e,t,n=!0){this.logOutputMessage(r.MessageType.Error,P.Error,`Error`,e,t,n)}logOutputMessage(e,t,n,r,i,a){this.outputChannel.appendLine(`[${n.padEnd(5)} - ${new Date().toLocaleTimeString()}] ${r}`),i!=null&&this.outputChannel.appendLine(this.data2String(i)),(a===`force`||a&&this._clientOptions.revealOutputChannelOn<=t)&&this.showNotificationMessage(e,r)}showNotificationMessage(e,t){t??=`A request has failed. See the output for more information.`;let i=e===r.MessageType.Error?n.window.showErrorMessage:e===r.MessageType.Warning?n.window.showWarningMessage:n.window.showInformationMessage;i(t,`Go to output`).then(e=>{e!==void 0&&this.outputChannel.show(!0)})}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.$state===L.Initial||this.$state===L.Stopping||this.$state===L.Stopped}needsStop(){return this.$state===L.Starting||this.$state===L.Running}activeConnection(){return this.$state===L.Running&&this._connection!==void 0?this._connection:void 0}isRunning(){return this.$state===L.Running}async start(){if(this._disposed===`disposing`||this._disposed===`disposed`)throw Error(`Client got disposed and can't be restarted.`);if(this.$state===L.Stopping)throw Error(`Client is currently stopping. Can only restart a full stopped client`);if(this._onStart!==void 0)return this._onStart;let[e,t,i]=this.createOnStartPromise();this._onStart=e,this._diagnostics===void 0&&(this._diagnostics=this._clientOptions.diagnosticCollectionName?n.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):n.languages.createDiagnosticCollection());for(let[e,t]of this._notificationHandlers)this._pendingNotificationHandlers.has(e)||this._pendingNotificationHandlers.set(e,t);for(let[e,t]of this._requestHandlers)this._pendingRequestHandlers.has(e)||this._pendingRequestHandlers.set(e,t);for(let[e,t]of this._progressHandlers)this._pendingProgressHandlers.has(e)||this._pendingProgressHandlers.set(e,t);this.$state=L.Starting;try{let e=await this.createConnection();e.onNotification(r.LogMessageNotification.type,e=>{switch(e.type){case r.MessageType.Error:this.error(e.message,void 0,!1);break;case r.MessageType.Warning:this.warn(e.message,void 0,!1);break;case r.MessageType.Info:this.info(e.message,void 0,!1);break;case r.MessageType.Debug:this.debug(e.message,void 0,!1);break;default:this.outputChannel.appendLine(e.message)}}),e.onNotification(r.ShowMessageNotification.type,e=>{switch(e.type){case r.MessageType.Error:n.window.showErrorMessage(e.message);break;case r.MessageType.Warning:n.window.showWarningMessage(e.message);break;case r.MessageType.Info:n.window.showInformationMessage(e.message);break;default:n.window.showInformationMessage(e.message)}}),e.onRequest(r.ShowMessageRequest.type,e=>{let t;switch(e.type){case r.MessageType.Error:t=n.window.showErrorMessage;break;case r.MessageType.Warning:t=n.window.showWarningMessage;break;case r.MessageType.Info:t=n.window.showInformationMessage;break;default:t=n.window.showInformationMessage}let i=e.actions||[];return t(e.message,...i)}),e.onNotification(r.TelemetryEventNotification.type,e=>{this._telemetryEmitter.fire(e)}),e.onRequest(r.ShowDocumentRequest.type,async e=>{let t=async e=>{let t=this.protocol2CodeConverter.asUri(e.uri);try{if(e.external===!0){let e=await n.env.openExternal(t);return{success:e}}else{let r={};return e.selection!==void 0&&(r.selection=this.protocol2CodeConverter.asRange(e.selection)),e.takeFocus===void 0||e.takeFocus===!1?r.preserveFocus=!0:e.takeFocus===!0&&(r.preserveFocus=!1),await n.window.showTextDocument(t,r),{success:!0}}}catch{return{success:!1}}},r=this._clientOptions.middleware.window?.showDocument;return r===void 0?t(e):r(e,t)}),e.listen(),await this.initialize(e),t()}catch(e){this.$state=L.StartFailed,this.error(`${this._name} client: couldn't create connection to server.`,e,`force`),i(e)}return this._onStart}createOnStartPromise(){let e,t,n=new Promise((n,r)=>{e=n,t=r});return[n,e,t]}async initialize(e){this.refreshTrace(e,!1);let t=this._clientOptions.initializationOptions,[i,a]=this._clientOptions.workspaceFolder===void 0?[this._clientGetRootPath(),null]:[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]],o={processId:null,clientInfo:{name:n.env.appName,version:n.version},locale:this.getLocale(),rootPath:i||null,rootUri:i?this._c2p.asUri(n.Uri.file(i)):null,capabilities:this.computeClientCapabilities(),initializationOptions:c.func(t)?t():t,trace:r.Trace.toString(this._trace),workspaceFolders:a};if(this.fillInitializeParams(o),this._clientOptions.progressOnInitialization){let t=u.generateUuid(),n=new d.ProgressPart(e,t);o.workDoneToken=t;try{let t=await this.doInitialize(e,o);return n.done(),t}catch(e){throw n.cancel(),e}}else return this.doInitialize(e,o)}async doInitialize(e,t){try{let n=await e.initialize(t);if(n.capabilities.positionEncoding!==void 0&&n.capabilities.positionEncoding!==r.PositionEncodingKind.UTF16)throw Error(`Unsupported position encoding (${n.capabilities.positionEncoding}) received from server ${this.name}`);this._initializeResult=n,this.$state=L.Running;let i;c.number(n.capabilities.textDocumentSync)?i=n.capabilities.textDocumentSync===r.TextDocumentSyncKind.None?{openClose:!1,change:r.TextDocumentSyncKind.None,save:void 0}:{openClose:!0,change:n.capabilities.textDocumentSync,save:{includeText:!1}}:n.capabilities.textDocumentSync!==void 0&&n.capabilities.textDocumentSync!==null&&(i=n.capabilities.textDocumentSync),this._capabilities=Object.assign({},n.capabilities,{resolvedTextDocumentSync:i}),e.onNotification(r.PublishDiagnosticsNotification.type,e=>this.handleDiagnostics(e)),e.onRequest(r.RegistrationRequest.type,e=>this.handleRegistrationRequest(e)),e.onRequest(`client/registerFeature`,e=>this.handleRegistrationRequest(e)),e.onRequest(r.UnregistrationRequest.type,e=>this.handleUnregistrationRequest(e)),e.onRequest(`client/unregisterFeature`,e=>this.handleUnregistrationRequest(e)),e.onRequest(r.ApplyWorkspaceEditRequest.type,e=>this.handleApplyWorkspaceEdit(e));for(let[t,n]of this._pendingNotificationHandlers)this._notificationDisposables.set(t,e.onNotification(t,n));this._pendingNotificationHandlers.clear();for(let[t,n]of this._pendingRequestHandlers)this._requestDisposables.set(t,e.onRequest(t,n));this._pendingRequestHandlers.clear();for(let[t,n]of this._pendingProgressHandlers)this._progressDisposables.set(t,e.onProgress(n.type,t,n.handler));return this._pendingProgressHandlers.clear(),await e.sendNotification(r.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),n}catch(t){throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(t)?this.initialize(e):this.stop():t instanceof r.ResponseError&&t.data&&t.data.retry?n.window.showErrorMessage(t.message,{title:`Retry`,id:`retry`}).then(t=>{t&&t.id===`retry`?this.initialize(e):this.stop()}):(t&&t.message&&n.window.showErrorMessage(t.message),this.error(`Server initialization failed.`,t),this.stop()),t}}_clientGetRootPath(){let e=n.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme===`file`)return t.uri.fsPath}stop(e=2e3){return this.shutdown(`stop`,e)}dispose(e=2e3){try{return this._disposed=`disposing`,this.stop(e)}finally{this._disposed=`disposed`}}async shutdown(e,t){if(this.$state===L.Stopped||this.$state===L.Initial)return;if(this.$state===L.Stopping){if(this._onStop!==void 0)return this._onStop;throw Error(`Client is stopping but no stop promise available.`)}let n=this.activeConnection();if(n===void 0||this.$state!==L.Running)throw Error(`Client is not running and can't be stopped. It's current state is: ${this.$state}`);this._initializeResult=void 0,this.$state=L.Stopping,this.cleanUp(e);let i=new Promise(e=>{(0,r.RAL)().timer.setTimeout(e,t)}),a=(async e=>(await e.shutdown(),await e.exit(),e))(n);return this._onStop=Promise.race([i,a]).then(e=>{if(e!==void 0)e.end(),e.dispose();else throw this.error(`Stopping server timed out`,void 0,!1),Error(`Stopping the server timed out`)},e=>{throw this.error(`Stopping server failed`,e,!1),e}).finally(()=>{this.$state=L.Stopped,e===`stop`&&this.cleanUpChannel(),this._onStart=void 0,this._onStop=void 0,this._connection=void 0,this._ignoredRegistrations.clear()})}cleanUp(e){this._fileEvents=[],this._fileEventDelayer.cancel();let t=this._listeners.splice(0,this._listeners.length);for(let e of t)e.dispose();this._syncedDocuments&&this._syncedDocuments.clear();for(let e of Array.from(this._features.entries()).map(e=>e[1]).reverse())e.clear();e===`stop`&&this._diagnostics!==void 0&&(this._diagnostics.dispose(),this._diagnostics=void 0),this._idleInterval!==void 0&&(this._idleInterval.dispose(),this._idleInterval=void 0)}cleanUpChannel(){this._outputChannel!==void 0&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){let t=this;async function n(e){return t._fileEvents.push(e),t._fileEventDelayer.trigger(async()=>{await t.sendNotification(r.DidChangeWatchedFilesNotification.type,{changes:t._fileEvents}),t._fileEvents=[]})}let i=this.clientOptions.middleware?.workspace;(i?.didChangeWatchedFile?i.didChangeWatchedFile(e,n):n(e)).catch(e=>{t.error(`Notify file events failed.`,e)})}async sendPendingFullTextDocumentChanges(e){return this._pendingChangeSemaphore.lock(async()=>{try{let t=this._didChangeTextDocumentFeature.getPendingDocumentChanges(this._pendingOpenNotifications);if(t.length===0)return;for(let n of t){let t=this.code2ProtocolConverter.asChangeTextDocumentParams(n);await e.sendNotification(r.DidChangeTextDocumentNotification.type,t),this._didChangeTextDocumentFeature.notificationSent(n,r.DidChangeTextDocumentNotification.type,t)}}catch(e){throw this.error(`Sending pending changes failed`,e,!1),e}})}triggerPendingChangeDelivery(){this._pendingChangeDelayer.trigger(async()=>{let e=this.activeConnection();if(e===void 0){this.triggerPendingChangeDelivery();return}await this.sendPendingFullTextDocumentChanges(e)}).catch(e=>this.error(`Delivering pending changes failed`,e,!1))}handleDiagnostics(e){if(!this._diagnostics)return;let t=e.uri;this._diagnosticQueueState.state===`busy`&&this._diagnosticQueueState.document===t&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,r.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state===`busy`)return;let e=this._diagnosticQueue.entries().next();if(e.done===!0)return;let[t,r]=e.value;this._diagnosticQueue.delete(t);let i=new n.CancellationTokenSource;this._diagnosticQueueState={state:`busy`,document:t,tokenSource:i},this._p2c.asDiagnostics(r,i.token).then(e=>{if(!i.token.isCancellationRequested){let n=this._p2c.asUri(t),r=this.clientOptions.middleware;r.handleDiagnostics?r.handleDiagnostics(n,e,(e,t)=>this.setDiagnostics(e,t)):this.setDiagnostics(n,e)}}).finally(()=>{this._diagnosticQueueState={state:`idle`},this.triggerDiagnosticQueue()})}setDiagnostics(e,t){this._diagnostics&&this._diagnostics.set(e,t)}getLocale(){return n.env.language}async $start(){if(this.$state===L.StartFailed)throw Error(`Previous start failed. Can't restart server.`);await this.start();let e=this.activeConnection();if(e===void 0)throw Error(`Starting server failed`);return e}async createConnection(){let e=(e,t,n)=>{this.handleConnectionError(e,t,n).catch(e=>this.error(`Handling connection error failed`,e))},t=()=>{this.handleConnectionClosed().catch(e=>this.error(`Handling connection close failed`,e))},n=await this.createMessageTransports(this._clientOptions.stdioEncoding||`utf8`);return this._connection=st(n.reader,n.writer,e,t,this._clientOptions.connectionOptions),this._connection}async handleConnectionClosed(){if(this.$state===L.Stopped)return;try{this._connection!==void 0&&this._connection.dispose()}catch{}let e={action:F.DoNotRestart};if(this.$state!==L.Stopping)try{e=await this._clientOptions.errorHandler.closed()}catch{}this._connection=void 0,e.action===F.DoNotRestart?(this.error(e.message??`Connection to server got closed. Server will not be restarted.`,void 0,e.handled===!0?!1:`force`),this.cleanUp(`stop`),this.$state===L.Starting?this.$state=L.StartFailed:this.$state=L.Stopped,this._onStop=Promise.resolve(),this._onStart=void 0):e.action===F.Restart&&(this.info(e.message??`Connection to server got closed. Server will restart.`,!e.handled),this.cleanUp(`restart`),this.$state=L.Initial,this._onStop=Promise.resolve(),this._onStart=void 0,this.start().catch(e=>this.error(`Restarting server failed`,e,`force`)))}async handleConnectionError(e,t,n){let r=await this._clientOptions.errorHandler.error(e,t,n);r.action===et.Shutdown?(this.error(r.message??`Client ${this._name}: connection to server is erroring.\n${e.message}\nShutting down server.`,void 0,r.handled===!0?!1:`force`),this.stop().catch(e=>{this.error(`Stopping server failed`,e,!1)})):this.error(r.message??`Client ${this._name}: connection to server is erroring.\n${e.message}`,void 0,r.handled===!0?!1:`force`)}hookConfigurationChanged(e){this._listeners.push(n.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)}))}refreshTrace(e,t=!1){let i=n.workspace.getConfiguration(this._id),a=r.Trace.Off,o=r.TraceFormat.Text;if(i){let e=i.get(`trace.server`,`off`);typeof e==`string`?a=r.Trace.fromString(e):(a=r.Trace.fromString(i.get(`trace.server.verbosity`,`off`)),o=r.TraceFormat.fromString(i.get(`trace.server.format`,`text`)))}this._trace=a,this._traceFormat=o,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat}).catch(e=>{this.error(`Updating trace failed with error`,e,!1)})}hookFileEvents(e){let t=this._clientOptions.synchronize.fileEvents;if(!t)return;let n;n=c.array(t)?t:[t],n&&this._dynamicFeatures.get(r.DidChangeWatchedFilesNotification.type.method).registerRaw(u.generateUuid(),n)}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),f.DynamicFeature.is(e)){let t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}hasDedicatedTextSynchronizationFeature(e){let t=this.getFeature(r.NotebookDocumentSyncRegistrationType.method);return t===void 0||!(t instanceof m.NotebookDocumentSyncFeature)?!1:t.handles(e)}registerBuiltinFeatures(){let e=new Map;this.registerFeature(new h.ConfigurationFeature(this)),this.registerFeature(new x.DidOpenTextDocumentFeature(this,this._syncedDocuments)),this._didChangeTextDocumentFeature=new x.DidChangeTextDocumentFeature(this,e),this._didChangeTextDocumentFeature.onPendingChangeAdded(()=>{this.triggerPendingChangeDelivery()}),this.registerFeature(this._didChangeTextDocumentFeature),this.registerFeature(new x.WillSaveFeature(this)),this.registerFeature(new x.WillSaveWaitUntilFeature(this)),this.registerFeature(new x.DidSaveTextDocumentFeature(this)),this.registerFeature(new x.DidCloseTextDocumentFeature(this,this._syncedDocuments,e)),this.registerFeature(new Be.FileSystemWatcherFeature(this,e=>this.notifyFileEvent(e))),this.registerFeature(new ee.CompletionItemFeature(this)),this.registerFeature(new ke.HoverFeature(this)),this.registerFeature(new je.SignatureHelpFeature(this)),this.registerFeature(new Ae.DefinitionFeature(this)),this.registerFeature(new Pe.ReferencesFeature(this)),this.registerFeature(new Me.DocumentHighlightFeature(this)),this.registerFeature(new k.DocumentSymbolFeature(this)),this.registerFeature(new Ne.WorkspaceSymbolFeature(this)),this.registerFeature(new Fe.CodeActionFeature(this)),this.registerFeature(new Ie.CodeLensFeature(this)),this.registerFeature(new Le.DocumentFormattingFeature(this)),this.registerFeature(new Le.DocumentRangeFormattingFeature(this)),this.registerFeature(new Le.DocumentOnTypeFormattingFeature(this)),this.registerFeature(new Re.RenameFeature(this)),this.registerFeature(new ze.DocumentLinkFeature(this)),this.registerFeature(new A.ExecuteCommandFeature(this)),this.registerFeature(new h.SyncConfigurationFeature(this)),this.registerFeature(new He.TypeDefinitionFeature(this)),this.registerFeature(new Ve.ImplementationFeature(this)),this.registerFeature(new j.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new Ue.WorkspaceFoldersFeature(this)),this.registerFeature(new We.FoldingRangeFeature(this)),this.registerFeature(new Ge.DeclarationFeature(this)),this.registerFeature(new Ke.SelectionRangeFeature(this)),this.registerFeature(new qe.ProgressFeature(this)),this.registerFeature(new Je.CallHierarchyFeature(this)),this.registerFeature(new Ye.SemanticTokensFeature(this)),this.registerFeature(new Xe.LinkedEditingFeature(this)),this.registerFeature(new M.DidCreateFilesFeature(this)),this.registerFeature(new M.DidRenameFilesFeature(this)),this.registerFeature(new M.DidDeleteFilesFeature(this)),this.registerFeature(new M.WillCreateFilesFeature(this)),this.registerFeature(new M.WillRenameFilesFeature(this)),this.registerFeature(new M.WillDeleteFilesFeature(this)),this.registerFeature(new Ze.TypeHierarchyFeature(this)),this.registerFeature(new N.InlineValueFeature(this)),this.registerFeature(new Qe.InlayHintsFeature(this)),this.registerFeature(new p.DiagnosticFeature(this)),this.registerFeature(new m.NotebookDocumentSyncFeature(this))}registerProposedFeatures(){this.registerFeatures(R.createAll(this))}fillInitializeParams(e){for(let t of this._features)c.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){let t={};(0,f.ensure)(t,`workspace`).applyEdit=!0;let n=(0,f.ensure)((0,f.ensure)(t,`workspace`),`workspaceEdit`);n.documentChanges=!0,n.resourceOperations=[r.ResourceOperationKind.Create,r.ResourceOperationKind.Rename,r.ResourceOperationKind.Delete],n.failureHandling=r.FailureHandlingKind.TextOnlyTransactional,n.normalizesLineEndings=!0,n.changeAnnotationSupport={groupsOnLabel:!0};let i=(0,f.ensure)((0,f.ensure)(t,`textDocument`),`publishDiagnostics`);i.relatedInformation=!0,i.versionSupport=!1,i.tagSupport={valueSet:[r.DiagnosticTag.Unnecessary,r.DiagnosticTag.Deprecated]},i.codeDescriptionSupport=!0,i.dataSupport=!0;let a=(0,f.ensure)(t,`window`),o=(0,f.ensure)(a,`showMessage`);o.messageActionItem={additionalPropertiesSupport:!0};let s=(0,f.ensure)(a,`showDocument`);s.support=!0;let c=(0,f.ensure)(t,`general`);c.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(e.RequestsToCancelOnContentModified)},c.regularExpressions={engine:`ECMAScript`,version:`ES2020`},c.markdown={parser:`marked`,version:`1.1.0`},c.positionEncodings=[`utf-16`],this._clientOptions.markdown.supportHtml&&(c.markdown.allowedTags=`ul.li.p.code.blockquote.ol.h1.h2.h3.h4.h5.h6.hr.em.pre.table.thead.tbody.tr.th.td.div.del.a.strong.br.img.span`.split(`.`));for(let e of this._features)e.fillClientCapabilities(t);return t}initializeFeatures(e){let t=this._clientOptions.documentSelector;for(let e of this._features)c.func(e.preInitialize)&&e.preInitialize(this._capabilities,t);for(let e of this._features)e.initialize(this._capabilities,t)}async handleRegistrationRequest(e){let t=this.clientOptions.middleware?.handleRegisterCapability;return t?t(e,e=>this.doRegisterCapability(e)):this.doRegisterCapability(e)}async doRegisterCapability(e){if(!this.isRunning()){for(let t of e.registrations)this._ignoredRegistrations.add(t.id);return}for(let t of e.registrations){let e=this._dynamicFeatures.get(t.method);if(e===void 0)return Promise.reject(Error(`No feature implementation for ${t.method} found. Registration failed.`));let n=t.registerOptions??{};n.documentSelector=n.documentSelector??this._clientOptions.documentSelector;let r={id:t.id,registerOptions:n};try{e.register(r)}catch(e){return Promise.reject(e)}}}async handleUnregistrationRequest(e){let t=this.clientOptions.middleware?.handleUnregisterCapability;return t?t(e,e=>this.doUnregisterCapability(e)):this.doUnregisterCapability(e)}async doUnregisterCapability(e){for(let t of e.unregisterations){if(this._ignoredRegistrations.has(t.id))continue;let e=this._dynamicFeatures.get(t.method);if(!e)return Promise.reject(Error(`No feature implementation for ${t.method} found. Unregistration failed.`));e.unregister(t.id)}}async handleApplyWorkspaceEdit(e){let t=e.edit,i=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(t)),a=new Map;n.workspace.textDocuments.forEach(e=>a.set(e.uri.toString(),e));let o=!1;if(t.documentChanges){for(let e of t.documentChanges)if(r.TextDocumentEdit.is(e)&&e.textDocument.version&&e.textDocument.version>=0){let t=this._p2c.asUri(e.textDocument.uri).toString(),n=a.get(t);if(n&&n.version!==e.textDocument.version){o=!0;break}}}return o?Promise.resolve({applied:!1}):c.asPromise(n.workspace.applyEdit(i).then(e=>({applied:e})))}handleFailedRequest(t,i,a,o,s=!0){if(a instanceof r.ResponseError){if(a.code===r.ErrorCodes.PendingResponseRejected||a.code===r.ErrorCodes.ConnectionInactive)return o;if(a.code===r.LSPErrorCodes.RequestCancelled||a.code===r.LSPErrorCodes.ServerCancelled){if(i!==void 0&&i.isCancellationRequested)return o;throw a.data===void 0?new n.CancellationError:new f.LSPCancellationError(a.data)}else if(a.code===r.LSPErrorCodes.ContentModified){if(e.RequestsToCancelOnContentModified.has(t.method)||e.CancellableResolveCalls.has(t.method))throw new n.CancellationError;return o}}throw this.error(`Request ${t.method} failed.`,a,s),a}};exports.BaseLanguageClient=at,at.RequestsToCancelOnContentModified=new Set([r.SemanticTokensRequest.method,r.SemanticTokensRangeRequest.method,r.SemanticTokensDeltaRequest.method]),at.CancellableResolveCalls=new Set([r.CompletionResolveRequest.method,r.CodeLensResolveRequest.method,r.CodeActionResolveRequest.method,r.InlayHintResolveRequest.method,r.DocumentLinkResolveRequest.method,r.WorkspaceSymbolResolveRequest.method]);var ot=class{error(e){(0,r.RAL)().console.error(e)}warn(e){(0,r.RAL)().console.warn(e)}info(e){(0,r.RAL)().console.info(e)}log(e){(0,r.RAL)().console.log(e)}};function st(e,t,n,i,a){let o=new ot,s=(0,r.createProtocolConnection)(e,t,o,a);s.onError(e=>{n(e[0],e[1],e[2])}),s.onClose(i);let l={listen:()=>s.listen(),sendRequest:s.sendRequest,onRequest:s.onRequest,hasPendingResponse:s.hasPendingResponse,sendNotification:s.sendNotification,onNotification:s.onNotification,onProgress:s.onProgress,sendProgress:s.sendProgress,trace:(e,t,n)=>{let i={sendNotification:!1,traceFormat:r.TraceFormat.Text};return n===void 0?s.trace(e,t,i):(c.boolean(n),s.trace(e,t,n))},initialize:e=>s.sendRequest(r.InitializeRequest.type,e),shutdown:()=>s.sendRequest(r.ShutdownRequest.type,void 0),exit:()=>s.sendNotification(r.ExitNotification.type),end:()=>s.end(),dispose:()=>s.dispose()};return l}var R;(function(e){function t(e){let t=[new $e.InlineCompletionItemFeature(e)];return t}e.createAll=t})(R||(exports.ProposedFeatures=R={}))}),Ae=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.terminate=void 0;let t=require(`child_process`),n=require(`path`),r=process.platform===`win32`,i=process.platform===`darwin`,a=process.platform===`linux`;function o(e,o){if(r)try{let n={stdio:[`pipe`,`pipe`,`ignore`]};return o&&(n.cwd=o),t.execFileSync(`taskkill`,[`/T`,`/F`,`/PID`,e.pid.toString()],n),!0}catch{return!1}else if(a||i)try{var s=(0,n.join)(__dirname,`terminateProcess.sh`),c=t.spawnSync(s,[e.pid.toString()]);return!c.error}catch{return!1}else return e.kill(`SIGKILL`),!0}exports.terminate=o}),je=e.__commonJSMin(exports=>{var n=exports&&exports.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||(`get`in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),r=exports&&exports.__exportStar||function(e,t){for(var r in e)r!==`default`&&!Object.prototype.hasOwnProperty.call(t,r)&&n(t,e,r)};Object.defineProperty(exports,`__esModule`,{value:!0}),exports.DiagnosticPullMode=exports.vsdiag=void 0,r(t.require_main$1(),exports),r(b(),exports);var i=te();Object.defineProperty(exports,`vsdiag`,{enumerable:!0,get:function(){return i.vsdiag}}),Object.defineProperty(exports,`DiagnosticPullMode`,{enumerable:!0,get:function(){return i.DiagnosticPullMode}}),r(ke(),exports)}),Me=e.__commonJSMin(exports=>{var n=exports&&exports.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||(`get`in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),r=exports&&exports.__exportStar||function(e,t){for(var r in e)r!==`default`&&!Object.prototype.hasOwnProperty.call(t,r)&&n(t,e,r)};Object.defineProperty(exports,`__esModule`,{value:!0}),exports.SettingMonitor=exports.LanguageClient=exports.TransportKind=void 0;let i=require(`child_process`),o=require(`fs`),s=require(`path`),c=require(`vscode`),l=a(),u=ke(),d=Ae(),f=t.require_node(),p=t.require_parse(),m=t.require_satisfies();r(t.require_node(),exports),r(je(),exports);let h=`^1.82.0`;var g;(function(e){e[e.stdio=0]=`stdio`,e[e.ipc=1]=`ipc`,e[e.pipe=2]=`pipe`,e[e.socket=3]=`socket`})(g||(exports.TransportKind=g={}));var _;(function(e){function t(e){let t=e;return t&&t.kind===g.socket&&l.number(t.port)}e.isSocket=t})(_||={});var v;(function(e){function t(e){return l.string(e.command)}e.is=t})(v||={});var y;(function(e){function t(e){return l.string(e.module)}e.is=t})(y||={});var b;(function(e){function t(e){let t=e;return t&&t.writer!==void 0&&t.reader!==void 0}e.is=t})(b||={});var x;(function(e){function t(e){let t=e;return t&&t.process!==void 0&&typeof t.detached==`boolean`}e.is=t})(x||={});var ee=class extends u.BaseLanguageClient{constructor(e,t,n,r,i){let a,o,s,c,u;l.string(t)?(a=e,o=t,s=n,c=r,u=!!i):(a=e.toLowerCase(),o=e,s=t,c=n,u=r),u===void 0&&(u=!1),super(a,o,c),this._serverOptions=s,this._forceDebug=u,this._isInDebugMode=u;try{this.checkVersion()}catch(e){throw l.string(e.message)&&this.outputChannel.appendLine(e.message),e}}checkVersion(){let e=p(c.version);if(!e)throw Error(`No valid VS Code version detected. Version string is: ${c.version}`);if(e.prerelease&&e.prerelease.length>0&&(e.prerelease=[]),!m(e,h))throw Error(`The language client requires VS Code version ${h} but received version ${c.version}`)}get isInDebugMode(){return this._isInDebugMode}async restart(){await this.stop(),this.isInDebugMode&&await new Promise(e=>setTimeout(e,1e3)),await this.start()}stop(e=2e3){return super.stop(e).finally(()=>{if(this._serverProcess){let e=this._serverProcess;this._serverProcess=void 0,(this._isDetached===void 0||!this._isDetached)&&this.checkProcessDied(e),this._isDetached=void 0}})}checkProcessDied(e){!e||e.pid===void 0||setTimeout(()=>{try{e.pid!==void 0&&(process.kill(e.pid,0),(0,d.terminate)(e))}catch{}},2e3)}handleConnectionClosed(){return this._serverProcess=void 0,super.handleConnectionClosed()}fillInitializeParams(e){super.fillInitializeParams(e),e.processId===null&&(e.processId=process.pid)}createMessageTransports(e){function t(e,t){if(!e&&!t)return;let n=Object.create(null);return Object.keys(process.env).forEach(e=>n[e]=process.env[e]),t&&(n.ELECTRON_RUN_AS_NODE=`1`,n.ELECTRON_NO_ASAR=`1`),e&&Object.keys(e).forEach(t=>n[t]=e[t]),n}let n=[`--debug=`,`--debug-brk=`,`--inspect=`,`--inspect-brk=`],r=[`--debug`,`--debug-brk`,`--inspect`,`--inspect-brk`];function a(){let e=process.execArgv;return e?e.some(e=>n.some(t=>e.startsWith(t))||r.some(t=>e===t)):!1}function o(e){if(e.stdin===null||e.stdout===null||e.stderr===null)throw Error(`Process created without stdio streams`)}let s=this._serverOptions;if(l.func(s))return s().then(t=>{if(u.MessageTransports.is(t))return this._isDetached=!!t.detached,t;if(b.is(t))return this._isDetached=!!t.detached,{reader:new f.StreamMessageReader(t.reader),writer:new f.StreamMessageWriter(t.writer)};{let n;return x.is(t)?(n=t.process,this._isDetached=t.detached):(n=t,this._isDetached=!1),n.stderr.on(`data`,t=>this.outputChannel.append(l.string(t)?t:t.toString(e))),{reader:new f.StreamMessageReader(n.stdout),writer:new f.StreamMessageWriter(n.stdin)}}});let c,d=s;return d.run||d.debug?this._forceDebug||a()?(c=d.debug,this._isInDebugMode=!0):(c=d.run,this._isInDebugMode=!1):c=s,this._getServerWorkingDir(c.options).then(n=>{if(y.is(c)&&c.module){let r=c,a=r.transport||g.stdio;if(r.runtime){let o=[],s=r.options??Object.create(null);s.execArgv&&s.execArgv.forEach(e=>o.push(e)),o.push(r.module),r.args&&r.args.forEach(e=>o.push(e));let c=Object.create(null);c.cwd=n,c.env=t(s.env,!1);let u=this._getRuntimePath(r.runtime,n),d;if(a===g.ipc?(c.stdio=[null,null,null,`ipc`],o.push(`--node-ipc`)):a===g.stdio?o.push(`--stdio`):a===g.pipe?(d=(0,f.generateRandomPipeName)(),o.push(`--pipe=${d}`)):_.isSocket(a)&&o.push(`--socket=${a.port}`),o.push(`--clientProcessId=${process.pid.toString()}`),a===g.ipc||a===g.stdio){let t=i.spawn(u,o,c);return!t||!t.pid?S(t,`Launching server using runtime ${u} failed.`):(this._serverProcess=t,t.stderr.on(`data`,t=>this.outputChannel.append(l.string(t)?t:t.toString(e))),a===g.ipc?(t.stdout.on(`data`,t=>this.outputChannel.append(l.string(t)?t:t.toString(e))),Promise.resolve({reader:new f.IPCMessageReader(t),writer:new f.IPCMessageWriter(t)})):Promise.resolve({reader:new f.StreamMessageReader(t.stdout),writer:new f.StreamMessageWriter(t.stdin)}))}else if(a===g.pipe)return(0,f.createClientPipeTransport)(d).then(t=>{let n=i.spawn(u,o,c);return!n||!n.pid?S(n,`Launching server using runtime ${u} failed.`):(this._serverProcess=n,n.stderr.on(`data`,t=>this.outputChannel.append(l.string(t)?t:t.toString(e))),n.stdout.on(`data`,t=>this.outputChannel.append(l.string(t)?t:t.toString(e))),t.onConnected().then(e=>({reader:e[0],writer:e[1]})))});else if(_.isSocket(a))return(0,f.createClientSocketTransport)(a.port).then(t=>{let n=i.spawn(u,o,c);return!n||!n.pid?S(n,`Launching server using runtime ${u} failed.`):(this._serverProcess=n,n.stderr.on(`data`,t=>this.outputChannel.append(l.string(t)?t:t.toString(e))),n.stdout.on(`data`,t=>this.outputChannel.append(l.string(t)?t:t.toString(e))),t.onConnected().then(e=>({reader:e[0],writer:e[1]})))})}else{let s;return new Promise((c,u)=>{let d=(r.args&&r.args.slice())??[];a===g.ipc?d.push(`--node-ipc`):a===g.stdio?d.push(`--stdio`):a===g.pipe?(s=(0,f.generateRandomPipeName)(),d.push(`--pipe=${s}`)):_.isSocket(a)&&d.push(`--socket=${a.port}`),d.push(`--clientProcessId=${process.pid.toString()}`);let p=r.options??Object.create(null);if(p.env=t(p.env,!0),p.execArgv=p.execArgv||[],p.cwd=n,p.silent=!0,a===g.ipc||a===g.stdio){let t=i.fork(r.module,d||[],p);o(t),this._serverProcess=t,t.stderr.on(`data`,t=>this.outputChannel.append(l.string(t)?t:t.toString(e))),a===g.ipc?(t.stdout.on(`data`,t=>this.outputChannel.append(l.string(t)?t:t.toString(e))),c({reader:new f.IPCMessageReader(this._serverProcess),writer:new f.IPCMessageWriter(this._serverProcess)})):c({reader:new f.StreamMessageReader(t.stdout),writer:new f.StreamMessageWriter(t.stdin)})}else a===g.pipe?(0,f.createClientPipeTransport)(s).then(t=>{let n=i.fork(r.module,d||[],p);o(n),this._serverProcess=n,n.stderr.on(`data`,t=>this.outputChannel.append(l.string(t)?t:t.toString(e))),n.stdout.on(`data`,t=>this.outputChannel.append(l.string(t)?t:t.toString(e))),t.onConnected().then(e=>{c({reader:e[0],writer:e[1]})},u)},u):_.isSocket(a)&&(0,f.createClientSocketTransport)(a.port).then(t=>{let n=i.fork(r.module,d||[],p);o(n),this._serverProcess=n,n.stderr.on(`data`,t=>this.outputChannel.append(l.string(t)?t:t.toString(e))),n.stdout.on(`data`,t=>this.outputChannel.append(l.string(t)?t:t.toString(e))),t.onConnected().then(e=>{c({reader:e[0],writer:e[1]})},u)},u)})}}else if(v.is(c)&&c.command){let t=c,r=c.args===void 0?[]:c.args.slice(0),a,o=c.transport;if(o===g.stdio)r.push(`--stdio`);else if(o===g.pipe)a=(0,f.generateRandomPipeName)(),r.push(`--pipe=${a}`);else if(_.isSocket(o))r.push(`--socket=${o.port}`);else if(o===g.ipc)throw Error(`Transport kind ipc is not support for command executable`);let s=Object.assign({},t.options);if(s.cwd=s.cwd||n,o===void 0||o===g.stdio){let n=i.spawn(t.command,r,s);return!n||!n.pid?S(n,`Launching server using command ${t.command} failed.`):(n.stderr.on(`data`,t=>this.outputChannel.append(l.string(t)?t:t.toString(e))),this._serverProcess=n,this._isDetached=!!s.detached,Promise.resolve({reader:new f.StreamMessageReader(n.stdout),writer:new f.StreamMessageWriter(n.stdin)}))}else if(o===g.pipe)return(0,f.createClientPipeTransport)(a).then(n=>{let a=i.spawn(t.command,r,s);return!a||!a.pid?S(a,`Launching server using command ${t.command} failed.`):(this._serverProcess=a,this._isDetached=!!s.detached,a.stderr.on(`data`,t=>this.outputChannel.append(l.string(t)?t:t.toString(e))),a.stdout.on(`data`,t=>this.outputChannel.append(l.string(t)?t:t.toString(e))),n.onConnected().then(e=>({reader:e[0],writer:e[1]})))});else if(_.isSocket(o))return(0,f.createClientSocketTransport)(o.port).then(n=>{let a=i.spawn(t.command,r,s);return!a||!a.pid?S(a,`Launching server using command ${t.command} failed.`):(this._serverProcess=a,this._isDetached=!!s.detached,a.stderr.on(`data`,t=>this.outputChannel.append(l.string(t)?t:t.toString(e))),a.stdout.on(`data`,t=>this.outputChannel.append(l.string(t)?t:t.toString(e))),n.onConnected().then(e=>({reader:e[0],writer:e[1]})))})}return Promise.reject(Error(`Unsupported server configuration `+JSON.stringify(s,null,4)))}).finally(()=>{this._serverProcess!==void 0&&this._serverProcess.on(`exit`,(e,t)=>{e!==null&&this.error(`Server process exited with code ${e}.`,void 0,!1),t!==null&&this.error(`Server process exited with signal ${t}.`,void 0,!1)})})}_getRuntimePath(e,t){if(s.isAbsolute(e))return e;let n=this._mainGetRootPath();if(n!==void 0){let t=s.join(n,e);if(o.existsSync(t))return t}if(t!==void 0){let n=s.join(t,e);if(o.existsSync(n))return n}return e}_mainGetRootPath(){let e=c.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme===`file`)return t.uri.fsPath}_getServerWorkingDir(e){let t=e&&e.cwd;return t||=this.clientOptions.workspaceFolder?this.clientOptions.workspaceFolder.uri.fsPath:this._mainGetRootPath(),t?new Promise(e=>{o.lstat(t,(n,r)=>{e(!n&&r.isDirectory()?t:void 0)})}):Promise.resolve(void 0)}};exports.LanguageClient=ee;var te=class{constructor(e,t){this._client=e,this._setting=t,this._listeners=[]}start(){return c.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,this._listeners),this.onDidChangeConfiguration(),new c.Disposable(()=>{this._client.needsStop()&&this._client.stop()})}onDidChangeConfiguration(){let e=this._setting.indexOf(`.`),t=e>=0?this._setting.substr(0,e):this._setting,n=e>=0?this._setting.substr(e+1):void 0,r=n?c.workspace.getConfiguration(t).get(n,!1):c.workspace.getConfiguration(t);r&&this._client.needsStart()?this._client.start().catch(e=>this._client.error(`Start failed after configuration change`,e,`force`)):!r&&this._client.needsStop()&&this._client.stop().catch(e=>this._client.error(`Stop failed after configuration change`,e,`force`))}};exports.SettingMonitor=te;function S(e,t){return e===null?Promise.reject(t):new Promise((n,r)=>{e.on(`error`,e=>{r(`${t} ${e}`)}),setImmediate(()=>r(t))})}}),k=e.__commonJSMin(exports=>{var t=exports&&exports.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||(`get`in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),n=exports&&exports.__exportStar||function(e,n){for(var r in e)r!==`default`&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)};Object.defineProperty(exports,`__esModule`,{value:!0}),exports.LoadedTSFilesMetaRequest=exports.GetVirtualCodeRequest=exports.GetVirtualFileRequest=exports.GetServicePluginsRequest=exports.UpdateServicePluginStateNotification=exports.UpdateVirtualCodeStateNotification=exports.DocumentDrop_DataTransferItemFileDataRequest=exports.DocumentDrop_DataTransferItemAsStringRequest=exports.DocumentDropRequest=exports.ReloadProjectNotification=exports.WriteVirtualFilesNotification=exports.AutoInsertRequest=exports.GetMatchTsConfigRequest=exports.FindFileReferenceRequest=void 0;let r=Me();n(Me(),exports);var i;(function(e){e.type=new r.RequestType(`volar/client/findFileReference`)})(i||(exports.FindFileReferenceRequest=i={}));var a;(function(e){e.type=new r.RequestType(`volar/client/tsconfig`)})(a||(exports.GetMatchTsConfigRequest=a={}));var o;(function(e){e.type=new r.RequestType(`volar/client/autoInsert`)})(o||(exports.AutoInsertRequest=o={}));var s;(function(e){e.type=new r.NotificationType(`volar/client/writeVirtualFiles`)})(s||(exports.WriteVirtualFilesNotification=s={}));var c;(function(e){e.type=new r.NotificationType(`volar/client/reloadProject`)})(c||(exports.ReloadProjectNotification=c={}));var l;(function(e){e.type=new r.RequestType(`volar/client/documentDrop`)})(l||(exports.DocumentDropRequest=l={}));var u;(function(e){e.type=new r.RequestType(`volar/client/documentDrop/asString`)})(u||(exports.DocumentDrop_DataTransferItemAsStringRequest=u={}));var d;(function(e){e.type=new r.RequestType(`volar/client/documentDrop/fileData`)})(d||(exports.DocumentDrop_DataTransferItemFileDataRequest=d={}));var f;(function(e){e.type=new r.NotificationType(`volar/client/labs/updateVirtualFileState`)})(f||(exports.UpdateVirtualCodeStateNotification=f={}));var p;(function(e){e.type=new r.NotificationType(`volar/client/labs/updateServicePluginState`)})(p||(exports.UpdateServicePluginStateNotification=p={}));var m;(function(e){e.type=new r.RequestType(`volar/client/servicePlugins`)})(m||(exports.GetServicePluginsRequest=m={}));var h;(function(e){e.type=new r.RequestType(`volar/client/virtualFiles`)})(h||(exports.GetVirtualFileRequest=h={}));var g;(function(e){e.type=new r.RequestType(`volar/client/virtualFile`)})(g||(exports.GetVirtualCodeRequest=g={}));var _;(function(e){e.type=new r.RequestType0(`volar/client/loadedTsFiles`)})(_||(exports.LoadedTSFilesMetaRequest=_={}))}),Ne=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.activate=r;let t=k(),n=require(`vscode`);function r(e,r){let i=!1,a;s();let o=[n.workspace.onDidChangeTextDocument(c,null),n.window.onDidChangeActiveTextEditor(s,null)];return n.Disposable.from(...o);function s(){i=!1;let t=n.window.activeTextEditor;if(!t)return;let r=t.document;n.languages.match(e,r)&&(i=!0)}function c({document:e,contentChanges:t,reason:a}){if(!i||t.length===0||a===n.TextDocumentChangeReason.Undo||a===n.TextDocumentChangeReason.Redo)return;let o=n.window.activeTextEditor?.document;if(e!==o)return;let s=t[t.length-1];if(s.text.length===0)return;let c=s.text[s.text.length-1],u=r.initializeResult?.capabilities;if(u?.experimental?.autoInsertionProvider){let{triggerCharacters:t,configurationSections:r}=u.experimental.autoInsertionProvider;for(let i=0;i<t.length;i++){let a=t[i],o=r?.[i];if(c.match(new RegExp(a))&&(!o||o.some(e=>n.workspace.getConfiguration().get(e)))){l(e,s);return}}}}function l(e,o){a&&(clearTimeout(a),a=void 0);let s=e.version,c=()=>e!==n.window.activeTextEditor?.document||n.window.activeTextEditor?.document.version!==s;a=setTimeout(async()=>{if(a=void 0,c())return;let s=n.window.activeTextEditor;if(!s)return;let l=new n.Range(o.range.start,e.positionAt(e.offsetAt(o.range.start)+o.text.length)),u=s.selections.find(e=>l.contains(e.active))?.active;if(!u)return;let d={textDocument:r.code2ProtocolConverter.asTextDocumentIdentifier(e),selection:r.code2ProtocolConverter.asPosition(u),change:{rangeLength:o.rangeLength,rangeOffset:o.rangeOffset,text:o.text}},f=await r.sendRequest(t.AutoInsertRequest.type,d);f&&i&&!c()&&s.insertSnippet(new n.SnippetString(f))},100)}}}),Pe=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.activate=r;let t=require(`vscode`),n=k();function r(e,r){let i;return t.Disposable.from(r.onRequest(n.DocumentDrop_DataTransferItemAsStringRequest.type,async({mimeType:e})=>{let t=i.get(e);return await t?.asString()??``}),r.onRequest(n.DocumentDrop_DataTransferItemFileDataRequest.type,async({mimeType:e})=>{let t=i.get(e);return await t?.asFile()?.data()??new Uint8Array}),t.languages.registerDocumentDropEditProvider(e,{async provideDocumentDropEdits(e,a,o){i=o;let s=await r.sendRequest(n.DocumentDropRequest.type,{textDocument:r.code2ProtocolConverter.asTextDocumentIdentifier(e),position:r.code2ProtocolConverter.asPosition(a),dataTransfer:[...o].map(([e,t])=>{let n=t.asFile();return{mimeType:e,value:t.value,file:n?{name:n.name,uri:n.uri?r.code2ProtocolConverter.asUri(n.uri):void 0}:void 0}})});if(s){let e=new t.DocumentDropEdit(s.insertTextFormat===2?new t.SnippetString(s.insertText):s.insertText);if(s.additionalEdit&&(e.additionalEdit=await r.protocol2CodeConverter.asWorkspaceEdit(s.additionalEdit)),s.createDataTransferFile){e.additionalEdit??=new t.WorkspaceEdit;for(let t of s.createDataTransferFile){let n=o.get(t.contentsMimeType)?.asFile();n&&e.additionalEdit.createFile(r.protocol2CodeConverter.asUri(t.uri),{ignoreIfExists:t.options?.ignoreIfExists,overwrite:t.options?.overwrite,contents:await n.data()})}}return e}}}))}}),Fe=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.activate=r;let t=require(`vscode`),n=k();function r(e,r){return t.commands.registerCommand(e,()=>{t.window.activeTextEditor&&r.sendNotification(n.WriteVirtualFilesNotification.type,r.code2ProtocolConverter.asTextDocumentIdentifier(t.window.activeTextEditor.document))})}}),Ie=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.activate=o;let n=require(`vscode`),r=t.require_main(),i=k(),a=r.loadMessageBundle();function o(e,t){return n.commands.registerCommand(e,async e=>{await n.window.withProgress({location:n.ProgressLocation.Window,title:a(`progress.title`,`Finding file references`)},async r=>{if(!e){let t=n.window.activeTextEditor;if(!t)return;e=t.document.uri}let a=await t.sendRequest(i.FindFileReferenceRequest.type,{textDocument:{uri:e.toString()}});if(!a)return;let o=a.map(e=>t.protocol2CodeConverter.asLocation(e)),s=n.workspace.getConfiguration(`references`),c=s.inspect(`preferredLocation`);await s.update(`preferredLocation`,`view`);try{await n.commands.executeCommand(`editor.action.showReferences`,e,new n.Position(0,0),o)}finally{await s.update(`preferredLocation`,c?.workspaceFolderValue??c?.workspaceValue)}})})}}),Le=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.activate=r;let t=require(`vscode`),n=k();function r(e,r){return t.commands.registerCommand(e,()=>{t.window.activeTextEditor&&r.sendNotification(n.ReloadProjectNotification.type,r.code2ProtocolConverter.asTextDocumentIdentifier(t.window.activeTextEditor.document))})}}),Re=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.activate=a;let n=require(`vscode`),r=k(),i=e.require_path_browserify();function a(e,t,a){let o=[],s=n.languages.createLanguageStatusItem(t,e),c,l;u(),n.window.onDidChangeActiveTextEditor(()=>{clearTimeout(l),l=setTimeout(()=>u,100)},void 0,o),o.push(n.commands.registerCommand(t,async()=>{if(c){let e=await n.workspace.openTextDocument(c);await n.window.showTextDocument(e)}})),o.push(...o);async function u(){if(!n.window.activeTextEditor||!n.languages.match(e,n.window.activeTextEditor.document))return;let o=await a.sendRequest(r.GetMatchTsConfigRequest.type,a.code2ProtocolConverter.asTextDocumentIdentifier(n.window.activeTextEditor.document));o?.uri?(c=n.Uri.parse(o.uri),s.text=i.relative(n.workspace.rootPath?.replace(/\\/g,`/`)||`/`,c.fsPath.replace(/\\/g,`/`)),s.command={title:`Open config file`,command:t}):(s.text=`No tsconfig`,s.command=void 0)}}}),ze=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.quickPick=n;let t=require(`vscode`);function n(e,n){return new Promise(r=>{let i=t.window.createQuickPick(),a=[];for(let n of Array.isArray(e)?e:[e]){let e=Object.values(n);if(e.length){a.length&&a.push({label:``,kind:t.QuickPickItemKind.Separator});for(let t of e)t&&a.push(t)}}i.items=a,i.placeholder=n,i.onDidChangeSelection(t=>{if(t[0])for(let n of Array.isArray(e)?e:[e])for(let e in n){let a=n[e];if(t[0]===a){r(e),i.hide();break}}}),i.onDidHide(()=>{i.dispose(),r(void 0)}),i.show()})}}),A=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.readFile=r,exports.readDirectory=i,exports.stat=a;let t=require(`vscode`),n=new TextDecoder(`utf8`);async function r(e){try{return n.decode(await t.workspace.fs.readFile(e))}catch{}}async function i(e){try{return await t.workspace.fs.readDirectory(e)}catch{return[]}}async function a(e){try{return await t.workspace.fs.stat(e)}catch{}}}),Be=e.__commonJSMin((exports,t)=>{t.exports={name:`typescript`,author:`Microsoft Corp.`,homepage:`https://www.typescriptlang.org/`,version:`5.8.3`,license:`Apache-2.0`,description:`TypeScript is a language for application scale JavaScript development`,keywords:[`TypeScript`,`Microsoft`,`compiler`,`language`,`javascript`],bugs:{url:`https://github.com/microsoft/TypeScript/issues`},repository:{type:`git`,url:`https://github.com/microsoft/TypeScript.git`},main:`./lib/typescript.js`,typings:`./lib/typescript.d.ts`,bin:{tsc:`./bin/tsc`,tsserver:`./bin/tsserver`},engines:{node:`>=14.17`},files:[`bin`,`lib`,`!lib/enu`,`LICENSE.txt`,`README.md`,`SECURITY.md`,`ThirdPartyNoticeText.txt`,`!**/.gitattributes`],devDependencies:{"@dprint/formatter":`^0.4.1`,"@dprint/typescript":`0.93.3`,"@esfx/canceltoken":`^1.0.0`,"@eslint/js":`^9.17.0`,"@octokit/rest":`^21.0.2`,"@types/chai":`^4.3.20`,"@types/diff":`^5.2.3`,"@types/minimist":`^1.2.5`,"@types/mocha":`^10.0.10`,"@types/ms":`^0.7.34`,"@types/node":`latest`,"@types/source-map-support":`^0.5.10`,"@types/which":`^3.0.4`,"@typescript-eslint/rule-tester":`^8.18.1`,"@typescript-eslint/type-utils":`^8.18.1`,"@typescript-eslint/utils":`^8.18.1`,"azure-devops-node-api":`^14.1.0`,c8:`^10.1.3`,chai:`^4.5.0`,chalk:`^4.1.2`,chokidar:`^3.6.0`,diff:`^5.2.0`,dprint:`^0.47.6`,esbuild:`^0.24.0`,eslint:`^9.17.0`,"eslint-formatter-autolinkable-stylish":`^1.4.0`,"eslint-plugin-regexp":`^2.7.0`,"fast-xml-parser":`^4.5.1`,glob:`^10.4.5`,globals:`^15.13.0`,hereby:`^1.10.0`,"jsonc-parser":`^3.3.1`,knip:`^5.41.0`,minimist:`^1.2.8`,mocha:`^10.8.2`,"mocha-fivemat-progress-reporter":`^0.1.0`,"monocart-coverage-reports":`^2.11.4`,ms:`^2.1.3`,playwright:`^1.49.1`,"source-map-support":`^0.5.21`,tslib:`^2.8.1`,typescript:`^5.7.2`,"typescript-eslint":`^8.18.1`,which:`^3.0.1`},overrides:{"typescript@*":`$typescript`},scripts:{test:`hereby runtests-parallel --light=false`,"test:eslint-rules":`hereby run-eslint-rules-tests`,build:`npm run build:compiler && npm run build:tests`,"build:compiler":`hereby local`,"build:tests":`hereby tests`,"build:tests:notypecheck":`hereby tests --no-typecheck`,clean:`hereby clean`,gulp:`hereby`,lint:`hereby lint`,knip:`hereby knip`,format:`dprint fmt`,"setup-hooks":`node scripts/link-hooks.mjs`},browser:{fs:!1,os:!1,path:!1,crypto:!1,buffer:!1,"source-map-support":!1,inspector:!1,perf_hooks:!1},packageManager:`npm@8.19.4`,volta:{node:`20.1.0`,npm:`8.19.4`},gitHead:`68cead182cc24afdc3f1ce7c8ff5853aba14b65a`}}),j=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.activate=c,exports.getTsdk=l;let n=e.require_path_browserify(),r=require(`vscode`),i=ze(),a=A(),o=`node_modules/typescript/lib`,s=`typescript.tsdk`;function c(e,t,n,a,c){let h=[],g=r.languages.createLanguageStatusItem(t,e);return g.command={title:`Select Version`,command:t},h.push({dispose:()=>g.dispose()}),h.push(r.commands.registerCommand(t,_)),r.workspace.onDidChangeConfiguration(v,void 0,h),r.window.onDidChangeActiveTextEditor(y,void 0,h),y(),r.Disposable.from(...h);async function _(){let e=await l(n),t=f(),a=await d(),h=!!a,g=!!t&&!a?.isWeb,_=t!==o&&!a?.isWeb;if(!h&&!g&&!_){let e=await r.window.showErrorMessage(`Could not find any TypeScript version. Please point your \`${s}\` setting to a valid TypeScript distribution.`,`Open Settings`);e===`Open Settings`&&r.commands.executeCommand(`workbench.action.openSettings`,s);return}let v=await(0,i.quickPick)([{useVSCodeTsdk:h?{label:(e?.isWorkspacePath?``:` `)+`Use VS Code's Version`,description:a.version,detail:a.isWeb?a.path:void 0}:void 0,useConfigWorkspaceTsdk:g?{label:(e?.isWorkspacePath?` `:``)+`Use Workspace Version`,description:await m(await u(t)??`/`)??`Could not load the TypeScript version at this path`,detail:t}:void 0,useDefaultWorkspaceTsdk:_?{label:(e?.isWorkspacePath?` `:``)+`Use Workspace Version`,description:await m(await u(o)??`/`)??`Could not load the TypeScript version at this path`,detail:o}:void 0}]);if(v===void 0)return;v===`useDefaultWorkspaceTsdk`&&await r.workspace.getConfiguration(`typescript`).update(`tsdk`,o);let b=v===`useConfigWorkspaceTsdk`||v===`useDefaultWorkspaceTsdk`;b!==p(n)&&(n.workspaceState.update(`typescript.useWorkspaceTsdk`,b),c?.()),y()}function v(e){e.affectsConfiguration(s)&&p(n)&&c?.()}async function y(){let e=(await l(n))?.version;g.text=e??`x.x.x`,g.text=a(g.text)}}async function l(e){if(p(e)){let e=f();if(e){let t=await u(e);if(t){let e=await m(t);if(e!==void 0)return{tsdk:t,version:e,isWorkspacePath:!0}}}}let t=await d();return t?{tsdk:t.path,version:t.version,isWorkspacePath:!1}:void 0}async function u(e){if(n.isAbsolute(e)){let t=r.Uri.joinPath(r.Uri.file(e),`typescript.js`),n=await a.stat(t);if(n?.type===r.FileType.File)return e}else if(r.workspace.workspaceFolders)for(let t of r.workspace.workspaceFolders){let i=n.join(t.uri.fsPath.replace(/\\/g,`/`),e),o=r.Uri.joinPath(r.Uri.file(i),`typescript.js`),s=await a.stat(o);if(s?.type===r.FileType.File)return i}}async function d(){let e=r.extensions.getExtension(`ms-vscode.vscode-typescript-next`);if(e){let t=n.join(e.extensionPath.replace(/\\/g,`/`),`node_modules/typescript/lib`),r=await m(t);return r?{path:t,version:r,isWeb:!1}:void 0}if(r.env.appRoot){let e=n.join(r.env.appRoot.replace(/\\/g,`/`),`extensions/node_modules/typescript/lib`),t=await m(e);return t?{path:e,version:t,isWeb:!1}:void 0}let t=Be().version;return{path:`/node_modules/typescript@${t}/lib`,version:t,isWeb:!0}}function f(){return r.workspace.getConfiguration(`typescript`).get(`tsdk`)?.replace(/\\/g,`/`)}function p(e){return e.workspaceState.get(`typescript.useWorkspaceTsdk`,!1)}async function m(e){let t=e.toString().split(`/`),n=t.slice(0,-1),i=n.join(`/`),o=i+`/package.json`;try{let e=await a.readFile(r.Uri.file(o));if(e===void 0)return;let t=JSON.parse(e);return!t||typeof t.version!=`string`?void 0:t.version}catch{return}}}),Ve=e.__commonJSMin(exports=>{var t=exports&&exports.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||(`get`in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),n=exports&&exports.__exportStar||function(e,n){for(var r in e)r!==`default`&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)};Object.defineProperty(exports,`__esModule`,{value:!0}),exports.currentLabsVersion=exports.middleware=exports.getTsdk=exports.activateTsVersionStatusItem=exports.activateTsConfigStatusItem=exports.activateReloadProjects=exports.activateFindFileReferences=exports.activateWriteVirtualFiles=exports.activateDocumentDropEdit=exports.activateAutoInsertion=void 0,exports.parseServerCommand=f,exports.createLabsInfo=p;let r=require(`vscode`),i=k();var a=Ne();Object.defineProperty(exports,`activateAutoInsertion`,{enumerable:!0,get:function(){return a.activate}});var o=Pe();Object.defineProperty(exports,`activateDocumentDropEdit`,{enumerable:!0,get:function(){return o.activate}});var s=Fe();Object.defineProperty(exports,`activateWriteVirtualFiles`,{enumerable:!0,get:function(){return s.activate}});var c=Ie();Object.defineProperty(exports,`activateFindFileReferences`,{enumerable:!0,get:function(){return c.activate}});var l=Le();Object.defineProperty(exports,`activateReloadProjects`,{enumerable:!0,get:function(){return l.activate}});var u=Re();Object.defineProperty(exports,`activateTsConfigStatusItem`,{enumerable:!0,get:function(){return u.activate}});var d=j();Object.defineProperty(exports,`activateTsVersionStatusItem`,{enumerable:!0,get:function(){return d.activate}}),Object.defineProperty(exports,`getTsdk`,{enumerable:!0,get:function(){return d.getTsdk}}),n(Me(),exports),exports.middleware={async provideCodeActions(e,t,n,i,a){let o=await a(e,t,n,i);return o=o?.map(e=>e instanceof r.CodeAction?(e.command&&=f(e.command),e):f(e)),o},async resolveCodeAction(e,t,n){let r=await n(e,t);return r?.command&&(r.command=f(r.command)),r},async provideCodeLenses(e,t,n){let r=await n(e,t);return r=r?.map(e=>(e.command&&=f(e.command),e)),r},async resolveCodeLens(e,t,n){let r=await n(e,t);return r?.command&&(r.command=f(r.command)),r}};function f(e){return e.command===`editor.action.rename`&&e.arguments?{...e,arguments:[[r.Uri.parse(e.arguments[0]),new r.Position(e.arguments[1].line,e.arguments[1].character)]]}:e.command===`editor.action.showReferences`&&e.arguments?{...e,arguments:[r.Uri.parse(e.arguments[0]),new r.Position(e.arguments[1].line,e.arguments[1].character),e.arguments[2].map(e=>new r.Location(r.Uri.parse(e.uri),new r.Range(e.range.start.line,e.range.start.character,e.range.end.line,e.range.end.character)))]}:e}exports.currentLabsVersion=`2.3.1`;function p(t){let n=new r.EventEmitter,a={volarLabs:{version:exports.currentLabsVersion,languageClients:[],languageServerProtocol:i,onDidAddLanguageClient:n.event}};return{extensionExports:a,addLanguageClient(e){a.volarLabs.languageClients.push(e),n.fire(e)}}}}),He=e.__toESM(Ve()),Ue=e.__commonJSMin((exports,t)=>{t.exports=Me()}),We=e.__commonJSMin(exports=>{var t=exports&&exports.__createBinding||(Object.create?function(e,t,n,r){r===void 0&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||(`get`in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}),n=exports&&exports.__exportStar||function(e,n){for(var r in e)r!==`default`&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)};Object.defineProperty(exports,`__esModule`,{value:!0}),n(Ue(),exports)}),Ge=e.__toESM(We());function Ke(e){let t=Object.create(null);for(let n of e.split(`,`))t[n]=1;return e=>e in t}const qe={},Je=()=>{},Ye=Object.assign,M=(e,t)=>{let n=e.indexOf(t);n>-1&&e.splice(n,1)},Xe=Object.prototype.hasOwnProperty,Ze=(e,t)=>Xe.call(e,t),N=Array.isArray,Qe=e=>rt(e)===`[object Map]`,$e=e=>rt(e)===`[object Set]`,P=e=>typeof e==`function`,et=e=>typeof e==`string`,F=e=>typeof e==`symbol`,I=e=>typeof e==`object`&&!!e,tt=e=>(I(e)||P(e))&&P(e.then)&&P(e.catch),nt=Object.prototype.toString,rt=e=>nt.call(e),L=e=>rt(e).slice(8,-1),it=e=>rt(e)===`[object Object]`,at=e=>et(e)&&e!==`NaN`&&e[0]!==`-`&&``+parseInt(e,10)===e,ot=e=>{let t=Object.create(null);return n=>{let r=t[n];return r||(t[n]=e(n))}},st=ot(e=>e.charAt(0).toUpperCase()+e.slice(1)),R=(e,t)=>!Object.is(e,t);function ct(e,...t){console.warn(`[Vue warn] ${e}`,...t)}let z;var lt=class{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=z,!e&&z&&(this.index=(z.scopes||=[]).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){let t=z;try{return z=this,e()}finally{z=t}}}on(){z=this}off(){z=this.parent}stop(e){if(this._active){this._active=!1;let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(this.effects.length=0,t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){let e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.parent=void 0}}};function ut(e){return new lt(e)}function dt(){return z}function ft(e,t=!1){z&&z.cleanups.push(e)}let B;const pt=new WeakSet;var mt=class{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,z&&z.active&&z.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,pt.has(this)&&(pt.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||vt(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,At(this),xt(this);let e=B,t=V;B=this,V=!0;try{return this.fn()}finally{St(this),B=e,V=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Tt(e);this.deps=this.depsTail=void 0,At(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?pt.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Ct(this)&&this.run()}get dirty(){return Ct(this)}};let ht=0,gt,_t;function vt(e,t=!1){if(e.flags|=8,t){e.next=_t,_t=e;return}e.next=gt,gt=e}function yt(){ht++}function bt(){if(--ht>0)return;if(_t){let e=_t;for(_t=void 0;e;){let t=e.next;e.next=void 0,e.flags&=-9,e=t}}let e;for(;gt;){let t=gt;for(gt=void 0;t;){let n=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(t){e||=t}t=n}}if(e)throw e}function xt(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function St(e){let t,n=e.depsTail,r=n;for(;r;){let e=r.prevDep;r.version===-1?(r===n&&(n=e),Tt(r),Et(r)):t=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=e}e.deps=t,e.depsTail=n}function Ct(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(wt(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function wt(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===jt))return;e.globalVersion=jt;let t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!Ct(e)){e.flags&=-3;return}let n=B,r=V;B=e,V=!0;try{xt(e);let n=e.fn(e._value);(t.version===0||R(n,e._value))&&(e._value=n,t.version++)}catch(e){throw t.version++,e}finally{B=n,V=r,St(e),e.flags&=-3}}function Tt(e,t=!1){let{dep:n,prevSub:r,nextSub:i}=e;if(r&&(r.nextSub=i,e.prevSub=void 0),i&&(i.prevSub=r,e.nextSub=void 0),n.subs===e&&(n.subs=r,!r&&n.computed)){n.computed.flags&=-5;for(let e=n.computed.deps;e;e=e.nextDep)Tt(e,!0)}!t&&!--n.sc&&n.map&&n.map.delete(n.key)}function Et(e){let{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let V=!0;const Dt=[];function Ot(){Dt.push(V),V=!1}function kt(){let e=Dt.pop();V=e===void 0?!0:e}function At(e){let{cleanup:t}=e;if(e.cleanup=void 0,t){let e=B;B=void 0;try{t()}finally{B=e}}}let jt=0;var Mt=class{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}},Nt=class{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!B||!V||B===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==B)t=this.activeLink=new Mt(B,this),B.deps?(t.prevDep=B.depsTail,B.depsTail.nextDep=t,B.depsTail=t):B.deps=B.depsTail=t,Pt(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){let e=t.nextDep;e.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=e),t.prevDep=B.depsTail,t.nextDep=void 0,B.depsTail.nextDep=t,B.depsTail=t,B.deps===t&&(B.deps=e)}return t}trigger(e){this.version++,jt++,this.notify(e)}notify(e){yt();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{bt()}}};function Pt(e){if(e.dep.sc++,e.sub.flags&4){let t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let e=t.deps;e;e=e.nextDep)Pt(e)}let n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const Ft=new WeakMap,It=Symbol(``),Lt=Symbol(``),Rt=Symbol(``);function H(e,t,n){if(V&&B){let t=Ft.get(e);t||Ft.set(e,t=new Map);let r=t.get(n);r||(t.set(n,r=new Nt),r.map=t,r.key=n),r.track()}}function zt(e,t,n,r,i,a){let o=Ft.get(e);if(!o){jt++;return}let s=e=>{e&&e.trigger()};if(yt(),t===`clear`)o.forEach(s);else{let i=N(e),a=i&&at(n);if(i&&n===`length`){let e=Number(r);o.forEach((t,n)=>{(n===`length`||n===Rt||!F(n)&&n>=e)&&s(t)})}else switch((n!==void 0||o.has(void 0))&&s(o.get(n)),a&&s(o.get(Rt)),t){case`add`:i?a&&s(o.get(`length`)):(s(o.get(It)),Qe(e)&&s(o.get(Lt)));break;case`delete`:i||(s(o.get(It)),Qe(e)&&s(o.get(Lt)));break;case`set`:Qe(e)&&s(o.get(It));break}}bt()}function Bt(e){let t=W(e);return t===e?t:(H(t,`iterate`,Rt),U(e)?t:t.map(G))}function Vt(e){return H(e=W(e),`iterate`,Rt),e}const Ht={__proto__:null,[Symbol.iterator](){return Ut(this,Symbol.iterator,G)},concat(...e){return Bt(this).concat(...e.map(e=>N(e)?Bt(e):e))},entries(){return Ut(this,`entries`,e=>(e[1]=G(e[1]),e))},every(e,t){return Gt(this,`every`,e,t,void 0,arguments)},filter(e,t){return Gt(this,`filter`,e,t,e=>e.map(G),arguments)},find(e,t){return Gt(this,`find`,e,t,G,arguments)},findIndex(e,t){return Gt(this,`findIndex`,e,t,void 0,arguments)},findLast(e,t){return Gt(this,`findLast`,e,t,G,arguments)},findLastIndex(e,t){return Gt(this,`findLastIndex`,e,t,void 0,arguments)},forEach(e,t){return Gt(this,`forEach`,e,t,void 0,arguments)},includes(...e){return qt(this,`includes`,e)},indexOf(...e){return qt(this,`indexOf`,e)},join(e){return Bt(this).join(e)},lastIndexOf(...e){return qt(this,`lastIndexOf`,e)},map(e,t){return Gt(this,`map`,e,t,void 0,arguments)},pop(){return Jt(this,`pop`)},push(...e){return Jt(this,`push`,e)},reduce(e,...t){return Kt(this,`reduce`,e,t)},reduceRight(e,...t){return Kt(this,`reduceRight`,e,t)},shift(){return Jt(this,`shift`)},some(e,t){return Gt(this,`some`,e,t,void 0,arguments)},splice(...e){return Jt(this,`splice`,e)},toReversed(){return Bt(this).toReversed()},toSorted(e){return Bt(this).toSorted(e)},toSpliced(...e){return Bt(this).toSpliced(...e)},unshift(...e){return Jt(this,`unshift`,e)},values(){return Ut(this,`values`,G)}};function Ut(e,t,n){let r=Vt(e),i=r[t]();return r!==e&&!U(e)&&(i._next=i.next,i.next=()=>{let e=i._next();return e.value&&=n(e.value),e}),i}const Wt=Array.prototype;function Gt(e,t,n,r,i,a){let o=Vt(e),s=o!==e&&!U(e),c=o[t];if(c!==Wt[t]){let t=c.apply(e,a);return s?G(t):t}let l=n;o!==e&&(s?l=function(t,r){return n.call(this,G(t),r,e)}:n.length>2&&(l=function(t,r){return n.call(this,t,r,e)}));let u=c.call(o,l,r);return s&&i?i(u):u}function Kt(e,t,n,r){let i=Vt(e),a=n;return i!==e&&(U(e)?n.length>3&&(a=function(t,r,i){return n.call(this,t,r,i,e)}):a=function(t,r,i){return n.call(this,t,G(r),i,e)}),i[t](a,...r)}function qt(e,t,n){let r=W(e);H(r,`iterate`,Rt);let i=r[t](...n);return(i===-1||i===!1)&&En(n[0])?(n[0]=W(n[0]),r[t](...n)):i}function Jt(e,t,n=[]){Ot(),yt();let r=W(e)[t].apply(e,n);return bt(),kt(),r}const Yt=Ke(`__proto__,__v_isRef,__isVue`),Xt=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!==`arguments`&&e!==`caller`).map(e=>Symbol[e]).filter(F));function Zt(e){F(e)||(e=String(e));let t=W(this);return H(t,`has`,e),t.hasOwnProperty(e)}var Qt=class{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){if(t===`__v_skip`)return e.__v_skip;let r=this._isReadonly,i=this._isShallow;if(t===`__v_isReactive`)return!r;if(t===`__v_isReadonly`)return r;if(t===`__v_isShallow`)return i;if(t===`__v_raw`)return n===(r?i?_n:gn:i?hn:mn).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;let a=N(e);if(!r){let e;if(a&&(e=Ht[t]))return e;if(t===`hasOwnProperty`)return Zt}let o=Reflect.get(e,t,K(e)?e:n);return(F(t)?Xt.has(t):Yt(t))||(r||H(e,`get`,t),i)?o:K(o)?a&&at(t)?o:o.value:I(o)?r?Sn(o):bn(o):o}},$t=class extends Qt{constructor(e=!1){super(!1,e)}set(e,t,n,r){let i=e[t];if(!this._isShallow){let t=Tn(i);if(!U(n)&&!Tn(n)&&(i=W(i),n=W(n)),!N(e)&&K(i)&&!K(n))return t?!1:(i.value=n,!0)}let a=N(e)&&at(t)?Number(t)<e.length:Ze(e,t),o=Reflect.set(e,t,n,K(e)?e:r);return e===W(r)&&(a?R(n,i)&&zt(e,`set`,t,n,i):zt(e,`add`,t,n)),o}deleteProperty(e,t){let n=Ze(e,t),r=e[t],i=Reflect.deleteProperty(e,t);return i&&n&&zt(e,`delete`,t,void 0,r),i}has(e,t){let n=Reflect.has(e,t);return(!F(t)||!Xt.has(t))&&H(e,`has`,t),n}ownKeys(e){return H(e,`iterate`,N(e)?`length`:It),Reflect.ownKeys(e)}},en=class extends Qt{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}};const tn=new $t,nn=new en,rn=new $t(!0),an=e=>e,on=e=>Reflect.getPrototypeOf(e);function sn(e,t,n){return function(...r){let i=this.__v_raw,a=W(i),o=Qe(a),s=e===`entries`||e===Symbol.iterator&&o,c=e===`keys`&&o,l=i[e](...r),u=n?an:t?Dn:G;return!t&&H(a,`iterate`,c?Lt:It),{next(){let{value:e,done:t}=l.next();return t?{value:e,done:t}:{value:s?[u(e[0]),u(e[1])]:u(e),done:t}},[Symbol.iterator](){return this}}}}function cn(e){return function(...t){return e===`delete`?!1:e===`clear`?void 0:this}}function ln(e,t){let n={get(n){let r=this.__v_raw,i=W(r),a=W(n);e||(R(n,a)&&H(i,`get`,n),H(i,`get`,a));let{has:o}=on(i),s=t?an:e?Dn:G;if(o.call(i,n))return s(r.get(n));if(o.call(i,a))return s(r.get(a));r!==i&&r.get(n)},get size(){let t=this.__v_raw;return!e&&H(W(t),`iterate`,It),Reflect.get(t,`size`,t)},has(t){let n=this.__v_raw,r=W(n),i=W(t);return e||(R(t,i)&&H(r,`has`,t),H(r,`has`,i)),t===i?n.has(t):n.has(t)||n.has(i)},forEach(n,r){let i=this,a=i.__v_raw,o=W(a),s=t?an:e?Dn:G;return!e&&H(o,`iterate`,It),a.forEach((e,t)=>n.call(r,s(e),s(t),i))}};Ye(n,e?{add:cn(`add`),set:cn(`set`),delete:cn(`delete`),clear:cn(`clear`)}:{add(e){!t&&!U(e)&&!Tn(e)&&(e=W(e));let n=W(this),r=on(n),i=r.has.call(n,e);return i||(n.add(e),zt(n,`add`,e,e)),this},set(e,n){!t&&!U(n)&&!Tn(n)&&(n=W(n));let r=W(this),{has:i,get:a}=on(r),o=i.call(r,e);o||(e=W(e),o=i.call(r,e));let s=a.call(r,e);return r.set(e,n),o?R(n,s)&&zt(r,`set`,e,n,s):zt(r,`add`,e,n),this},delete(e){let t=W(this),{has:n,get:r}=on(t),i=n.call(t,e);i||(e=W(e),i=n.call(t,e));let a=r?r.call(t,e):void 0,o=t.delete(e);return i&&zt(t,`delete`,e,void 0,a),o},clear(){let e=W(this),t=e.size!==0,n,r=e.clear();return t&&zt(e,`clear`,void 0,void 0,n),r}});let r=[`keys`,`values`,`entries`,Symbol.iterator];return r.forEach(r=>{n[r]=sn(r,e,t)}),n}function un(e,t){let n=ln(e,t);return(t,r,i)=>r===`__v_isReactive`?!e:r===`__v_isReadonly`?e:r===`__v_raw`?t:Reflect.get(Ze(n,r)&&r in t?n:t,r,i)}const dn={get:un(!1,!1)},fn={get:un(!1,!0)},pn={get:un(!0,!1)},mn=new WeakMap,hn=new WeakMap,gn=new WeakMap,_n=new WeakMap;function vn(e){switch(e){case`Object`:case`Array`:return 1;case`Map`:case`Set`:case`WeakMap`:case`WeakSet`:return 2;default:return 0}}function yn(e){return e.__v_skip||!Object.isExtensible(e)?0:vn(L(e))}function bn(e){return Tn(e)?e:Cn(e,!1,tn,dn,mn)}function xn(e){return Cn(e,!1,rn,fn,hn)}function Sn(e){return Cn(e,!0,nn,pn,gn)}function Cn(e,t,n,r,i){if(!I(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;let a=i.get(e);if(a)return a;let o=yn(e);if(o===0)return e;let s=new Proxy(e,o===2?r:n);return i.set(e,s),s}function wn(e){return Tn(e)?wn(e.__v_raw):!!(e&&e.__v_isReactive)}function Tn(e){return!!(e&&e.__v_isReadonly)}function U(e){return!!(e&&e.__v_isShallow)}function En(e){return e?!!e.__v_raw:!1}function W(e){let t=e&&e.__v_raw;return t?W(t):e}const G=e=>I(e)?bn(e):e,Dn=e=>I(e)?Sn(e):e;function K(e){return e?e.__v_isRef===!0:!1}function On(e){return kn(e,!1)}function q(e){return kn(e,!0)}function kn(e,t){return K(e)?e:new An(e,t)}var An=class{constructor(e,t){this.dep=new Nt,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:W(e),this._value=t?e:G(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){let t=this._rawValue,n=this.__v_isShallow||U(e)||Tn(e);e=n?e:W(e),R(e,t)&&(this._rawValue=e,this._value=n?e:G(e),this.dep.trigger())}};function jn(e){return K(e)?e.value:e}function Mn(e){return P(e)?e():jn(e)}var Nn=class{constructor(e,t,n){this.fn=e,this.setter=t,this._value=void 0,this.dep=new Nt(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=jt-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&B!==this)return vt(this,!0),!0}get value(){let e=this.dep.track();return wt(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}};function J(e,t,n=!1){let r,i;P(e)?r=e:(r=e.get,i=e.set);let a=new Nn(r,i,n);return a}const Pn={},Fn=new WeakMap;let In;function Ln(e,t=!1,n=In){if(n){let t=Fn.get(n);t||Fn.set(n,t=[]),t.push(e)}}function Rn(e,t,n=qe){let{immediate:r,deep:i,once:a,scheduler:o,augmentJob:s,call:c}=n,l=e=>{(n.onWarn||ct)(`Invalid watch source: `,e,`A watch source can only be a getter/effect function, a ref, a reactive object, or an array of these types.`)},u=e=>i?e:U(e)||i===!1||i===0?zn(e,1):zn(e),d,f,p,m,h=!1,g=!1;if(K(e)?(f=()=>e.value,h=U(e)):wn(e)?(f=()=>u(e),h=!0):N(e)?(g=!0,h=e.some(e=>wn(e)||U(e)),f=()=>e.map(e=>{if(K(e))return e.value;if(wn(e))return u(e);if(P(e))return c?c(e,2):e()})):f=P(e)?t?c?()=>c(e,2):e:()=>{if(p){Ot();try{p()}finally{kt()}}let t=In;In=d;try{return c?c(e,3,[m]):e(m)}finally{In=t}}:Je,t&&i){let e=f,t=i===!0?1/0:i;f=()=>zn(e(),t)}let _=dt(),v=()=>{d.stop(),_&&_.active&&M(_.effects,d)};if(a&&t){let e=t;t=(...t)=>{e(...t),v()}}let y=g?Array(e.length).fill(Pn):Pn,b=e=>{if(!(!(d.flags&1)||!d.dirty&&!e))if(t){let e=d.run();if(i||h||(g?e.some((e,t)=>R(e,y[t])):R(e,y))){p&&p();let n=In;In=d;try{let n=[e,y===Pn?void 0:g&&y[0]===Pn?[]:y,m];c?c(t,3,n):t(...n),y=e}finally{In=n}}}else d.run()};return s&&s(b),d=new mt(f),d.scheduler=o?()=>o(b,!1):b,m=e=>Ln(e,!1,d),p=d.onStop=()=>{let e=Fn.get(d);if(e){if(c)c(e,4);else for(let t of e)t();Fn.delete(d)}},t?r?b(!0):y=d.run():o?o(b.bind(null,!0),!0):d.run(),v.pause=d.pause.bind(d),v.resume=d.resume.bind(d),v.stop=v,v}function zn(e,t=1/0,n){if(t<=0||!I(e)||e.__v_skip||(n||=new Set,n.has(e)))return e;if(n.add(e),t--,K(e))zn(e.value,t,n);else if(N(e))for(let r=0;r<e.length;r++)zn(e[r],t,n);else if($e(e)||Qe(e))e.forEach(e=>{zn(e,t,n)});else if(it(e)){for(let r in e)zn(e[r],t,n);for(let r of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,r)&&zn(e[r],t,n)}return e}var Bn=(e=>(e.ACTIVATED=`a`,e.DEACTIVATED=`da`,e))(Bn||{}),Vn=(e=>(e[e.WATCH_GETTER=0]=`WATCH_GETTER`,e[e.WATCH_CALLBACK=1]=`WATCH_CALLBACK`,e[e.WATCH_CLEANUP=2]=`WATCH_CLEANUP`,e[e.APP_ERROR_HANDLER=3]=`APP_ERROR_HANDLER`,e[e.SCHEDULER=4]=`SCHEDULER`,e))(Vn||{});const Hn={[Bn.ACTIVATED]:`activated hook`,[Bn.DEACTIVATED]:`deactivated hook`,0:`watcher getter`,1:`watcher callback`,2:`watcher cleanup function`,3:`app errorHandler`,4:`scheduler flush`};function Un(e,t,n,r){try{return r?e(...r):e()}catch(e){Gn(e,t,n)}}function Wn(e,t,n,r){if(P(e)){let i=Un(e,t,n,r);return i&&tt(i)&&i.catch(e=>{Gn(e,t,n)}),i}if(N(e)){let i=[];for(let a=0;a<e.length;a++)i.push(Wn(e[a],t,n,r));return i}}function Gn(e,t,n,r=!0){let i=null;Kn(e,n,i,r)}function Kn(e,t,n,r=!0){console.error(e)}var qn=(e=>(e[e.QUEUED=1]=`QUEUED`,e[e.PRE=2]=`PRE`,e[e.ALLOW_RECURSE=4]=`ALLOW_RECURSE`,e[e.DISPOSED=8]=`DISPOSED`,e))(qn||{});let Jn=!1,Yn=!1;const Y=[];let Xn=0;const Zn=[];let Qn=null,$n=0;const er=Promise.resolve();let tr=null;function nr(e){let t=tr||er;return e?t.then(this?e.bind(this):e):t}function rr(e){let t=Jn?Xn+1:0,n=Y.length;for(;t<n;){let r=t+n>>>1,i=Y[r],a=sr(i);a<e||a===e&&i.flags&2?t=r+1:n=r}return t}function ir(e){if(!(e.flags&1)){let t=sr(e),n=Y[Y.length-1];!n||!(e.flags&2)&&t>=sr(n)?Y.push(e):Y.splice(rr(t),0,e),e.flags|=1,ar()}}function ar(){!Jn&&!Yn&&(Yn=!0,tr=er.then(cr))}function or(e){if(Zn.length){let e=[...new Set(Zn)].sort((e,t)=>sr(e)-sr(t));if(Zn.length=0,Qn){Qn.push(...e);return}for(Qn=e,$n=0;$n<Qn.length;$n++){let e=Qn[$n];e.flags&4&&(e.flags&=-2),e.flags&8||e(),e.flags&=-2}Qn=null,$n=0}}const sr=e=>e.id==null?e.flags&2?-1:1/0:e.id;function cr(e){Yn=!1,Jn=!0;let t=Je;try{for(Xn=0;Xn<Y.length;Xn++){let e=Y[Xn];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Un(e,null,Vn.SCHEDULER),e.flags&4||(e.flags&=-2))}}finally{for(;Xn<Y.length;Xn++){let e=Y[Xn];e&&(e.flags&=-2)}Xn=0,Y.length=0,or(e),Jn=!1,tr=null,(Y.length||Zn.length)&&cr(e)}}function lr(e,t){return dr(e,null,t)}function ur(e,t,n){return dr(e,t,n)}function dr(e,t,n=qe){let{immediate:r,deep:i,flush:a,once:o}=n,s=Ye({},n);s.call=(e,t,n)=>Wn(e,null,t,n);let c=!1;a!==`sync`&&(c=!0,s.scheduler=(e,t)=>{t?e():ir(e)}),s.augmentJob=e=>{t&&(e.flags|=qn.ALLOW_RECURSE),c&&(e.flags|=qn.PRE)};let l=Rn(e,t,s);return l}function fr(e){return dt()?(ft(e),!0):!1}function pr(e,t){let n=new Map;return(...r)=>{let i=t(...r),a=n.get(i);return a?a.refCount++:(a={data:e(...r),refCount:1},n.set(i,a)),fr(()=>{--a.refCount===0&&n.delete(i)}),a.data}}function X(e){let t;return()=>t===void 0?t=ut(!0).run(e):t}const mr=[];function hr(e){mr.push(e)}const gr=q(null),_r=ut();function vr(e){return{activate:t=>(gr.value=t,_r.run(()=>(yr.map(e=>e(t)),e(t)))),deactivate:()=>{mr.map(e=>e()),_r.stop()}}}const yr=[];function br(e){gr.value?e(gr.value):yr.push(e)}function xr(e,t,r){let i=!e,a=n.workspace.getConfiguration(i?void 0:e,r);function o(e,t){let n=q(t),r=J({get:()=>n.value,set:t=>{n.value=t,a.update(e,t)}});return r.update=async(t,n,i)=>{await a.update(e,t,n,i),r.value=t},r.set=e=>{n.value=e},r}let s=Object.fromEntries(Object.keys(t).map(e=>[e,o(e,a.get(e))]));return br(()=>{Z(n.workspace.onDidChangeConfiguration(i?e=>{let r=n.workspace.getConfiguration();for(let n in t)e.affectsConfiguration(n)&&s[n].set(r.get(n))}:r=>{if(!r.affectsConfiguration(e))return;let i=n.workspace.getConfiguration(e);for(let n in t)r.affectsConfiguration(`${e}.${n}`)&&s[n].set(i.get(n))}))}),s}function Sr(e,t,n){let r=xr(e,t,n),i={},a=xn({$update(e,t,n,i){return r[e].update(t,n,i)},$set(e,t){return r[e].set(t)}});for(let e in t){let t=e.split(`.`),n=``,o=i,s=a;for(let e of t.slice(0,-1)){n=n?`${n}.${e}`:e;let t=o=o[e]||(o[e]={});if(s[e])s=s[e];else{let i=xn({});Object.defineProperty(s,e,{enumerable:!0,get(){return i},set(e){function i(e,t,n){if(e)for(let r in e)i(e[r],t?`${t}.${r}`:r,n?.[r]);else r[t].value=n}i(t,n,e)}}),s=i}}let c=t[t.length-1];o[c]=null,Object.defineProperty(s,c,{enumerable:!0,get(){return r[e].value},set(t){r[e].value=t}})}return a}function Cr(e,...t){return n.commands.executeCommand(e,...t)}function Z(e){return(dt()??_r).cleanups.push(e.dispose.bind(e)),e}const wr=X(()=>{let e=q(n.window.activeColorTheme);return Z(n.window.onDidChangeActiveColorTheme(t=>{e.value=t})),e}),Tr=X(()=>{let e=q(n.debug.activeDebugSession);return Z(n.debug.onDidChangeActiveDebugSession(t=>{e.value=t})),J(()=>e.value)}),Er=X(()=>{let e=q(n.window.activeTextEditor);return Z(n.window.onDidChangeActiveTextEditor(t=>{e.value=t})),e}),Dr=X(()=>{let e=q(n.window.activeNotebookEditor);return Z(n.window.onDidChangeActiveNotebookEditor(t=>{e.value=t})),e}),Or=X(()=>{let e=q(n.window.activeTerminal);return Z(n.window.onDidChangeActiveTerminal(t=>{e.value=t})),e}),kr=X(()=>{let e=q(n.extensions.all);return Z(n.extensions.onDidChange(()=>{e.value=n.extensions.all})),J(()=>e.value)});function Ar(e,t){Z(n.commands.registerCommand(e,t))}const jr=X(()=>{let e=q(n.env.shell);return Z(n.env.onDidChangeShell(t=>{e.value=t})),J(()=>e.value)});function Mr(e,t){let n=(t,n,r)=>{Z(e(t,n,r))};return t?.forEach(e=>n(e)),n}function Nr(e,t=[]){let r=Array.isArray(e)?e:t??[],i=Z(Array.isArray(e)||e==null?new n.EventEmitter:e),a=Mr(i.event,r);for(let e of r)a(e);return{event:i.event,fire:i.fire.bind(i),addListener:a}}const Pr=X(()=>{let e=wr();return J(()=>e.value.kind===n.ColorThemeKind.Dark||e.value.kind===n.ColorThemeKind.HighContrast)}),Fr=X(()=>{let e=q(n.env.isTelemetryEnabled);return Z(n.env.onDidChangeTelemetryEnabled(t=>{e.value=t})),J(()=>e.value)});function Ir(e,t){return Z(n.window.createOutputChannel(e,t))}const Lr=X(()=>{let e=q(n.env.logLevel);return Z(n.env.onDidChangeLogLevel(t=>{e.value=t})),J(()=>e.value)}),Rr=X(()=>{let e=q(n.window.terminals);function t(){e.value=n.window.terminals}return Z(n.window.onDidOpenTerminal(t)),Z(n.window.onDidCloseTerminal(t)),e}),zr=X(()=>{let e=q(n.tasks.taskExecutions);function t(){e.value=n.tasks.taskExecutions}return Z(n.tasks.onDidStartTask(t)),Z(n.tasks.onDidEndTask(t)),J(()=>e.value)});function Br(e,t){lr(()=>{let n=Mn(e);n&&(n.badge=Mn(t))})}function Vr(e,t){lr(()=>{let n=Mn(e);n&&(n.title=Mn(t))})}const Hr=pr((e,t,r)=>{let i=Nr();ur(t,()=>i.fire()),r!=null&&r.watchSource&&ur(r.watchSource,()=>i.fire());let a=new WeakMap,o=Z(n.window.createTreeView(e,{...r,treeDataProvider:{...r,onDidChangeTreeData:i.event,getTreeItem(e){return e.treeItem},getChildren(e){var n;return e?((n=e.children)==null||n.forEach(t=>a.set(t,e)),e.children):Mn(t)},getParent(e){return a.get(e)}}}));return r!=null&&r.title&&Vr(o,r.title),r!=null&&r.badge&&Br(o,r.badge),o},e=>e),Ur=X(()=>{let e=q(n.window.visibleNotebookEditors);return Z(n.window.onDidChangeVisibleNotebookEditors(t=>{e.value=t})),e}),Wr=X(()=>{let e=q(n.window.visibleTextEditors);return Z(n.window.onDidChangeVisibleTextEditors(t=>{e.value=t})),e}),Gr=pr((e,t,r)=>{let i=q(),a=q();Z(n.window.registerWebviewViewProvider(e,{resolveWebviewView(e,t){i.value=e,a.value=t,r!=null&&r.onDidReceiveMessage&&e.webview.onDidReceiveMessage(r.onDidReceiveMessage)}},{webviewOptions:{retainContextWhenHidden:r?.retainContextWhenHidden}}));let o=On(0);function s(){o.value++}if(lr(()=>{i.value&&(i.value.webview.html=`${Mn(t)}<!--${o.value}-->`)}),r!=null&&r.webviewOptions){let e=r.webviewOptions;lr(()=>{i.value&&(i.value.webview.options=Mn(e))})}r!=null&&r.title&&Vr(i,r.title),r!=null&&r.badge&&Br(i,r.badge);function c(e){var t;return(t=i.value)?.webview.postMessage(e)}return{view:i,context:a,postMessage:c,forceRefresh:s}},e=>e),Kr=X(()=>{let e=q(n.window.state);return Z(n.window.onDidChangeWindowState(t=>{e.value=t})),{focused:J(()=>e.value.focused),active:J(()=>e.value.active)}}),qr=X(()=>{let e=q(n.workspace.workspaceFolders);return Z(n.workspace.onDidChangeWorkspaceFolders(()=>{e.value=n.workspace.workspaceFolders})),J(()=>e.value)}),Jr=`Vue`,Yr=`volar`,Xr=`${Jr}.${Yr}`,Zr={scope:`vue`,defaults:{"trace.server":`off`,"editor.focusMode":!0,"editor.reactivityVisualization":!0,"editor.templateInterpolationDecorators":!0,"server.includeLanguages":[`vue`],"codeActions.askNewComponentName":!0,"suggest.componentNameCasing":`preferPascalCase`,"suggest.propNameCasing":`preferKebabCase`,"suggest.defineAssignment":!0,"autoInsert.dotValue":!1,"autoInsert.bracketSpacing":!0,"inlayHints.destructuredProps":!1,"inlayHints.missingProps":!1,"inlayHints.inlineHandlerLeading":!1,"inlayHints.optionsWrapper":!1,"inlayHints.vBindShorthand":!1,"format.template.initialIndent":!0,"format.script.initialIndent":!1,"format.style.initialIndent":!1,"format.wrapAttributes":`auto`}},Q=Sr(Zr.scope,Zr.defaults),Qr=n.window.createTextEditorDecorationType({borderWidth:`1px`,borderStyle:`solid`,borderColor:`rgba(128, 128, 128, 0.5)`,backgroundColor:`rgba(200, 200, 200, 0.1)`,borderRadius:`4px`});async function $r(e,t,r){await r.start();let i;for(let e of n.window.visibleTextEditors)a(e);e.subscriptions.push(n.window.onDidChangeActiveTextEditor(e=>{e&&a(e)}),n.workspace.onDidChangeTextDocument(()=>{let e=n.window.activeTextEditor;e&&(clearTimeout(i),i=setTimeout(()=>a(e),100))}),n.workspace.onDidChangeConfiguration(e=>{if(e.affectsConfiguration(`vue.editor.templateInterpolationDecorators`))for(let e of n.window.visibleTextEditors)a(e)}));async function a(e){if(n.languages.match(t,e.document))if(!Q.editor.templateInterpolationDecorators)e.setDecorations(Qr,[]);else{let t=await r.sendRequest(`vue/interpolationRanges`,{textDocument:r.code2ProtocolConverter.asTextDocumentIdentifier(e.document)});e.setDecorations(Qr,t.map(t=>({range:new n.Range(e.document.positionAt(t[0]),e.document.positionAt(t[1]))})))}}}const ei=new WeakMap,ti=Array.from({length:8}).map((e,t)=>n.window.createTextEditorDecorationType({opacity:(.7**t).toString(),isWholeLine:!0}));async function ni(e,t,r){await r.start();let i,a=new Map;setInterval(()=>{for(let[e,t]of Array.from(a)){if(t.currentTagDecIndex!==t.targetTagDecIndex){let r=t.currentTagDecIndex;t.targetTagDecIndex>t.currentTagDecIndex?t.currentTagDecIndex++:t.currentTagDecIndex--,t.currentTagDecIndex>0&&e.setDecorations(ti[t.currentTagDecIndex],t.tagRanges.map(e=>new n.Range(new n.Position(e[0],0),new n.Position(e[1],0)))),e.setDecorations(ti[r],[])}t.currentTagDecIndex===0&&t.targetTagDecIndex===0&&a.delete(e)}},24),e.subscriptions.push(n.window.onDidChangeVisibleTextEditors(e=>{for(let[t,n]of a)e.includes(t)||(n.targetTagDecIndex=0)}),n.window.onDidChangeTextEditorSelection(e=>{e&&o(e.textEditor)}),n.workspace.onDidChangeTextDocument(()=>{let e=n.window.activeTextEditor;e&&(clearTimeout(i),i=setTimeout(()=>o(e),100))}),n.workspace.onDidChangeConfiguration(e=>{if(e.affectsConfiguration(`vue.editor.focusMode`))for(let e of n.window.visibleTextEditors)o(e)}));async function o(e){if(!n.languages.match(t,e.document))return;let i=e.document;(!ei.has(i)||ei.get(i)[0]!==i.version)&&ei.set(i,[i.version,r.sendRequest(`vue/parseSfc`,{textDocument:r.code2ProtocolConverter.asTextDocumentIdentifier(i)})]);let o=await ei.get(i)[1];if(!o)return;let s=o.descriptor,c=[...s.styles,...s.customBlocks,s.template,s.script,s.scriptSetup].filter(e=>!!e).sort((e,t)=>e.loc.start.offset-t.loc.start.offset),l=a.get(e);l||(l={currentTagDecIndex:0,targetTagDecIndex:0,tagRanges:[]},a.set(e,l)),l.tagRanges.length=0;let u=e.selection.active.line,d=!1;for(let t of c){let n=e.document.positionAt(t.loc.start.offset).line,r=e.document.positionAt(t.loc.end.offset).line;r-n<=1?l.tagRanges.push([n,r]):(l.tagRanges.push([n,n]),l.tagRanges.push([r,r]),d||=u>=n+1&&u<=r-1)}Q.editor.focusMode&&d?l.targetTagDecIndex=ti.length-1:l.targetTagDecIndex=0}}const ri=n.window.createTextEditorDecorationType({isWholeLine:!0,backgroundColor:`rgba(120,120,255,0.1)`,border:`1px solid rgba(120,120,255,0.6)`,borderWidth:`0 0 0 3px`}),ii=n.window.createTextEditorDecorationType({isWholeLine:!0,backgroundColor:`rgba(80,200,80,0.1)`,border:`1px solid rgba(80,200,80,0.6)`,borderWidth:`0 0 0 3px`});async function ai(e,t,r){await r.start();let i,a=new Map;for(let e of n.window.visibleTextEditors)o(e);e.subscriptions.push(n.window.onDidChangeActiveTextEditor(e=>{e&&o(e)}),n.window.onDidChangeTextEditorSelection(()=>{let e=n.window.activeTextEditor;e&&(clearTimeout(i),i=setTimeout(()=>o(e),100))}));async function o(e){if(!n.languages.match(t,e.document)&&e.document.languageId!==`typescript`&&e.document.languageId!==`javascript`&&e.document.languageId!==`typescriptreact`&&e.document.languageId!==`javascriptreact`)return;if(!Q.editor.reactivityVisualization){e.setDecorations(ri,[]),e.setDecorations(ii,[]);return}let i=r.code2ProtocolConverter.asTextDocumentPositionParams(e.document,e.selection.active),o=e.document.version+`,`+e.document.offsetAt(e.selection.active);if(a.get(e.document.uri.toString())===o)return;i.syncDocument={content:e.document.getText(),languageId:e.document.languageId},a.set(e.document.uri.toString(),o);let s=await r.sendRequest(`vue/reactionsAnalyze`,i);e.setDecorations(ri,s?.dependencies.map(e=>r.protocol2CodeConverter.asRange(e))??[]),e.setDecorations(ii,s?.subscribers.map(e=>r.protocol2CodeConverter.asRange(e))??[])}}const oi=[`johnsoncodehk.vscode-typescript-vue-plugin`,`Vue.vscode-typescript-vue-plugin`];for(let e of oi){let t=n.extensions.getExtension(e);t&&n.window.showErrorMessage(`The "${e}" extension is incompatible with the Vue extension. Please uninstall it.`,`Show Extension`).then(t=>{t===`Show Extension`&&n.commands.executeCommand(`workbench.extensions.search`,`@id:`+e)})}let si=!1,$,ci;const li=`3.0.0`;var ui=class extends Ge.LanguageClient{fillInitializeParams(e){e.locale=n.env.language}};const{activate:di,deactivate:fi}=vr(async()=>{await n.extensions.getExtension(`vscode.typescript-language-features`)?.activate();let e=gr.value,t=(0,He.createLabsInfo)(),a=Er(),o=Wr(),{stop:s}=ur(a,async()=>{if(!o.value.some(e=>Q.server.includeLanguages.includes(e.document.languageId)))return;nr(()=>s()),ur(()=>Q.server.includeLanguages,async()=>{let e=await n.window.showInformationMessage(`Please restart extension host to apply the new language settings.`,`Restart Extension Host`);e&&Cr(`workbench.action.restartExtensionHost`)}),r.existsSync(i.join(__dirname,`language-server.js`))&&r.writeFileSync(i.join(__dirname,`typescript.js`),`module.exports = require("${n.env.appRoot.replace(/\\/g,`/`)}/extensions/node_modules/typescript/lib/typescript.js");`),t.addLanguageClient($=Ci(e));let a=Q.server.includeLanguages;(0,He.activateAutoInsertion)(a,$),(0,He.activateDocumentDropEdit)(a,$);let c=e.globalState.get(`github-sponsor-verified`),l=e.globalState.get(`afdian-sponsor-verified`),u=e.globalState.get(`github-org-verified`);if((c||l||u)&&hi(e),c&&c!==e.extension.packageJSON.version){let t=await n.authentication.getSession(`github`,[`read:user`,`repo`]);t&&await gi(t,!1)?e.globalState.update(`github-sponsor-verified`,e.extension.packageJSON.version):(e.globalState.update(`github-sponsor-verified`,void 0),n.window.showInformationMessage(`Your GitHub authentication has expired. Please re-authenticate to continue using advanced features.`,`Re-authenticate`).then(e=>{e&&Cr(`vue.action.verify`)}))}if(l&&l!==e.extension.packageJSON.version){let t=e.globalState.get(`afdian-user-id`);t&&await yi(t,!1)?e.globalState.update(`afdian-sponsor-verified`,e.extension.packageJSON.version):(e.globalState.update(`afdian-sponsor-verified`,void 0),e.globalState.update(`afdian-user-id`,void 0),n.window.showInformationMessage(`Your AFDIAN authentication has expired. Please re-authenticate to continue using advanced features.`,`Re-authenticate`).then(e=>{e&&Cr(`vue.action.verify`)}))}if(u&&u!==e.extension.packageJSON.version){let t=await n.authentication.getSession(`github`,[`read:org`]);t&&await _i(t,!1)?e.globalState.update(`github-org-verified`,e.extension.packageJSON.version):(e.globalState.update(`github-org-verified`,void 0),n.window.showInformationMessage(`Your GitHub organization authentication has expired. Please re-authenticate to continue using advanced features.`,`Re-authenticate`).then(e=>{e&&Cr(`vue.action.verify`)}))}e.globalState.get(`vue-welcome`)!==li&&(e.globalState.update(`vue-welcome`,li),n.commands.executeCommand(`vue.welcome`))},{immediate:!0});return Ar(`vue.action.restartServer`,async()=>{await Cr(`typescript.restartTsServer`),await $?.stop(),$?.outputChannel.clear(),await $?.start()}),Ar(`vue.welcome`,()=>{if(ci){ci.reveal(n.ViewColumn.One);return}ci=n.window.createWebviewPanel(`vue.welcome`,`Welcome to Vue`,n.ViewColumn.One,{enableScripts:!0}),ci.webview.onDidReceiveMessage(e=>{switch(e.command){case`verifySponsor`:n.commands.executeCommand(`vue.action.verify`);break;case`openVideo`:n.env.openExternal(n.Uri.parse(`https://www.youtube.com/watch?v=${e.id}`));break}}),ci.webview.html=mi(),ci.onDidDispose(()=>{ci=void 0})}),Ar(`vue.action.verify`,async()=>{if(e.globalState.get(`github-sponsor-verified`)===e.extension.packageJSON.version||e.globalState.get(`afdian-sponsor-verified`)===e.extension.packageJSON.version||e.globalState.get(`github-org-verified`)===e.extension.packageJSON.version){n.window.showInformationMessage(`You are already authenticated. Do you want to clear your authentication?`,`Clear Authentication`,`Cancel`).then(t=>{t===`Clear Authentication`&&n.window.showInformationMessage(`Are you sure you want to clear your authentication? This will require you to re-authenticate to access premium features.`,`Yes, Clear Authentication`,`No, Cancel`).then(async t=>{t===`Yes, Clear Authentication`&&(await e.globalState.update(`github-sponsor-verified`,void 0),await e.globalState.update(`afdian-sponsor-verified`,void 0),await e.globalState.update(`github-org-verified`,void 0),await e.globalState.update(`afdian-user-id`,void 0),n.window.showInformationMessage(`Authentication cleared. You can now re-authenticate to access premium features.`),pi())})});return}let t=n.workspace.getConfiguration(`http`).get(`proxy`);if(t){let e=await n.window.showWarningMessage(`Authentication may fail due to proxy issues. If you encounter problems, please check your proxy settings.`,`Still Authenticate`,`Open Settings`);if(e===`Open Settings`){Cr(`workbench.action.openSettings`,`http.proxy`);return}if(e!==`Still Authenticate`)return}let r=await n.window.showQuickPick([{label:`via GitHub Sponsors`,value:`github`},{label:`via AFDIAN () Sponsors`,value:`afdian`},{label:``,kind:n.QuickPickItemKind.Separator},{label:`via GitHub Organizations`,value:`github-org`}]);if(r?.value===`github`){let t;try{t=await n.authentication.getSession(`github`,[`read:user`,`repo`],{clearSessionPreference:!0,createIfNone:!0})}catch{}if(!t)return;n.window.withProgress({location:n.ProgressLocation.Notification,title:`Authenticating sponsor status...`,cancellable:!1},async()=>{await gi(t,!0)?(e.globalState.update(`github-sponsor-verified`,e.extension.packageJSON.version),hi(e)):n.env.openExternal(n.Uri.parse(`https://github.com/sponsors/johnsoncodehk`))})}else if(r?.value===`afdian`)n.window.withProgress({location:n.ProgressLocation.Notification,title:`Authenticating sponsor status...`,cancellable:!0},async(t,n)=>{let r=await vi(n);r&&(e.globalState.update(`afdian-sponsor-verified`,e.extension.packageJSON.version),e.globalState.update(`afdian-user-id`,r),hi(e))});else if(r?.value===`github-org`){let t;try{t=await n.authentication.getSession(`github`,[`read:org`],{clearSessionPreference:!0,createIfNone:!0})}catch{}if(!t)return;n.window.withProgress({location:n.ProgressLocation.Notification,title:`Authenticating sponsor status...`,cancellable:!1},async()=>{await _i(t,!0)&&(e.globalState.update(`github-org-verified`,e.extension.packageJSON.version),hi(e))})}}),hr(async()=>{await $?.stop()}),t.extensionExports});function pi(){ci&&(ci.webview.html=mi())}function mi(){let e=gr.value,t=e.globalState.get(`github-sponsor-verified`),n=e.globalState.get(`afdian-sponsor-verified`),r=e.globalState.get(`github-org-verified`),i=!!(t||n||r);return`
<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Vue (Official)</title>
	<script>
		const vscode = acquireVsCodeApi();
		function verifySponsor() {
			vscode.postMessage({ command: 'verifySponsor' });
		}
	</script>
	<style>
		body {
			font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
			line-height: 1.6;
			max-width: 900px;
			margin: 0 auto;
			padding: 2rem;
			color: var(--vscode-foreground);
			background-color: var(--vscode-editor-background);
		}

		header {
			display: flex;
			align-items: center;
			gap: 2rem;
			margin: 1rem 0;
			justify-content: center;
			text-align: center;
			flex-wrap: wrap;
		}

		h1 {
			margin: 0;
			font-size: 2.5rem;
			font-weight: 600;
			color: var(--vscode-textPreformat-foreground);
		}

		h2 {
			margin-top: 2rem;
			font-weight: 500;
			color: var(--vscode-terminal-ansiGreen);
			position: relative;
			padding-bottom: 0.75rem;
		}

		h2::after {
			content: "";
			position: absolute;
			bottom: 0;
			left: 0;
			width: 60px;
			height: 3px;
			background-color: var(--vscode-terminal-ansiGreen);
		}

		h3 {
			color: var(--vscode-textPreformat-foreground);
			margin-top: 0;
		}

		a {
			color: var(--vscode-textLink-foreground);
			text-decoration: none;
			font-weight: 500;
			transition: all 0.2s ease;
		}

		a:hover {
			color: var(--vscode-textLink-activeForeground);
			text-decoration: underline;
		}

		ul {
			padding-left: 1.5rem;
		}

		li {
			margin-bottom: 0.75rem;
		}

		.card {
			border-radius: 12px;
			padding: 2rem;
			// margin: 2rem 0;
			background-color: var(--vscode-sideBar-background);
			box-shadow: 0 2px 8px var(--vscode-widget-shadow);
		}

		.sponsors-card #sponsors-container svg {
			width: 100% !important;
			height: auto !important;
		}

		.sponsors-card svg image {
			transition: transform 0.3s ease, opacity 0.3s ease;
			transform-box: fill-box;
			transform-origin: center;
			outline-offset: 4px;
		}

		.sponsors-card svg image:hover {
			transform: scale(1.2);
			outline: 2px solid #ffffff;
			outline-offset: 4px;
		}

		.sponsors-card svg:hover image:not(:hover) {
			transform: scale(0.95);
			opacity: 0.3;
		}

		.links {
			display: flex;
			gap: 1.5rem;
			justify-content: center;
			margin: 1.5rem 0;
			flex-wrap: wrap;
		}

		.links a {
			display: flex;
			align-items: center;
			gap: 0.5rem;
		}

		.features {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
			gap: 1.5rem;
			margin: 2rem 0;
		}

		.feature {
			padding: 1.5rem;
			border-radius: 10px;
			background-color: var(--vscode-sideBar-background);
			transition: transform 0.2s ease;
			box-shadow: 0 2px 8px var(--vscode-widget-shadow);
		}

		.feature:hover {
			transform: translateY(-3px);
		}

		.feature-icon {
			font-size: 1.5rem;
			margin-bottom: 1rem;
			color: var(--vscode-terminal-ansiGreen);
		}

		details {
			margin-bottom: 1rem;
			border-radius: 6px;
			overflow: hidden;
			background-color: var(--vscode-sideBar-background);
		}

		summary {
			cursor: pointer;
			font-weight: 500;
			padding: 0.8rem 1rem;
			background-color: var(--vscode-editor-lineHighlightBackground);
			outline: none;
			transition: background-color 0.2s ease;
		}

		summary:hover {
			background-color: var(--vscode-editor-lineHighlightBorder);
		}

		details[open] summary {
			background-color: var(--vscode-editor-lineHighlightBorder);
		}

		details div {
			padding: 1rem;
		}

		.video-container {
			position: relative;
			padding-bottom: 56.25%;
			/* 16:9 */
			height: 0;
			overflow: hidden;
			// margin: 2rem 0;
			border-radius: 12px;
			background-color: var(--vscode-sideBar-background);
			box-shadow: 0 4px 12px var(--vscode-widget-shadow);
		}

		.video-container * {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			border: none;
		}

		@media (max-width: 768px) {
			body {
				padding: 1.5rem;
			}

			header {
				flex-direction: column;
				gap: 1.5rem;
				margin: 2rem 0;
			}

			h1 {
				font-size: 2rem;
			}

			.card,
			.feature {
				padding: 1.25rem;
			}
		}
	</style>
</head>

<body>
	<header style="margin: 0;">
		<svg alt="Vue Logo" width="80" height="80" version="1.1" viewBox="0 0 261.76 226.69"
			xmlns="http://www.w3.org/2000/svg">
			<g transform="matrix(1.3333 0 0 -1.3333 -76.311 313.34)">
				<g transform="translate(178.06 235.01)">
					<path d="m0 0-22.669-39.264-22.669 39.264h-75.491l98.16-170.02 98.16 170.02z" fill="#41b883" />
				</g>
				<g transform="translate(178.06 235.01)">
					<path d="m0 0-22.669-39.264-22.669 39.264h-36.227l58.896-102.01 58.896 102.01z" fill="#34495e" />
				</g>
			</g>
		</svg>
		<div>
			<h1>Vue (Official) <sup><small>${e.extension.packageJSON.version}</small></sup></h1>
			<div class="links">
				<a href="https://github.com/vuejs/language-tools" target="_blank">
					<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="vertical-align: middle;">
						<path fill-rule="evenodd" clip-rule="evenodd"
							d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" />
					</svg>
					GitHub
				</a>
				<a href="https://github.com/vuejs/language-tools/releases" target="_blank">
					<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="vertical-align: middle;">
						<path
							d="M21 10.975V8a2 2 0 00-2-2h-6V4.688c.305-.274.5-.668.5-1.11a1.5 1.5 0 00-3 0c0 .442.195.836.5 1.11V6H5a2 2 0 00-2 2v2.998l-.072.005A.999.999 0 002 12v2a1 1 0 001 1v5a2 2 0 002 2h14a2 2 0 002-2v-5a1 1 0 001-1v-1.975a1 1 0 00-.928-.997L21 10.975zm-5 5.025H8v-3h8v3z" />
					</svg>
					Releases
				</a>
				<a href="https://vuejs.org/" target="_blank">
					<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="vertical-align: middle;">
						<path
							d="M12.001 1.993C6.486 1.994 2 6.48 2 11.994c0 5.514 4.486 9.999 10 10 5.515 0 10.001-4.485 10.001-10s-4.486-10-10-10.001zM12 19.994c-4.412 0-8.001-3.589-8.001-8s3.589-8 8-8.001C16.411 3.994 20 7.583 20 11.994c0 4.41-3.589 8-8 8z" />
						<path
							d="M12.001 8.994l-4.005 4.005 1.414 1.414 2.591-2.591 2.591 2.591 1.414-1.414-4.005-4.005z" />
					</svg>
					Website
				</a>
				<a href="https://discord.gg/vue" target="_blank">
					<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="vertical-align: middle;">
						<path
							d="M19.27 5.33C17.94 4.71 16.5 4.26 15 4a.09.09 0 00-.07.03c-.18.33-.39.76-.53 1.09a16.09 16.09 0 00-4.8 0c-.14-.34-.35-.76-.54-1.09-.01-.02-.04-.03-.07-.03-1.5.26-2.93.71-4.27 1.33-.01 0-.02.01-.03.02-2.72 4.07-3.47 8.03-3.1 11.95 0 .02.01.04.03.05 1.8 1.32 3.53 2.12 5.24 2.65.03.01.06 0 .07-.02.4-.55.76-1.13 1.07-1.74.02-.04 0-.08-.04-.09-.57-.22-1.11-.48-1.64-.78-.04-.02-.04-.08-.01-.11.11-.08.22-.17.33-.25.02-.02.05-.02.07-.01 3.44 1.57 7.15 1.57 10.55 0 .02-.01.05-.01.07.01.11.09.22.17.33.26.04.03.04.09-.01.11-.52.31-1.07.56-1.64.78-.04.01-.05.06-.04.09.32.61.68 1.19 1.07 1.74.03.01.06.02.09.01 1.72-.53 3.45-1.33 5.25-2.65.02-.01.03-.03.03-.05.44-4.53-.73-8.46-3.1-11.95-.01-.01-.02-.02-.04-.02zM8.52 14.91c-.99 0-1.8-.9-1.8-2s.79-2.01 1.8-2.01c1 0 1.81.9 1.81 2.01-.01 1.1-.8 2-1.81 2zm6.96 0c-.99 0-1.8-.9-1.8-2s.79-2.01 1.8-2.01c1 0 1.81.9 1.81 2.01-.01 1.1-.8 2-1.81 2z" />
					</svg>
					Discord
				</a>
			</div>
		</div>
	</header>
	<hr>

	<h2> What's New in ${li}</h2>
	<div class="card whats-new-card">
		<ul style="margin: 0; padding-left: 1.25rem;">
			<li> Significantly improved Hybrid Mode stability</li>
			<li> Introduced several new DX enhancement features</li>
			<li> Expanded support for additional localizations</li>
			<li> UI tweaks: removed all Vue-related status bar items</li>
			<li> Squashed numerous bugs throughout the extension</li>
		</ul>
		<div
			style="margin-top: 1rem; padding: 0.75rem; background-color: var(--vscode-inputValidation-warningBackground); border-radius: 4px;">
			<strong> Deprecation Notice:</strong> Dropping Vue 2 Support in v3.1
			(<a href="https://github.com/vuejs/language-tools/discussions/5455" target="_blank">Discussion #5395</a>)
		</div>

		<div
			style="margin-top: 1.5rem; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
			<a href="https://github.com/vuejs/language-tools/releases/tag/v3.0.0" target="_blank"
				style="display: inline-flex; align-items: center; gap: 0.5rem; color: var(--vscode-textLink-foreground);">
				<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
					<path
						d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z" />
				</svg>
				Full Release Notes
			</a>
			<div style="display: flex; gap: 0.5rem; font-size: 0.9em; color: var(--vscode-descriptionForeground);">
				<span>Released: July 2025</span>
				<span></span>
				<span>v3.0.0</span>
			</div>
		</div>
	</div>

	<h2> Learn More Features</h2>
	<p>Discover advanced capabilities of the extension:</p>
	<div class="video-container">
		<a href="https://www.youtube.com/watch?v=RcPcO4_Ct_U" target="_blank">
			<iframe
				src="https://www.youtube.com/embed/RcPcO4_Ct_U"
				style="pointer-events: none;"
				frameborder="0"
				allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
				allowfullscreen
				onload="handleVideoSuccess()"
			></iframe>
		</a>
	</div>
	<p id="video-reminder" style="margin-top:0.5rem; text-align:center; color:var(--vscode-foreground);">
		 Unable to load the video? <a href="https://www.youtube.com/watch?v=RcPcO4_Ct_U">Watch on YouTube</a>
	</p>
	<script>
		function handleVideoSuccess() {
			const reminder = document.getElementById('video-reminder');
			if (reminder) reminder.style.display = 'none';
		}
	</script>

	<h2> Core Features</h2>
	<div class="features">
		<div class="feature">
			<div class="feature-icon"></div>
			<h3>Template Intelligence</h3>
			<p>Smart completions for directives, components and props in Vue templates with type inference</p>
		</div>
		<div class="feature">
			<div class="feature-icon"></div>
			<h3>Type Checking</h3>
			<p>Full TypeScript support with type inference across SFCs and reactive type checking</p>
		</div>
		<div class="feature">
			<div class="feature-icon"></div>
			<h3>Syntax Highlighting</h3>
			<p>Comprehensive syntax highlighting for Single File Components and template expressions</p>
		</div>
	</div>

	<h2> Premium Features</h2>
	<div class="features" style="grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); margin: 1.5rem 0;">
		<div class="feature">
			<div class="feature-icon"></div>
			<h4>Interpolation Highlight </h4>
			<p>Enhanced highlighting for template interpolations and expressions</p>
		</div>
		<div class="feature">
			<div class="feature-icon"></div>
			<h4>Focus Mode </h4>
			<p>Isolate and focus on specific SFC blocks during development</p>
		</div>
		<div class="feature">
			<div class="feature-icon"></div>
			<h4>Reactivity Visualization </h4>
			<p>Visualize Vue's reactivity system in component scripts</p>
		</div>
		<div class="feature">
			<div class="feature-icon"></div>
			<p>More Features Coming Soon</p>
		</div>
	</div>

	<div style="display: flex; flex-direction: column; align-items: center; gap: 1rem;">
		${i?`
				<p style="color: var(--vscode-textLink-foreground); text-align:center; font-weight:500; margin:1.5rem 0;">
					 Thank you for your support! All premium features are unlockedenjoy your enhanced Vue experience 
				</p>
			`:`
				<p>Support the development and unlock these features:</p>
				<a href="https://github.com/sponsors/johnsoncodehk" target="_blank"
					style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; background-color: var(--vscode-button-background); color: var(--vscode-button-foreground); border-radius: 4px; text-decoration: none;">
					<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
						<path fill-rule="evenodd" clip-rule="evenodd"
							d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" />
					</svg>
					GitHub Sponsors
				</a>
				<a href="https://afdian.com/a/johnsoncodehk" target="_blank"
					style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; background-color: var(--vscode-button-background); color: var(--vscode-button-foreground); border-radius: 4px; text-decoration: none;">
					<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
						<path
							d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.31-8.86c-1.77-.45-2.34-.94-2.34-1.67 0-.84.79-1.43 2.1-1.43 1.38 0 1.9.66 1.94 1.64h1.71c-.05-1.34-.87-2.57-2.49-2.97V5H10.9v1.69c-1.51.32-2.72 1.3-2.72 2.81 0 1.79 1.49 2.69 3.66 3.21 1.95.46 2.34 1.15 2.34 1.87 0 .53-.39 1.39-2.1 1.39-1.6 0-2.23-.72-2.32-1.64H8.04c.1 1.7 1.36 2.66 2.86 2.97V19h2.34v-1.67c1.52-.29 2.72-1.16 2.73-2.77-.01-2.2-1.9-2.96-3.66-3.42z" />
					</svg>
					 (afdian)
				</a>
				<button onclick="verifySponsor()"
					style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.5rem 1rem; background-color: var(--vscode-button-secondaryBackground); color: var(--vscode-button-secondaryForeground); border: none; border-radius: 4px; cursor: pointer;">
					<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
						<path
							d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-1 6h2v2h-2V7zm0 4h2v6h-2v-6z" />
					</svg>
					Verify Sponsor Status
				</button>
			`}
	</div>

	<h2> Resources</h2>
	<ul>
		<li><a href="https://vuejs.org/guide/typescript/overview.html" target="_blank">Vue with TypeScript Guide</a> -
			Official documentation</li>
		<li><a href="https://vuejs.org/guide/scaling-up/tooling.html" target="_blank">Tooling Guide</a> - Recommended
			setup for Vue projects</li>
		<li><a href="https://github.com/vuejs/language-tools/discussions" target="_blank">Discussions</a> - Share ideas
			and get help</li>
	</ul>

	<h2> Troubleshooting</h2>
	<details>
		<summary>Why are some features not working?</summary>
		<div>
			<p>Make sure you have:</p>
			<ul>
				<li>The latest version of the extension installed</li>
				<li>Vue 3.x in your project dependencies</li>
				<li>TSDK 5.3 or later</li>
				<li>Try disabling other extensions to rule out conflicts</li>
			</ul>
		</div>
	</details>
	<details>
		<summary>Where to report issues?</summary>
		<div>
			<p>Please report any problems on our <a href="https://github.com/vuejs/language-tools/issues"
					target="_blank">GitHub Issues</a> page with:</p>
			<ul>
				<li>Detailed reproduction steps</li>
				<li>Screenshots or screencasts if applicable</li>
				<li>Your project setup information</li>
			</ul>
		</div>
	</details>

	<h2> Thanks to Our Sponsors</h2>
	<div class="card sponsors-card" style="text-align: center; padding: 1.5rem;">
		<p style="margin-top: 0;">This project is made possible thanks to our generous sponsors:</p>
		<div id="sponsors-container" style="max-width:100%;margin:0 auto;"></div>
		<script>
			fetch('https://cdn.jsdelivr.net/gh/johnsoncodehk/sponsors/sponsors.svg')
				.then(r => r.text())
				.then(svg => {
					const wrap = document.getElementById('sponsors-container');
					wrap.innerHTML = svg;
				})
				.catch(() => {
					document.getElementById('sponsors-container').textContent = 'Failed to load sponsors';
				});
		</script>
		<p style="margin-bottom: 0;">
			<a href="https://github.com/sponsors/johnsoncodehk" target="_blank">Become a sponsor</a> to support Vue
			tooling development
		</p>
	</div>
</body>

</html>`}function hi(e){if(!si&&$){si=!0;let t=Q.server.includeLanguages;$r(e,t,$),ai(e,t,$),ni(e,t,$)}pi()}async function gi(e,t){let r=await o();if(r>=200)return t&&n.window.showInformationMessage(`You are a lifetime sponsor! Thank you for your generous support `),!0;let i=await c();if(i>=3)return t&&n.window.showInformationMessage(`Thank you for sponsoring! Lifetime sponsorship requires a total of $200. You have sponsored $${r.toFixed(2)} so far.`),!0;let a=await s();if(a)return t&&n.window.showInformationMessage(`You have access to the volarjs/insiders repository! `),!0;return!1;async function o(){let t=`
			query {
				user(login: "${e.account.label}") {
					totalSponsorshipAmountAsSponsorInCents(sponsorableLogins: ["johnsoncodehk"]) { }
				}
			}
		`,n=await fetch(`https://api.github.com/graphql`,{method:`POST`,headers:{Authorization:`Bearer ${e.accessToken}`,"Content-Type":`application/json`,Accept:`application/vnd.github.v3+json`},body:JSON.stringify({query:t})}),r=await n.json();return(r.data?.user?.totalSponsorshipAmountAsSponsorInCents||0)*.01}async function s(){let t=`
			query {
				repository(name: "insiders", owner: "volarjs") {
					viewerPermission
				}
			}
		`,n=await fetch(`https://api.github.com/graphql`,{method:`POST`,headers:{Authorization:`Bearer ${e.accessToken}`,"Content-Type":`application/json`,Accept:`application/vnd.github.v3+json`},body:JSON.stringify({query:t})}),r=await n.json(),i=r.data.repository?.viewerPermission;return!!i&&i!==`NONE`}async function c(){let t=`
			query {
				user(login: "johnsoncodehk") {
					sponsorshipForViewerAsSponsor {
						tier {
							monthlyPriceInDollars
						}
					}
				}
			}
		`,n=await fetch(`https://api.github.com/graphql`,{method:`POST`,headers:{Authorization:`Bearer ${e.accessToken}`,"Content-Type":`application/json`,Accept:`application/vnd.github.v3+json`},body:JSON.stringify({query:t})}),r=await n.json();return r.data.user?.sponsorshipForViewerAsSponsor?.tier?.monthlyPriceInDollars||0}}async function _i(e,t){let r=`
		query {
			viewer {
				organizations(first: 100) {
					nodes {
						login
					}
				}
			}
		}
	`,i=await fetch(`https://api.github.com/graphql`,{method:`POST`,headers:{Authorization:`Bearer ${e.accessToken}`,"Content-Type":`application/json`,Accept:`application/vnd.github.v3+json`},body:JSON.stringify({query:r})});if(!i.ok)return!1;let a=await i.json(),o=a.data?.viewer?.organizations?.nodes.map(e=>e.login)??[];if(!o.length)return t&&n.window.showInformationMessage(`You are not a member of any organizations.`),!1;let s=await fetch(`https://raw.githubusercontent.com/johnsoncodehk/sponsors/refs/heads/master/members.json`).then(e=>e.json()).catch(()=>({})),c=[];for(let r of o){let i=s[r]??0;if(!i)continue;let a=[],o=`
			query {
				organization(login: "${r}") {
					team(slug: "vue-official-licensed") {
						members(first: 100) {
							nodes {
								login
							}
						}
					}
				}
			}
		`,l=await fetch(`https://api.github.com/graphql`,{method:`POST`,headers:{Authorization:`Bearer ${e.accessToken}`,"Content-Type":`application/json`,Accept:`application/vnd.github.v3+json`},body:JSON.stringify({query:o})});if(l.ok){let e=await l.json(),t=e.data?.organization?.team?.members?.nodes?.map(e=>e.login)??[];t.length>0&&(a=t)}if(a.length===0){let t=`
				query {
					organization(login: "${r}") {
						membersWithRole(first: 100) {
							nodes {
								login
							}
						}
					}
				}
			`,n=await fetch(`https://api.github.com/graphql`,{method:`POST`,headers:{Authorization:`Bearer ${e.accessToken}`,"Content-Type":`application/json`,Accept:`application/vnd.github.v3+json`},body:JSON.stringify({query:t})});if(n.ok){let e=await n.json();a=e.data?.organization?.membersWithRole?.nodes?.map(e=>e.login)??[]}}let u=a.indexOf(e.account.label);if(u===-1)continue;if(u<i)return t&&n.window.showInformationMessage(`You are a member of the sponsoring organization "${r}"! `),!0;c.push(r)}return t&&(c.length?n.window.showWarningMessage(`The number of ${c.map(e=>`"${e}"`)} members exceeds the current sponsorship plan. Please contact your organization to upgrade the sponsorship plan or set up a whitelist.`):n.window.showInformationMessage(`You are not a member of any sponsoring organizations. If your organization just started sponsoring, please wait up to 30 minutes for synchronization to complete.`)),!1}function vi(e){return new Promise((t,r)=>{(async()=>{let i=await Si(4e3),a=`http://localhost:${i}/callback`,o=await n.env.openExternal(n.Uri.parse(`https://afdian.com/oauth2/authorize?response_type=code&scope=basic&client_id=vuejs&redirect_uri=${encodeURIComponent(a)}`));if(!o){t(void 0);return}let s=(await import(`http`)).createServer(async(e,n)=>{if(e.url?.startsWith(`/callback`)){let o=new URL(e.url,`http://localhost:${i}`),c=o.searchParams.get(`code`);if(c){let e=await xi(c,a);e&&await yi(e,!0)?(n.writeHead(200,{"Content-Type":`text/html`}),n.end(`
								<!DOCTYPE html>
								<html>
								<head><title>Open VSCode</title></head>
								<body>
								<script>
								window.location.href = 'vscode:'; 
								setTimeout(() => {
									window.location.href = 'https://afdian.com/a/johnsoncodehk/thank';
								}, 2000);
								</script>
								<p>Trying to open VS Code...</p>
								</body>
								</html>
							`),t(e)):(n.writeHead(200,{"Content-Type":`text/html`}),n.end(`
								<!DOCTYPE html>
								<html>
								<head><title>Open AFDIAN</title></head>
								<body>
								<script>
								window.location.href = 'https://afdian.com/a/johnsoncodehk/plan';
								</script>
								<p>Redirecting to AFDIAN...</p>
								</body>
								</html>
							`),t(void 0))}else r(Error(`No code found in the callback URL.`)),n.writeHead(400,{"Content-Type":`text/plain`}),n.end(`No code found in the callback URL.`);s&&(s.close(),console.log(`Server closed on http://localhost:${i}`))}else n.writeHead(404),n.end()});s.listen(i,()=>{console.log(`Server listening on http://localhost:${i}`)}),e.onCancellationRequested(()=>{s.close(),console.log(`AFDIAN callback server cancelled on http://localhost:${i}`),t(void 0)})})()})}async function yi(e,t){let r=1;for(let i=1;i<=r;i++){let a=await bi(i);if(!a)return!1;if(`explain`in a)return n.window.showErrorMessage(`AFDIAN API Error: ${a.explain}`),!1;let{list:o,total_page:s}=a;r=s;let c=o.find(t=>t.user.user_id===e);if(!c)continue;let l=parseFloat(c.all_sum_amount||`0`);if(l>=1200)return t&&n.window.showInformationMessage(` `),!0;let u=parseFloat(c.current_plan?.price||`0`);if(u>=20)return t&&n.window.showInformationMessage(` 1200  ${l.toFixed(2)} `),!0}return!1}async function bi(e){let t=await import(`node:crypto`),n=e=>t.createHash(`md5`).update(e).digest(`hex`),r=new URL(`https://afdian.com/api/open/query-sponsor`);r.searchParams.set(`params`,`{"page":${e},"per_page":100}`),r.searchParams.set(`ts`,(Date.now()*.001|0).toString()),r.searchParams.set(`user_id`,`d9da8e2a4d3c11eebadc52540025c377`),r.searchParams.set(`sign`,n(`JW7qE3fguYBjkTSP8MDx46dhnGrpAyKQparams${r.searchParams.get(`params`)}ts${r.searchParams.get(`ts`)}user_id${r.searchParams.get(`user_id`)}`));let i=await fetch(r.toString());if(!i.ok)return;let a=await i.json();return a.data}async function xi(e,t){let n=await fetch(`https://afdian.com/api/oauth2/access_token`,{method:`POST`,headers:{"Content-Type":`application/x-www-form-urlencoded`},body:new URLSearchParams({client_id:`vuejs`,client_secret:`ZDlkYThlMmE0ZDNjMTFlZWJhZGM1MjU0MDAyNWMzNzdfdnVlanM=`,code:e,grant_type:`authorization_code`,redirect_uri:t}).toString()});if(!n.ok)return;let r=await n.json();return r.data?.user_id}function Si(e){return new Promise((t,n)=>{(async()=>{let r=await import(`node:net`),i=r.createServer();i.once(`error`,r=>{r.code===`EADDRINUSE`?(i.close(),t(Si(e+1))):(i.close(),n(r))}),i.once(`listening`,()=>{i.close(()=>{t(e)})}),i.listen(e)})()})}function Ci(e){let t=n.Uri.joinPath(e.extensionUri,`dist`,`language-server.js`),r=new ui(`vue`,`Vue`,{run:{module:t.fsPath,transport:Ge.TransportKind.ipc,options:{}},debug:{module:t.fsPath,transport:Ge.TransportKind.ipc,options:{execArgv:[`--nolazy`,`--inspect=6009`]}}},{middleware:{...He.middleware,async resolveCodeAction(e,t,r){if(e.kind?.value===`refactor.move.newFile.dumb`&&Q.codeActions.askNewComponentName){let t=await n.window.showInputBox({value:e.data.original.data.newName});if(!t)return e;e.data.original.data.newName=t}return await(He.middleware.resolveCodeAction?.(e,t,r)??r(e,t))}},documentSelector:Q.server.includeLanguages,markdown:{isTrusted:!0,supportHtml:!0},outputChannel:Ir(`Vue Language Server`)});return r.onNotification(`tsserver/request`,async([e,t,i])=>{let a=await n.commands.executeCommand(`typescript.tsserverRequest`,t,i,{isAsync:!0,lowPriority:!0});r.sendNotification(`tsserver/response`,[e,a?.body])}),r.start(),r}try{let e=require(`node:fs`),t=n.extensions.getExtension(`vscode.typescript-language-features`),r=e.readFileSync,i=require.resolve(`./dist/extension.js`,{paths:[t.extensionPath]});e.readFileSync=(...e)=>{if(e[0]===i){let t=r(...e);return t=t.replace(`languages:Array.isArray(e.languages)`,[`languages:`,`e.name==='vue-typescript-plugin-pack'?[${Q.server.includeLanguages.map(e=>`'${e}'`).join(`,`)}]`,`:Array.isArray(e.languages)`].join(``)),t=t.replace(`t.jsTsLanguageModes=[t.javascript,t.javascriptreact,t.typescript,t.typescriptreact]`,e=>e+`.concat("vue")`),t=t.replace(`.languages.match([t.typescript,t.typescriptreact,t.javascript,t.javascriptreact]`,e=>e+`.concat("vue")`),t}return r(...e)};let a=require.cache[i];if(a){delete require.cache[i];let e=require(i);Object.assign(a.exports,e)}t.isActive&&n.commands.executeCommand(`workbench.action.restartExtensionHost`)}catch{}exports.activate=di,exports.deactivate=fi;