"use strict";const e=require(`./path-browserify-BWikazpY.js`),t=require(`./language-core-DJrGDxYt.js`);var n=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.makeGetExternalFiles=exports.decoratedLanguageServiceHosts=exports.decoratedLanguageServices=exports.projectExternalFileExtensions=exports.externalFiles=void 0,exports.makeGetScriptInfoWithLargeFileFailsafe=a,exports.createLanguageCommon=o,exports.isHasAlreadyDecoratedLanguageService=l;let n=t.require_language_core$1(),r=t.require_common(),i=t.require_decorateLanguageServiceHost();exports.externalFiles=new WeakMap,exports.projectExternalFileExtensions=new WeakMap,exports.decoratedLanguageServices=new WeakSet,exports.decoratedLanguageServiceHosts=new WeakSet;function a(e){return t=>{try{return e.project.getScriptInfo(t)}catch{}}}function o(e,t,o,s){let c=o.languageServiceHost.getScriptSnapshot.bind(o.languageServiceHost),l=a(o),u=(0,n.createLanguage)([...e.languagePlugins,{getLanguageId:r.resolveFileLanguageId}],new n.FileMap(t.sys.useCaseSensitiveFileNames),(e,t,n)=>{let r;n?r=c(e):(r=l(e)?.getSnapshot(),r||(o.project.getScriptVersion(e),r=l(e)?.getSnapshot())),r?u.scripts.set(e,r):u.scripts.delete(e)},e=>{o.session.change({file:e,line:1,offset:1,endLine:1,endOffset:1,insertString:``})});s(u),(0,i.decorateLanguageServiceHost)(t,u,o.languageServiceHost),e.setup?.(u)}let s=t=>(n,r=0)=>{if(r>=1||!exports.externalFiles.has(n)){let r=exports.externalFiles.get(n),a=exports.projectExternalFileExtensions.get(n),o=a?.length?(0,i.searchExternalFiles)(t,n,a):[];exports.externalFiles.set(n,o),r&&!c(r,o)&&n.refreshDiagnostics()}return exports.externalFiles.get(n)};exports.makeGetExternalFiles=s;function c(e,t){if(e.length!==t.length)return!1;let n=new Set(e);for(let e of t)if(!n.has(e))return!1;return!0}function l(t){return exports.decoratedLanguageServices.has(t.languageService)||exports.decoratedLanguageServiceHosts.has(t.languageServiceHost)?!0:(exports.decoratedLanguageServices.add(t.languageService),exports.decoratedLanguageServiceHosts.add(t.languageServiceHost),!1)}}),r=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.createLanguageServicePlugin=a;let r=t.require_proxyLanguageService(),i=n();function a(e){return t=>{let{typescript:n}=t,a={create(t){if(!(0,i.isHasAlreadyDecoratedLanguageService)(t)){let a=e(n,t),o=a.languagePlugins.map(e=>e.typescript?.extraFileExtensions.map(e=>`.`+e.extension)??[]).flat();i.projectExternalFileExtensions.set(t.project,o);let{proxy:s,initialize:c}=(0,r.createProxyLanguageService)(t.languageService);t.languageService=s,(0,i.createLanguageCommon)(a,n,t,c)}return t.languageService},getExternalFiles:(0,i.makeGetExternalFiles)(n)};return a}}}),i=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getComponentType=a,exports.getSelfComponentName=o,exports.getVariableType=s;let r=t.require_shared(),i=e.require_path_browserify();function a(e,t,n,i,a,c){let l=t.getProgram(),u=l.getTypeChecker(),d=c.split(`.`),f=i.type.getProperty(d[0])??i.type.getProperty((0,r.camelize)(d[0]))??i.type.getProperty((0,r.capitalize)((0,r.camelize)(d[0]))),p;if(f){p=u.getTypeOfSymbolAtLocation(f,i.node);for(let e=1;e<d.length;e++)f=p.getProperty(d[e]),f&&(p=u.getTypeOfSymbolAtLocation(f,i.node))}else{let i=o(a);i===(0,r.capitalize)((0,r.camelize)(c))&&(p=s(e,t,n,`__VLS_self`)?.type)}return p}function o(e){let t=i.basename(e);return(0,r.capitalize)((0,r.camelize)(t.slice(0,t.lastIndexOf(`.`))))}function s(e,t,n,r){let i=t.getProgram(),a=i.getSourceFile(n.fileName);if(a){let t=i.getTypeChecker(),n=c(e,a,r);if(n)return{node:n,type:t.getTypeAtLocation(n)}}}function c(e,t,n){let r;return i(t),r;function i(t){r||(e.isVariableDeclaration(t)&&t.name.getText()===n?r=t:t.forEachChild(i))}}}),a=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getComponentNames=a,exports._getComponentNames=o;let n=t.require_language_core(),r=i();function a(e){let{typescript:t,language:r,languageService:i,asScriptId:a}=this,s=r.scripts.get(a(e));if(!(s?.generated?.root instanceof n.VueVirtualCode))return;let c=s.generated.root;return o(t,i,c)}function o(e,t,n){let i=(0,r.getVariableType)(e,t,n,`__VLS_components`)?.type?.getProperties().map(e=>e.name).filter(e=>!e.includes(`$`)&&!e.startsWith(`_`))??[];return i.push((0,r.getSelfComponentName)(n.fileName)),i}}),o=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getElementNames=a,exports._getElementNames=o;let n=t.require_language_core(),r=i();function a(e){let{typescript:t,language:r,languageService:i,asScriptId:a}=this,s=r.scripts.get(a(e));if(!(s?.generated?.root instanceof n.VueVirtualCode))return;let c=s.generated.root;return o(t,i,c)}function o(e,t,n){return(0,r.getVariableType)(e,t,n,`__VLS_elements`)?.type?.getProperties().map(e=>e.name)??[]}}),s=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.createVueLanguageServiceProxy=l;let n=t.require_language_core(),r=t.require_shared(),i=a(),s=o(),c=/\\/g;function l(e,t,n,r,i){let a=new Map,o=(a,o)=>{switch(o){case`getCompletionsAtPosition`:return u(e,t,r,i,a[o]);case`getCompletionEntryDetails`:return d(t,i,a[o]);case`getCodeFixesAtPosition`:return f(a[o]);case`getDefinitionAndBoundSpan`:return p(e,t,n,r,i,a[o]);case`getEncodedSemanticClassifications`:return m(e,t,a,i,a[o])}};return new Proxy(n,{get(e,t,n){if(o){a.has(t)||a.set(t,o(e,t));let n=a.get(t);if(n)return n}return Reflect.get(e,t,n)},set(e,t,n,r){return Reflect.set(e,t,n,r)}})}function u(e,t,i,a,o){return(s,l,u,d)=>{let f=s.replace(c,`/`),p=o(f,l,u,d);if(p){p.entries=p.entries.filter(e=>!e.name.includes(`__VLS_`)&&!e.labelDetails?.description?.includes(`__VLS_`));let o=t.scripts.get(a(f)),s=o?.generated?.root;if(s instanceof n.VueVirtualCode){let t=[s.sfc.template,...s.sfc.styles],n=t.filter(Boolean).map(e=>[e.startTagEnd,e.endTagStart]);if(n.some(([e,t])=>l>=e&&l<=t)){let t=e.Completions.SortText.GlobalsOrKeywords,n=new Set([t,`z`+t,t+`1`]);p.entries=p.entries.filter(e=>!(e.kind===`const`&&e.name in i.macros)&&(e.kind!==`var`&&e.kind!==`function`||!n.has(e.sortText)||(0,r.isGloballyAllowed)(e.name)))}}for(let e of p.entries)if(e.source){let t=e.name;for(let n of i.extensions){let i=(0,r.capitalize)(n.slice(1));if(e.source.endsWith(n)&&e.name.endsWith(i)){e.name=(0,r.capitalize)(e.name.slice(0,-i.length)),e.insertText&&=e.insertText.replace(`${i}$1`,`$1`),e.data&&(e.data.__isComponentAutoImport={ext:n,suffix:i,originalName:t,newName:e.insertText});break}}e.data&&(e.data.__isAutoImport={fileName:f})}}return p}}function d(e,t,r){return(...i)=>{let a=r(...i);if(i[6]?.__isComponentAutoImport){let{originalName:e,newName:t}=i[6].__isComponentAutoImport;for(let n of a?.codeActions??[])for(let r of n.changes)for(let n of r.textChanges)n.newText=n.newText.replace(`import `+e+` from `,`import `+t+` from `)}if(i[6]?.__isAutoImport){let{fileName:r}=i[6].__isAutoImport,o=e.scripts.get(t(r));if(o?.generated?.root instanceof n.VueVirtualCode){let e=o.generated.root.vueSfc;if(!e?.descriptor.script&&!e?.descriptor.scriptSetup)for(let e of a?.codeActions??[]){for(let t of e.changes){for(let e of t.textChanges){e.newText=`<script setup lang="ts">${e.newText}</script>\n\n`;break}break}break}}}return a}}function f(e){return(...t)=>{let n=e(...t);return n=n.filter(e=>!e.description.includes(`__VLS_`)),n}}function p(e,t,r,i,a,o){return(s,c)=>{let l=o(s,c);if(!l?.definitions?.length)return l;let u=r.getProgram(),d=t.scripts.get(a(s));if(!d?.generated)return l;let f=d.generated.root;if(!(f instanceof n.VueVirtualCode)||!f.sfc.template||c<f.sfc.template.startTagEnd||c>f.sfc.template.endTagStart)return l;let p=new Set(l.definitions),m=[];if(l.definitions.length>=2)for(let e of l.definitions)(f.sfc.content[e.textSpan.start-1]===`@`||f.sfc.content.slice(e.textSpan.start-5,e.textSpan.start)===`v-on:`)&&m.push(e);for(let e of l.definitions){if(i.extensions.some(t=>e.fileName.endsWith(t)))continue;let t=u.getSourceFile(e.fileName);if(!t)continue;h(t,e,t)}for(let e of m)p.delete(e);return{definitions:[...p],textSpan:l.textSpan};function h(t,n,r){e.isPropertySignature(t)&&t.type||e.isVariableDeclaration(t)&&e.isIdentifier(t.name)&&t.type&&!t.initializer?g(t.name,t.type,n,r):e.forEachChild(t,e=>h(e,n,r))}function g(t,n,r,i){let{textSpan:a,fileName:s}=r,c=t.getStart(i),l=t.getEnd();if(c!==a.start||l-c!==a.length||!e.isIndexedAccessTypeNode(n))return;let u=n.indexType.getStart(i),d=o(s,u);if(d?.definitions?.length){for(let e of d.definitions)p.add(e);m.push(r)}}}}function m(e,t,r,i,a){return(o,s,l)=>{let u=o.replace(c,`/`),d=a(u,s,l),f=t.scripts.get(i(u)),p=f?.generated?.root;if(p instanceof n.VueVirtualCode){let{template:t}=p.sfc;if(t)for(let n of h.call({typescript:e,languageService:r},p,t,{start:s.start-t.startTagEnd,length:s.length}))d.spans.push(n.start+t.startTagEnd,n.length,256)}return d}}function h(e,t,r){let{typescript:a,languageService:o}=this,c=[],l=(0,i._getComponentNames)(a,o,e),u=new Set((0,s._getElementNames)(a,o,e)),d=new Set([...l,...l.map(n.hyphenateTag)]);if(t.ast)for(let e of(0,n.forEachElementNode)(t.ast)){if(e.loc.end.offset<=r.start||e.loc.start.offset>=r.start+r.length)continue;if(d.has(e.tag)&&!u.has(e.tag)){let n=e.loc.start.offset;t.lang===`html`&&(n+=1),c.push({start:n,length:e.tag.length}),t.lang===`html`&&!e.isSelfClosing&&c.push({start:e.loc.start.offset+e.loc.source.lastIndexOf(e.tag),length:e.tag.length})}}return c}}),c=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.collectExtractProps=r;let n=t.require_language_core();function r(e,t){let{typescript:r,languageService:i,language:a,isTsPlugin:o,asScriptId:s}=this,c=a.scripts.get(s(e));if(!c?.generated)return;let l=c.generated.root;if(!(l instanceof n.VueVirtualCode))return;let u=new Map,d=i.getProgram(),f=d.getSourceFile(e),p=d.getTypeChecker(),m=c.generated?.languagePlugin.typescript?.getServiceScript(l),h=m?[...a.maps.forEach(m.code)].map(([e,t])=>t):[],{sfc:g}=l;return f.forEachChild(function e(i){if(r.isPropertyAccessExpression(i)&&r.isIdentifier(i.expression)&&i.expression.text===`__VLS_ctx`&&r.isIdentifier(i.name)){let{name:e}=i;for(let a of h){let s=!1;for(let l of a.toSourceLocation(e.getEnd()-(o?c.snapshot.getLength():0)))if(l[0]>=g.template.startTagEnd+t[0]&&l[0]<=g.template.startTagEnd+t[1]&&(0,n.isSemanticTokensEnabled)(l[1].data)){if(s=!0,!u.has(e.text)){let t=p.getTypeAtLocation(i),n=p.typeToString(t,i,r.TypeFormatFlags.NoTruncation);u.set(e.text,{name:e.text,type:n.includes(`__VLS_`)?`any`:n,model:!1})}let t=r.isPostfixUnaryExpression(i.parent)||r.isBinaryExpression(i.parent);t&&(u.get(e.text).model=!0);break}if(s)break}}i.forEachChild(e)}),[...u.values()]}}),l=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getComponentDirectives=o;let n=t.require_language_core(),r=i(),a=new Set([`vBind`,`vIf`,`vOn`,`vOnce`,`vShow`,`vSlot`]);function o(e){let{typescript:t,language:i,languageService:o,asScriptId:s}=this,c=i.scripts.get(s(e));if(!(c?.generated?.root instanceof n.VueVirtualCode))return;let l=c.generated.root,u=(0,r.getVariableType)(t,o,l,`__VLS_directives`);return u?u.type.getProperties().map(({name:e})=>e).filter(e=>e.startsWith(`v`)&&e.length>=2&&e[1]===e[1].toUpperCase()).filter(e=>!a.has(e)):[]}}),u=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getComponentEvents=a;let n=t.require_language_core(),r=i();function a(e,t){let{typescript:i,language:a,languageService:o,asScriptId:s}=this,c=a.scripts.get(s(e));if(!(c?.generated?.root instanceof n.VueVirtualCode))return;let l=c.generated.root,u=o.getProgram(),d=u.getTypeChecker(),f=(0,r.getVariableType)(i,o,l,`__VLS_components`);if(!f)return[];let p=(0,r.getComponentType)(i,o,l,f,e,t);if(!p)return[];let m=new Set;for(let e of p.getConstructSignatures()){let t=e.getReturnType(),n=t.getProperty(`$emit`);if(n){let e=d.getTypeOfSymbolAtLocation(n,f.node);for(let t of e.getCallSignatures()){let e=t.parameters[0];if(e){let t=d.getTypeOfSymbolAtLocation(e,f.node);t.isStringLiteral()&&m.add(t.value)}}}}return[...m]}}),d=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getComponentProps=a;let n=t.require_language_core(),r=i();function a(e,t){let{typescript:i,language:a,languageService:s,asScriptId:c}=this,l=a.scripts.get(c(e));if(!(l?.generated?.root instanceof n.VueVirtualCode))return;let u=l.generated.root,d=(0,r.getVariableType)(i,s,u,`__VLS_components`);if(!d)return[];let f=(0,r.getComponentType)(i,s,u,d,e,t);if(!f)return[];let p=new Map,m=s.getProgram(),h=m.getTypeChecker();for(let e of f.getCallSignatures()){let t=e.parameters[0];if(t){let e=h.getTypeOfSymbolAtLocation(t,d.node),n=e.getProperties();for(let e of n)g(e)}}for(let e of f.getConstructSignatures()){let t=e.getReturnType(),n=t.getProperty(`$props`);if(n){let e=h.getTypeOfSymbolAtLocation(n,d.node),t=e.getProperties();for(let e of t)g(e)}}return[...p.values()];function g(e){if(e.flags&i.SymbolFlags.Method)return;let t=e.name,n=!(e.flags&i.SymbolFlags.Optional)||void 0,{content:r,deprecated:a}=o(e.getDocumentationComment(h),e.getJsDocTags()),s=[],c=h.getTypeOfSymbol(e),l=c.types;if(l)for(let e of l){let t=e.value;t&&s.push(t)}let u;for(let{parent:t}of h.getRootSymbols(e).flatMap(e=>e.declarations??[])){if(!i.isInterfaceDeclaration(t))continue;let{text:e}=t.name;if(e.endsWith(`HTMLAttributes`)||e===`AriaAttributes`||e===`SVGAttributes`){u=!0;break}}p.set(t,{name:t,required:n,deprecated:a,isAttribute:u,commentMarkdown:r,values:s})}}function o(e,t){let n=s(e),r=c(t),i=[n,r].filter(e=>!!e).join(`

`),a=t.some(e=>e.name===`deprecated`);return{content:i,deprecated:a}}function s(e){return e.map(e=>{switch(e.kind){case`keyword`:return`\`${e.text}\``;case`functionName`:return`**${e.text}**`;default:return e.text}}).join(``)}function c(e){return e.map(e=>{let t=`*@${e.name}*`,n=e.text?.map(e=>e.kind===`parameterName`?`\`${e.text}\``:e.text).join(``)||``;return`${t} ${n}`}).join(`

`)}}),f=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getElementAttrs=a;let n=t.require_language_core(),r=i();function a(e,t){let{typescript:i,language:a,languageService:o,asScriptId:s}=this,c=a.scripts.get(s(e));if(!(c?.generated?.root instanceof n.VueVirtualCode))return;let l=c.generated.root,u=o.getProgram(),d=u.getTypeChecker(),f=(0,r.getVariableType)(i,o,l,`__VLS_elements`);if(!f)return[];let p=f.type.getProperty(t);if(!p)return[];let m=d.getTypeOfSymbol(p).getProperties();return m.map(e=>e.name)}}),p=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getImportPathForFile=t;function t(e,t,n){let{typescript:r,languageService:i,languageServiceHost:a}=this,o=i.getProgram(),s=o?.getSourceFile(t),c=o?.getSourceFile(e);if(!o||!c||!s)return;let l=r.moduleSpecifiers.getModuleSpecifiersWithCacheInfo,u=r.createModuleSpecifierResolutionHost(o,a),d=l(s.symbol,o.getTypeChecker(),a.getCompilationSettings(),c,u,n);for(let e of d.moduleSpecifiers)return e}}),m=e.__commonJSMin(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getPropertiesAtLocation=r;let n=t.require_language_core();function r(e,t){let{languageService:r,language:i,typescript:a,isTsPlugin:o,asScriptId:s}=this,c=i.scripts.get(s(e));if(c?.generated){let e=c.generated.languagePlugin.typescript?.getServiceScript(c.generated.root);if(!e)return;let r=!1;for(let[a,o]of i.maps.forEach(e.code)){for(let[e,i]of o.toGeneratedLocation(t))if((0,n.isCompletionEnabled)(i.data)){t=e,r=!0;break}if(r)break}if(!r)return;o&&(t+=c.snapshot.getLength())}let l=r.getProgram(),u=l.getSourceFile(e);if(!u)return;let d=h(u,u,t);if(!d)return;let f=l.getTypeChecker(),p=f.getTypeAtLocation(d),m=p.getProperties();return m.map(e=>e.name);function h(e,t,n){let r;return t.forEachChild(t=>{r||(t.end===n&&a.isIdentifier(t)?r=t:t.end>=n&&t.getStart(e)<n&&(r=h(e,t,n)))}),r}}});const h=r(),g=t.require_language_core(),_=s(),v=c(),y=l(),b=u(),x=a(),S=d(),C=f(),w=o(),T=p(),E=m(),D=/\\/g,O=new WeakMap;module.exports=(0,h.createLanguageServicePlugin)((e,t)=>{let n=i(),r=g.createVueLanguagePlugin(e,t.languageServiceHost.getCompilationSettings(),n,e=>e);return a(),{languagePlugins:[r],setup:r=>{O.set(t.project,[r,t.languageServiceHost,t.languageService]),t.languageService=(0,_.createVueLanguageServiceProxy)(e,r,t.languageService,n,e=>e);let i=setInterval(()=>{t.project.program&&(clearInterval(i),t.project.program.__vue__={language:r})},50)}};function i(){if(t.project.projectKind===e.server.ProjectKind.Configured){let n=t.project.getProjectName();return g.createParsedCommandLine(e,e.sys,n.replace(D,`/`)).vueOptions}else return g.createParsedCommandLineByJson(e,e.sys,t.languageServiceHost.getCurrentDirectory(),{}).vueOptions}function a(){let e=t.project.projectService;e.logger.info(`Vue: called handler processing `+t.project.projectKind);let n=t.session;if(n==null){e.logger.info(`Vue: there is no session in info.`);return}if(n.addProtocolHandler==null){e.logger.info(`Vue: there is no addProtocolHandler method.`);return}n.handlers.has(`_vue:projectInfo`)||(n.addProtocolHandler(`_vue:projectInfo`,({arguments:e})=>n.handlers.get(`projectInfo`)?.({arguments:e})),n.addProtocolHandler(`_vue:documentHighlights-full`,({arguments:e})=>n.handlers.get(`documentHighlights-full`)?.({arguments:e})),n.addProtocolHandler(`_vue:quickinfo`,({arguments:e})=>n.handlers.get(`quickinfo`)?.({arguments:e})),n.addProtocolHandler(`_vue:collectExtractProps`,({arguments:e})=>({response:v.collectExtractProps.apply(o(e[0]),e)})),n.addProtocolHandler(`_vue:getImportPathForFile`,({arguments:e})=>({response:T.getImportPathForFile.apply(o(e[0]),e)})),n.addProtocolHandler(`_vue:getPropertiesAtLocation`,({arguments:e})=>({response:E.getPropertiesAtLocation.apply(o(e[0]),e)})),n.addProtocolHandler(`_vue:getComponentNames`,({arguments:e})=>({response:x.getComponentNames.apply(o(e[0]),e)??[]})),n.addProtocolHandler(`_vue:getComponentProps`,({arguments:e})=>({response:S.getComponentProps.apply(o(e[0]),e)})),n.addProtocolHandler(`_vue:getComponentEvents`,({arguments:e})=>({response:b.getComponentEvents.apply(o(e[0]),e)})),n.addProtocolHandler(`_vue:getComponentDirectives`,({arguments:e})=>({response:y.getComponentDirectives.apply(o(e[0]),e)})),n.addProtocolHandler(`_vue:getElementAttrs`,({arguments:e})=>({response:C.getElementAttrs.apply(o(e[0]),e)})),n.addProtocolHandler(`_vue:getElementNames`,({arguments:e})=>({response:w.getElementNames.apply(o(e[0]),e)})),e.logger.info(`Vue specific commands are successfully added.`))}function o(n){let r=t.session.getFileAndProject({file:n,projectFileName:void 0}),i=O.get(r.project);if(!i)throw`No RequestContext`;return{typescript:e,languageService:i[2],languageServiceHost:i[1],language:i[0],isTsPlugin:!0,asScriptId:e=>e}}});