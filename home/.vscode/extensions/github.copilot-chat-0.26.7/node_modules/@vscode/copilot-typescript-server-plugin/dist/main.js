"use strict";var Xt=Object.create;var Fe=Object.defineProperty;var Zt=Object.getOwnPropertyDescriptor;var en=Object.getOwnPropertyNames;var tn=Object.getPrototypeOf,nn=Object.prototype.hasOwnProperty;var V=(c,e)=>()=>(c&&(e=c(c=0)),e);var on=(c,e)=>()=>(e||c((e={exports:{}}).exports,e),e.exports),rn=(c,e)=>{for(var t in e)Fe(c,t,{get:e[t],enumerable:!0})},At=(c,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of en(e))!nn.call(c,o)&&o!==t&&Fe(c,o,{get:()=>e[o],enumerable:!(i=Zt(e,o))||i.enumerable});return c};var X=(c,e,t)=>(t=c!=null?Xt(tn(c)):{},At(e||!c||!c.__esModule?Fe(t,"default",{value:c,enumerable:!0}):t,c)),sn=c=>At(Fe({},"__esModule",{value:!0}),c);function Ze(){if(Xe===void 0)throw new Error("tsserverlibrary not loaded yet");return Xe}var Xe,A,J=V(()=>{"use strict";(e=>{function c(t){Xe=t}e.install=c})(Ze||={});A=Ze});var an,dn,et,tt,nt,it,ot,G,ye,ln,z=V(()=>{"use strict";(e=>{function c(t){return t.cache!==void 0}e.has=c})(an||={});(e=>{function c(t,i){return{key:t,sizeInChars:i}}e.create=c})(dn||={});(e=>{function c(t,i){return{kind:"metaData",completionContext:t,path:i}}e.create=c})(et||={});(e=>{function c(t,i){return{kind:"errorData",code:t,message:i}}e.create=c})(tt||={});(e=>{function c(t,i){return{kind:"timings",totalTime:t,computeTime:i}}e.create=c})(nt||={});(e=>{function c(t){return{kind:"cachedItem",key:t}}e.create=c})(it||={});(e=>{function c(t,i){return{kind:"computationState",key:t,scope:i}}e.create=c})(ot||={});(i=>{function c(o,r,l,a,p){if(p===void 0)return{kind:"trait",traitKind:o,priority:r,name:l,value:a};{let u={key:t(o),scope:{kind:"file"}};return{kind:"trait",traitKind:o,priority:r,name:l,value:a,cache:u}}}i.create=c;function e(o){return o.name.length+o.value.length}i.sizeInChars=e;function t(o){return JSON.stringify({k:"trait",tk:o},void 0,0)}i.makeContextItemKey=t})(G||={});(t=>{function c(i,o,r,l,a,p){return{kind:"snippet",snippetKind:l,uri:i,additionalUris:o,value:r,priority:a??0,cache:p}}t.create=c;function e(i){let o=i.value.length;if(o+=i.uri.length+3,i.additionalUris!==void 0)for(let r of i.additionalUris)o+=r.length+3;return o}t.sizeInChars=e})(ye||={});(i=>{function c(o){return o.type==="cancelled"}i.isCancelled=c;function e(o){return o.type==="response"&&o.body.items!==void 0}i.isOk=e;function t(o){return o.type==="response"&&o.body.error!==void 0}i.isError=t})(ln||={})});var Z=on((gn,Rt)=>{"use strict";J();var n=A(),rt=function*(){}(),Nt;(_=>{let c=n;_.getTokenAtPosition=c.getTokenAtPosition,_.getTouchingToken=c.getTouchingToken,_.getNameTable=c.getNameTable,_.findReferencedSymbols=c.findReferencedSymbols,_.getSymbolId=c.getSymbolId;function l(F,s){let d=_.getTokenAtPosition(F,s);if(d.kind===n.SyntaxKind.EndOfFileToken){let y=d,m=s;for(;y.kind===n.SyntaxKind.EndOfFileToken&&m>0;)y=_.getTokenAtPosition(F,--m);return y.kind===n.SyntaxKind.EndOfFileToken?{token:d}:{previous:y,token:d}}let f={token:d},h=!0;if(s>d.getStart(F))f.touching=d,h=!1;else if(s<d.getStart(F)){let y=d.parent;for(;y!==void 0;){if(s>=y.getStart(F)){f.touching=y;break}y=y.parent}}if(h){let y=d;for(;y.parent;){let m=a(y.parent,F),g=p(m,y);if(g>0){let x=m[g-1],T=a(x,F);for(;T.length>0;){let K=T[T.length-1];if(K.kind===n.SyntaxKind.EndOfFileToken)break;x=K,T=a(x,F)}if(x.kind!==n.SyntaxKind.EndOfFileToken){f.previous=x;break}}y=y.parent}}return f}_.getRelevantTokens=l;function a(F,s){if(n.isSourceFile(F)){let d=F.getChildren(s);return d.length>0&&d[0].kind===n.SyntaxKind.SyntaxList?d[0].getChildren(s):F.statements}else return F.getChildren(s)}_.getChildren=a;function p(F,s){let d=0,f=F.length-1;for(;d<=f;){let h=Math.floor((d+f)/2),y=F[h].getStart(),m=s.getStart();if(y===m)return F[h]===s?h:-1;y<m?d=h+1:f=h-1}return-1}let u;(s=>{function F(d){let f=d.getCompilerOptions();if(typeof f.project=="string")return f.project;let h=f.configFilePath;return typeof h=="string"?h:void 0}s.getKey=F})(u=_.Programs||={});class S{cancellationToken;end;constructor(s,d,f,h=!1){this.cancellationToken=h?void 0:s,this.end=h?Number.MAX_VALUE:d+f}isCancellationRequested(){return this.cancellationToken&&this.cancellationToken.isCancellationRequested()?!0:Date.now()>this.end}isTimedOut(){return Date.now()>this.end}throwIfCancellationRequested(){if(this.isCancellationRequested())throw new n.OperationCanceledException}}_.CancellationTokenWithTimer=S;class b{isCancellationRequested(){return!1}throwIfCancellationRequested(){}}_.NullCancellationToken=b;let C;(d=>{function F(f){return f.symbol}d.getSymbol=F;function s(f){if(n.isTypeReferenceNode(f))return f.typeName.getText()}d.getTypeName=s})(C=_.Node||={});let v;(s=>{function F(d){return(n.getCombinedModifierFlags(d)&n.ModifierFlags.Private)!==0}s.isPrivate=F})(v=_.Declarations||={});let w;(h=>{let F;(m=>m[m.topLevel=0]="topLevel")(F=h.Mode||={});function s(y){let m=y.kind;return m===n.SyntaxKind.InterfaceDeclaration||m===n.SyntaxKind.ClassDeclaration}h.is=s;function d(y,m=0){return f(y.statements)}h.entries=d;function*f(y){for(let m of y)n.isClassDeclaration(m)||n.isInterfaceDeclaration(m)?yield m:n.isModuleDeclaration(m)&&m.body!==void 0&&n.isModuleBlock(m.body)&&(yield*f(m.body.statements))}})(w=_.TypeDeclarations||={});let U;(h=>{function F(y){let m=y.heritageClauses;if(m!==void 0)return m.find(g=>g.token===n.SyntaxKind.ExtendsKeyword)}h.getExtendsClause=F;function s(y){return d(y.statements)}h.entries=s;function*d(y){for(let m of y)n.isClassDeclaration(m)?yield m:n.isModuleDeclaration(m)&&m.body!==void 0&&n.isModuleBlock(m.body)&&(yield*d(m.body.statements))}function f(y){if(!k.isClass(y))return;let m=y.getDeclarations();if(m!==void 0){for(let g of m)if(n.isClassDeclaration(g))return g}}h.fromSymbol=f})(U=_.ClassDeclarations||={});let ae;(h=>{function F(y){return(y.flags&n.TypeFlags.Intersection)!==0}h.isIntersection=F;function s(y){return(y.flags&n.TypeFlags.Union)!==0}h.isUnion=s;function d(y){return y.getBaseTypes()}h.getBaseTypes=d;function f(y,m){let g=m.getSymbol();if(g===void 0)return;let x=g.getDeclarations();if(x===void 0)return;let T=[];for(let K of x)if(n.isClassDeclaration(K)){let P=K.heritageClauses;if(P!==void 0)for(let M of P)for(let ie of M.types)T.push(y.getTypeAtLocation(ie.expression))}return T}h.getExtendsTypes=f})(ae=_.Types||={});let Q;(d=>(d.depthFirst="depthFirst",d.breadthFirst="breadthFirst"))(Q=_.Traversal||={});let ve;(s=>s.breadthFirstOnly="breadthFirstOnly")(ve||={});class Ie{start;mode;symbols;constructor(s,d,f){this.start=s,this.mode=d,this.symbols=f}isValid(){return k.isClass(this.start)}isValidDeclaration(s){return n.isClassDeclaration(s)}*getDeclarations(s){yield*U.entries(s)}isSubType(s,d){return this.symbols.isSubClass(s,d)}with(s){return new Ie(s,this.mode,this.symbols)}}class ke{start;mode;symbols;constructor(s,d,f){this.start=s,this.mode=d,this.symbols=f}isValid(){return k.isClass(this.start)||k.isInterface(this.start)||k.isTypeAlias(this.start)}isValidDeclaration(s){return w.is(s)||n.isTypeAliasDeclaration(s)}*getDeclarations(s){yield*w.entries(s,0)}isSubType(s,d){return this.symbols.isSubType(s,d)}with(s){return new ke(s,this.mode,this.symbols)}}class k{program;typeChecker;constructor(s){this.program=s,this.typeChecker=s.getTypeChecker()}static Unknown="unknown";static Undefined="undefined";static None="none";static getParent(s){return s.parent}static isConstructor(s){return s!==void 0&&(s.getFlags()&n.SymbolFlags.Constructor)!==0}static isGetAccessor(s){return s!==void 0&&(s.getFlags()&n.SymbolFlags.GetAccessor)!==0}static isSetAccessor(s){return s!==void 0&&(s.getFlags()&n.SymbolFlags.SetAccessor)!==0}static isMethod(s){return s!==void 0&&(s.getFlags()&n.SymbolFlags.Method)!==0}static isProperty(s){return s!==void 0&&(s.getFlags()&n.SymbolFlags.Property)!==0}static isClass(s){return s!==void 0&&(s.getFlags()&n.SymbolFlags.Class)!==0}static isInterface(s){return s!==void 0&&(s.getFlags()&n.SymbolFlags.Interface)!==0}static isTypeAlias(s){return s!==void 0&&(s.getFlags()&n.SymbolFlags.TypeAlias)!==0}static isTypeLiteral(s){return s!==void 0&&(s.getFlags()&n.SymbolFlags.TypeLiteral)!==0}static isAlias(s){return s!==void 0&&(s.getFlags()&n.SymbolFlags.Alias)!==0}static isFunction(s){return s!==void 0&&(s.getFlags()&n.SymbolFlags.Function)!==0}static isValueModule(s){return s!==void 0&&(s.getFlags()&n.SymbolFlags.ValueModule)!==0}static isEnum(s){return s!==void 0&&(s.getFlags()&n.SymbolFlags.Enum)!==0}static isRegularEnum(s){return s!==void 0&&(s.getFlags()&n.SymbolFlags.RegularEnum)!==0}static isConstEnum(s){return s!==void 0&&(s.getFlags()&n.SymbolFlags.ConstEnum)!==0}static isBase(s){return s!==void 0&&(s.getFlags()&n.SymbolFlags.Class)!==0}static isPrivate(s){let d=s.declarations;if(d!==void 0){for(let f of d)if((n.getCombinedModifierFlags(f)&n.ModifierFlags.Private)===0)return!1}return!0}static isAbstract(s){let d=s.declarations;if(d!==void 0){for(let f of d)if((n.getCombinedModifierFlags(f)&n.ModifierFlags.Abstract)===0)return!1}return!0}static isStatic(s){let d=s.declarations;if(d!==void 0){for(let f of d)if((n.getCombinedModifierFlags(f)&n.ModifierFlags.Static)===0)return!1}return!0}static internalSymbolNames;static isInternal(s){if(this.internalSymbolNames===void 0){this.internalSymbolNames=new Set;for(let d in n.InternalSymbolName)this.internalSymbolNames.add(n.InternalSymbolName[d])}return this.internalSymbolNames.has(s.escapedName)}static isSourceFile(s){let d=s.getDeclarations();return d!==void 0&&d.length===1&&n.isSourceFile(d[0])}static fillSources(s,d){if(d.declarations!==void 0)for(let f of d.declarations){let h=f.getSourceFile();h!==void 0&&s.add(h.fileName)}}static getPrimarySourceFile(s){let d=s.declarations;if(!(d===void 0||d.length===0))return d[0].getSourceFile()}static getDeclaration(s,d){let f=s.getDeclarations();if(!(f===void 0||f.length===0)){for(let h of f)if(h.kind===d)return h}}static createKey(s,d){let f=s.getDeclarations();if(f===void 0)return;let h=[];for(let m of f){let g=m.getSourceFile();h.push({f:g.fileName,s:m.getStart(),e:m.getEnd(),k:m.kind})}h.length>1&&h.sort((m,g)=>{let x=m.f<g.f?-1:m.f>g.f?1:0;return x!==0||(x=m.s-g.s,x!==0)||(x=m.e-g.e,x!==0)?x:m.k-g.k});let y=d.createHash("md5");return(s.flags&n.SymbolFlags.Transient)!==0&&y.update(JSON.stringify({trans:!0},void 0,0)),y.update(JSON.stringify(h,void 0,0)),y.digest("base64")}static createVersionedKey(s,d,f){let h=s.getDeclarations();if(h===void 0)return;let y=[];for(let g of h){let x=g.getSourceFile(),T=d.getScriptVersion(x);if(T===void 0)return;y.push({f:x.fileName,v:T,s:g.getStart(),e:g.getEnd(),k:g.kind})}y.length>1&&y.sort((g,x)=>{let T=g.f<x.f?-1:g.f>x.f?1:0;return T!==0||(T=g.v<x.v?-1:g.v>x.v?1:0,T!==0)||(T=g.s-x.s,T!==0)||(T=g.e-x.e,T!==0)?T:g.k-x.k});let m=f.createHash("md5");return(s.flags&n.SymbolFlags.Transient)!==0&&m.update(JSON.stringify({trans:!0},void 0,0)),m.update(JSON.stringify(y,void 0,0)),m.digest("base64")}getFullyQualifiedSymbolName(s){let d=s.getDeclarations();if(d===void 0||d.length===0)return;let f=d[0].getSourceFile();for(let m=1;m<d.length;m++)if(d[m].getSourceFile()!==f)return;if(this.getSymbolAtLocation(f)===void 0)return;let h=[],y=s;for(;y!==void 0;){let m=y.declarations;if(m===void 0||m.length===0)return;if(m.length===1&&n.isSourceFile(m[0]))break;h.push(this.getExportSymbolName(y)),y=k.getParent(y)}return h.length===0?void 0:`${h.reverse().join(".")}`}static escapeRegExp=new RegExp("\\.","g");getExportSymbolName(s){let d=s.getEscapedName();return(d.charAt(0)==='"'||d.charAt(0)==="'")&&(d=d.substr(1,d.length-2)),d=d.replace(k.escapeRegExp,".."),d}getProgram(){return this.program}getTypeChecker(){return this.typeChecker}getSymbolAtLocation(s){let d=this.typeChecker.getSymbolAtLocation(s);return d===void 0&&(d=C.getSymbol(s)),d}getExtendsSymbol(s){let d=s.declarations;if(d===void 0)return[void 0,void 0];for(let f of d)if(n.isClassDeclaration(f)){let h=f.heritageClauses;if(h!==void 0){for(let y of h)if(y.token===n.SyntaxKind.ExtendsKeyword){let m=y.types[0]?.expression,g=this.typeChecker.getSymbolAtLocation(m);if(k.isAlias(g)&&(g=this.typeChecker.getAliasedSymbol(g)),k.isClass(g))return[g,m.getText()]}}}return[void 0,void 0]}getLeafSymbolAtLocation(s){let d=this.getSymbolAtLocation(s);if(d!==void 0)return k.isAlias(d)?this.typeChecker.getAliasedSymbol(d):d}getSymbolAtTypeNodeLocation(s){return n.isTypeReferenceNode(s)?this.getLeafSymbolAtLocation(s.typeName):n.isTypeLiteralNode(s)?this.getLeafSymbolAtLocation(s):this.getLeafSymbolAtLocation(s)}getAliasedSymbol(s){return this.typeChecker.getAliasedSymbol(s)}getLeafAliasedSymbol(s){let d=0;for(;k.isAlias(s)&&d++<10;)s=this.getAliasedSymbol(s);return s}getAllSuperTypes(s,d="depthFirst"){return this._getAllSuperTypes(s,d,new Set,!1)}getAllSuperTypesWithPath(s,d="depthFirst"){return this._getAllSuperTypes(s,d,new Set,!0)}getDirectSuperTypes(s){return this._getAllSuperTypes(s,"breadthFirstOnly",new Set,!1)}*_getAllSuperTypes(s,d,f,h){let y=[s];for(;y.length>0;){let m=y.pop();if(k.isAlias(m)&&(f.add(m),m=this.typeChecker.getAliasedSymbol(m)),k.isClass(m)||k.isInterface(m)){let g=m.declarations;if(g===void 0)return;for(let x of g){let T;if((n.isClassDeclaration(x)||n.isInterfaceDeclaration(x))&&(T=x.heritageClauses),T!==void 0)for(let K of T)for(let P of K.types){let M=this.getLeafSymbolAtLocation(P.expression);M!==void 0&&!f.has(M)&&(f.add(M),yield h?[m,M]:M,d==="depthFirst"?yield*this._getAllSuperTypes(M,d,f,h):d==="breadthFirst"&&y.push(M))}}}else if(k.isTypeAlias(m)){let g=m.declarations;if(g===void 0)return;for(let x of g)if(n.isTypeAliasDeclaration(x)){let T=x.type;if(n.isTypeLiteralNode(T)){let K=this.getSymbolAtLocation(T);K!==void 0&&!f.has(K)&&(f.add(K),yield h?[m,K]:K)}else if(n.isTypeReferenceNode(T)){let K=this.getLeafSymbolAtLocation(T.typeName);K!==void 0&&!f.has(K)&&(f.add(K),yield h?[m,K]:K,d==="depthFirst"?yield*this._getAllSuperTypes(K,d,f,h):d==="breadthFirst"&&y.push(K))}else if(n.isIntersectionTypeNode(T))for(let K of T.types){let P=this.getSymbolAtTypeNodeLocation(K);P!==void 0&&!f.has(P)&&(k.isTypeLiteral(P)?(f.add(P),yield h?[m,P]:P):k.isTypeAlias(P)?(f.add(P),d==="depthFirst"?yield*this._getAllSuperTypes(P,d,f,h):d==="breadthFirst"&&y.push(P)):(f.add(P),yield h?[m,P]:P,d==="depthFirst"?yield*this._getAllSuperTypes(P,d,f,h):d==="breadthFirst"&&y.push(P)))}}}}}getAllSuperClasses(s){return this._getAllSuperClasses(s,new Set)}*_getAllSuperClasses(s,d){if(!k.isClass(s))return;let f=[s];for(;f.length>0;){let y=f.pop().declarations;if(y!==void 0)for(let m of y){if(!n.isClassDeclaration(m))continue;let g=m.heritageClauses;if(g!==void 0)for(let x of g){if(x.token!==n.SyntaxKind.ExtendsKeyword||x.types.length<1)continue;let T=x.types[0],K=this.getLeafSymbolAtLocation(T.expression);K!==void 0&&!d.has(K)&&(d.add(K),yield K,f.push(K))}}}}isSubType(s,d){if(s.heritageClauses===void 0)return!1;for(let f of s.heritageClauses)for(let h of f.types){let y=this.getLeafSymbolAtLocation(h.expression);if(y!==void 0&&y===d)return!0}return!1}isSubClass(s,d){if(s.heritageClauses===void 0)return!1;for(let f of s.heritageClauses){if(f.token!==n.SyntaxKind.ExtendsKeyword)continue;if(f.types.length<1)return!1;let h=this.getLeafSymbolAtLocation(f.types[0].expression);if(h!==void 0&&h===d)return!0}return!1}getDirectSubTypes(s,d,f,h){let y=k.isClass(s)?new Ie(s,"breadthFirstOnly",this):k.isInterface(s)||k.isTypeAlias(s)?new ke(s,"breadthFirstOnly",this):void 0;return y===void 0?rt:this._getAllSubTypes(y,d,f,new Set,h)}getAllSubTypes(s,d="depthFirst",f,h,y){let m=k.isClass(s)?new Ie(s,d,this):k.isInterface(s)||k.isTypeAlias(s)?new ke(s,d,this):void 0;return m===void 0?rt:this._getAllSubTypes(m,f,h,new Set,y)}*_getAllSubTypes(s,d,f,h,y){if(!s.isValid())return;let m=[s.start];for(;m.length>0;){let g=m.pop(),x=g.declarations;if(x===void 0||x.length===0)return;for(let T of x){if(!s.isValidDeclaration(T))continue;let K=new Wt(this.program,T.getSourceFile(),d,f,y);for(let P of K)for(let M of s.getDeclarations(P)){let ie=this.getLeafSymbolAtLocation(M.name?M.name:M);ie===void 0||h.has(ie)||s.isSubType(M,g)&&(h.add(ie),yield ie,s.mode==="depthFirst"?yield*this._getAllSubTypes(s.with(ie),d,f,h,y):s.mode==="breadthFirst"&&m.push(ie))}}}}getMemberStatistic(s){let d=new Set,f=new Set;k._getMemberStatistic(d,f,s);for(let h of this.getAllSuperTypes(s))k._getMemberStatistic(d,f,h);return{abstract:d,concrete:f}}static _getMemberStatistic(s,d,f){if(k.isClass(f)){let h=f.declarations;if(h===void 0)return;for(let y of h)if(n.isClassDeclaration(y))for(let m of y.members)if(n.isMethodDeclaration(m)||n.isGetAccessorDeclaration(m)||n.isSetAccessorDeclaration(m)||n.isPropertyDeclaration(m)){let g=m.name.getText();k.includesAbstract(m.modifiers)&&!d.has(g)?s.add(g):d.add(g)}else n.isIndexSignatureDeclaration(m)&&(k.includesAbstract(m.modifiers)&&!d.has("[]")?s.add("[]"):d.add("[]"))}else if((k.isInterface(f)||k.isTypeLiteral(f))&&f.members!==void 0)for(let h of f.members.values())d.has(h.name)||s.add(h.name)}static includesAbstract(s){return s===void 0?!1:s.some(d=>d.kind===n.SyntaxKind.AbstractKeyword)}}_.Symbols=k;let Qt;(f=>{function F(h){return h.projectService}f.getProjectService=F;function s(h,y){let m=h;if(typeof m.getFileAndProject=="function")return m.getFileAndProject(y)}f.getFileAndProject=s;function d(h,y,m){let g=h;if(typeof g.getPositionInFile=="function")return g.getPositionInFile(y,m)}f.getPositionInFile=d})(Qt=_.Sessions||={});function Gt(F){return F.moduleReference.kind===n.SyntaxKind.ExternalModuleReference&&F.moduleReference.expression.kind===n.SyntaxKind.StringLiteral}class fn{key;traversed;complete;outdated;importedBy;outdatedImportedBy;constructor(s){this.key=s,this.complete=!1,this.outdated=!1,this.traversed=new Set,this.importedBy=new Map,this.outdatedImportedBy=void 0}isComplete(){return this.complete}markComplete(){this.complete=!0,this.outdated=!1,this.outdatedImportedBy=void 0}addTraversed(s){this.traversed.add(s.fileName)}isTraversed(s){return this.traversed.has(s.fileName)}hasTraversed(){return this.traversed.size>0}imports(s,d){let f=this.importedBy.get(d.fileName);f===void 0&&(f=new Set,this.importedBy.set(d.fileName,f)),f.add(s.fileName)}getImportedBy(s,d){let f=this.importedBy.get(s.fileName);return f===void 0&&d&&(f=this.outdatedImportedBy?.get(s.fileName)),f===void 0?rt:f.values()}markAsOutdated(){this.outdated=!0,this.outdatedImportedBy=this.importedBy,this.importedBy=new Map}isOutdated(){return this.outdated}}_.ImportedByState=fn;class Wt{program;sourceFile;preferredSourceFiles;token;importedByState;constructor(s,d,f,h,y){this.program=s,this.sourceFile=d,this.preferredSourceFiles=f,this.token=y;let m=_.Programs.getKey(s);this.importedByState=m!==void 0?h.getImportedByState(m):void 0}getSourceFile(s){return this.program.getSourceFile(s)}[Symbol.iterator](){return this.entries()}*entries(){this.token.throwIfCancellationRequested();let s=this.program;if(this.importedByState!==void 0){for(let m of this.importedByState.getImportedBy(this.sourceFile,!0)){this.token.throwIfCancellationRequested();let g=this.getSourceFile(m);g!==void 0&&!this.skipSourceFile(s,g)&&(yield g)}if(this.importedByState.isComplete()&&!this.importedByState.isOutdated())return}function d(m){return m.kind===n.SyntaxKind.ModuleDeclaration&&m.name.kind===n.SyntaxKind.StringLiteral}function f(m,g){let x=m.getSymbolAtLocation(g);if(!(x===void 0||!k.isSourceFile(x)))return x.declarations[0]}let h=s.getTypeChecker(),y=h.getSymbolAtLocation(this.sourceFile);if(y!==void 0)for(let m of this.allSourceFiles()){if(this.token.throwIfCancellationRequested(),this.sourceFile===m){yield m;continue}if(!this.skipSourceFile(s,m))if(m.externalModuleIndicator&&m.imports!==void 0)for(let g=0;g<m.imports.length;g++){this.token.throwIfCancellationRequested();let x=h.getSymbolAtLocation(m.imports[g]);if(x===y){if(this.importedByState!==void 0){this.importedByState.imports(m,this.sourceFile);for(let T=g+1;T<m.imports.length;T++){let K=f(h,m.imports[g]);K!==void 0&&!this.skipSourceFile(s,K)&&this.importedByState?.imports(m,K)}}yield m;break}else if(x!==void 0&&k.isSourceFile(x)){let T=x.declarations[0];this.skipSourceFile(s,T)||this.importedByState?.imports(m,T)}}else{let g=m,x=g.kind===n.SyntaxKind.SourceFile?g.statements:g.body.statements,T=K=>{switch(K.kind){case n.SyntaxKind.ExportDeclaration:case n.SyntaxKind.ImportDeclaration:{let P=K;if(P.moduleSpecifier&&n.isStringLiteral(P.moduleSpecifier)&&h.getSymbolAtLocation(P.moduleSpecifier)===y)return!0;break}case n.SyntaxKind.ImportEqualsDeclaration:{let P=K;if(Gt(P)&&h.getSymbolAtLocation(P.moduleReference.expression)===y)return!0;break}}return!1};e:for(let K of x)if(this.token.throwIfCancellationRequested(),T(K)){this.importedByState?.imports(m,this.sourceFile),yield m;break e}else if(d(K)){let P=K.body&&K.body.statements;if(P!==void 0){for(let M of P)if(T(M)){this.importedByState?.imports(m,this.sourceFile),yield m;break e}}}}}}skipSourceFile(s,d){return s.isSourceFileDefaultLibrary(d)||s.isSourceFileFromExternalLibrary(d)||d.isDeclarationFile}*allSourceFiles(){if(this.importedByState===void 0)this.preferredSourceFiles!==void 0&&(yield*this.preferredSourceFiles),yield*this.program.getSourceFiles();else{if(this.preferredSourceFiles!==void 0){for(let s of this.preferredSourceFiles)this.importedByState.isTraversed(s)||(this.importedByState.addTraversed(s),yield s);for(let s of this.program.getSourceFiles())this.importedByState.isTraversed(s)||(this.importedByState.addTraversed(s),yield s)}this.importedByState.markComplete()}}}_.ReferencedByVisitor=Wt;let Yt;(f=>{let F=new Map([[n.SyntaxKind.Unknown,0],[n.SyntaxKind.EndOfFileToken,1],[n.SyntaxKind.SingleLineCommentTrivia,2],[n.SyntaxKind.MultiLineCommentTrivia,3],[n.SyntaxKind.NewLineTrivia,4],[n.SyntaxKind.WhitespaceTrivia,5],[n.SyntaxKind.ShebangTrivia,6],[n.SyntaxKind.ConflictMarkerTrivia,7],[n.SyntaxKind.NonTextFileMarkerTrivia,8],[n.SyntaxKind.NumericLiteral,9],[n.SyntaxKind.BigIntLiteral,10],[n.SyntaxKind.StringLiteral,11],[n.SyntaxKind.JsxText,12],[n.SyntaxKind.JsxTextAllWhiteSpaces,13],[n.SyntaxKind.RegularExpressionLiteral,14],[n.SyntaxKind.NoSubstitutionTemplateLiteral,15],[n.SyntaxKind.TemplateHead,16],[n.SyntaxKind.TemplateMiddle,17],[n.SyntaxKind.TemplateTail,18],[n.SyntaxKind.OpenBraceToken,19],[n.SyntaxKind.CloseBraceToken,20],[n.SyntaxKind.OpenParenToken,21],[n.SyntaxKind.CloseParenToken,22],[n.SyntaxKind.OpenBracketToken,23],[n.SyntaxKind.CloseBracketToken,24],[n.SyntaxKind.DotToken,25],[n.SyntaxKind.DotDotDotToken,26],[n.SyntaxKind.SemicolonToken,27],[n.SyntaxKind.CommaToken,28],[n.SyntaxKind.QuestionDotToken,29],[n.SyntaxKind.LessThanToken,30],[n.SyntaxKind.LessThanSlashToken,31],[n.SyntaxKind.GreaterThanToken,32],[n.SyntaxKind.LessThanEqualsToken,33],[n.SyntaxKind.GreaterThanEqualsToken,34],[n.SyntaxKind.EqualsEqualsToken,35],[n.SyntaxKind.ExclamationEqualsToken,36],[n.SyntaxKind.EqualsEqualsEqualsToken,37],[n.SyntaxKind.ExclamationEqualsEqualsToken,38],[n.SyntaxKind.EqualsGreaterThanToken,39],[n.SyntaxKind.PlusToken,40],[n.SyntaxKind.MinusToken,41],[n.SyntaxKind.AsteriskToken,42],[n.SyntaxKind.AsteriskAsteriskToken,43],[n.SyntaxKind.SlashToken,44],[n.SyntaxKind.PercentToken,45],[n.SyntaxKind.PlusPlusToken,46],[n.SyntaxKind.MinusMinusToken,47],[n.SyntaxKind.LessThanLessThanToken,48],[n.SyntaxKind.GreaterThanGreaterThanToken,49],[n.SyntaxKind.GreaterThanGreaterThanGreaterThanToken,50],[n.SyntaxKind.AmpersandToken,51],[n.SyntaxKind.BarToken,52],[n.SyntaxKind.CaretToken,53],[n.SyntaxKind.ExclamationToken,54],[n.SyntaxKind.TildeToken,55],[n.SyntaxKind.AmpersandAmpersandToken,56],[n.SyntaxKind.BarBarToken,57],[n.SyntaxKind.QuestionToken,58],[n.SyntaxKind.ColonToken,59],[n.SyntaxKind.AtToken,60],[n.SyntaxKind.QuestionQuestionToken,61],[n.SyntaxKind.BacktickToken,62],[n.SyntaxKind.HashToken,63],[n.SyntaxKind.EqualsToken,64],[n.SyntaxKind.PlusEqualsToken,65],[n.SyntaxKind.MinusEqualsToken,66],[n.SyntaxKind.AsteriskEqualsToken,67],[n.SyntaxKind.AsteriskAsteriskEqualsToken,68],[n.SyntaxKind.SlashEqualsToken,69],[n.SyntaxKind.PercentEqualsToken,70],[n.SyntaxKind.LessThanLessThanEqualsToken,71],[n.SyntaxKind.GreaterThanGreaterThanEqualsToken,72],[n.SyntaxKind.GreaterThanGreaterThanGreaterThanEqualsToken,73],[n.SyntaxKind.AmpersandEqualsToken,74],[n.SyntaxKind.BarEqualsToken,75],[n.SyntaxKind.BarBarEqualsToken,76],[n.SyntaxKind.AmpersandAmpersandEqualsToken,77],[n.SyntaxKind.QuestionQuestionEqualsToken,78],[n.SyntaxKind.CaretEqualsToken,79],[n.SyntaxKind.Identifier,80],[n.SyntaxKind.PrivateIdentifier,81],[n.SyntaxKind.BreakKeyword,83],[n.SyntaxKind.CaseKeyword,84],[n.SyntaxKind.CatchKeyword,85],[n.SyntaxKind.ClassKeyword,86],[n.SyntaxKind.ConstKeyword,87],[n.SyntaxKind.ContinueKeyword,88],[n.SyntaxKind.DebuggerKeyword,89],[n.SyntaxKind.DefaultKeyword,90],[n.SyntaxKind.DeleteKeyword,91],[n.SyntaxKind.DoKeyword,92],[n.SyntaxKind.ElseKeyword,93],[n.SyntaxKind.EnumKeyword,94],[n.SyntaxKind.ExportKeyword,95],[n.SyntaxKind.ExtendsKeyword,96],[n.SyntaxKind.FalseKeyword,97],[n.SyntaxKind.FinallyKeyword,98],[n.SyntaxKind.ForKeyword,99],[n.SyntaxKind.FunctionKeyword,100],[n.SyntaxKind.IfKeyword,101],[n.SyntaxKind.ImportKeyword,102],[n.SyntaxKind.InKeyword,103],[n.SyntaxKind.InstanceOfKeyword,104],[n.SyntaxKind.NewKeyword,105],[n.SyntaxKind.NullKeyword,106],[n.SyntaxKind.ReturnKeyword,107],[n.SyntaxKind.SuperKeyword,108],[n.SyntaxKind.SwitchKeyword,109],[n.SyntaxKind.ThisKeyword,110],[n.SyntaxKind.ThrowKeyword,111],[n.SyntaxKind.TrueKeyword,112],[n.SyntaxKind.TryKeyword,113],[n.SyntaxKind.TypeOfKeyword,114],[n.SyntaxKind.VarKeyword,115],[n.SyntaxKind.VoidKeyword,116],[n.SyntaxKind.WhileKeyword,117],[n.SyntaxKind.WithKeyword,118],[n.SyntaxKind.ImplementsKeyword,119],[n.SyntaxKind.InterfaceKeyword,120],[n.SyntaxKind.LetKeyword,121],[n.SyntaxKind.PackageKeyword,122],[n.SyntaxKind.PrivateKeyword,123],[n.SyntaxKind.ProtectedKeyword,124],[n.SyntaxKind.PublicKeyword,125],[n.SyntaxKind.StaticKeyword,126],[n.SyntaxKind.YieldKeyword,127],[n.SyntaxKind.AbstractKeyword,128],[n.SyntaxKind.AccessorKeyword,129],[n.SyntaxKind.AsKeyword,130],[n.SyntaxKind.AssertsKeyword,131],[n.SyntaxKind.AssertKeyword,132],[n.SyntaxKind.AnyKeyword,133],[n.SyntaxKind.AsyncKeyword,134],[n.SyntaxKind.AwaitKeyword,135],[n.SyntaxKind.BooleanKeyword,136],[n.SyntaxKind.ConstructorKeyword,137],[n.SyntaxKind.DeclareKeyword,138],[n.SyntaxKind.GetKeyword,139],[n.SyntaxKind.InferKeyword,140],[n.SyntaxKind.IntrinsicKeyword,141],[n.SyntaxKind.IsKeyword,142],[n.SyntaxKind.KeyOfKeyword,143],[n.SyntaxKind.ModuleKeyword,144],[n.SyntaxKind.NamespaceKeyword,145],[n.SyntaxKind.NeverKeyword,146],[n.SyntaxKind.OutKeyword,147],[n.SyntaxKind.ReadonlyKeyword,148],[n.SyntaxKind.RequireKeyword,149],[n.SyntaxKind.NumberKeyword,150],[n.SyntaxKind.ObjectKeyword,151],[n.SyntaxKind.SatisfiesKeyword,152],[n.SyntaxKind.SetKeyword,153],[n.SyntaxKind.StringKeyword,154],[n.SyntaxKind.SymbolKeyword,155],[n.SyntaxKind.TypeKeyword,156],[n.SyntaxKind.UndefinedKeyword,157],[n.SyntaxKind.UniqueKeyword,158],[n.SyntaxKind.UnknownKeyword,159],[n.SyntaxKind.UsingKeyword,160],[n.SyntaxKind.FromKeyword,161],[n.SyntaxKind.GlobalKeyword,162],[n.SyntaxKind.BigIntKeyword,163],[n.SyntaxKind.OverrideKeyword,164],[n.SyntaxKind.OfKeyword,165],[n.SyntaxKind.QualifiedName,166],[n.SyntaxKind.ComputedPropertyName,167],[n.SyntaxKind.TypeParameter,168],[n.SyntaxKind.Parameter,169],[n.SyntaxKind.Decorator,170],[n.SyntaxKind.PropertySignature,171],[n.SyntaxKind.PropertyDeclaration,172],[n.SyntaxKind.MethodSignature,173],[n.SyntaxKind.MethodDeclaration,174],[n.SyntaxKind.ClassStaticBlockDeclaration,175],[n.SyntaxKind.Constructor,176],[n.SyntaxKind.GetAccessor,177],[n.SyntaxKind.SetAccessor,178],[n.SyntaxKind.CallSignature,179],[n.SyntaxKind.ConstructSignature,180],[n.SyntaxKind.IndexSignature,181],[n.SyntaxKind.TypePredicate,182],[n.SyntaxKind.TypeReference,183],[n.SyntaxKind.FunctionType,184],[n.SyntaxKind.ConstructorType,185],[n.SyntaxKind.TypeQuery,186],[n.SyntaxKind.TypeLiteral,187],[n.SyntaxKind.ArrayType,188],[n.SyntaxKind.TupleType,189],[n.SyntaxKind.OptionalType,190],[n.SyntaxKind.RestType,191],[n.SyntaxKind.UnionType,192],[n.SyntaxKind.IntersectionType,193],[n.SyntaxKind.ConditionalType,194],[n.SyntaxKind.InferType,195],[n.SyntaxKind.ParenthesizedType,196],[n.SyntaxKind.ThisType,197],[n.SyntaxKind.TypeOperator,198],[n.SyntaxKind.IndexedAccessType,199],[n.SyntaxKind.MappedType,200],[n.SyntaxKind.LiteralType,201],[n.SyntaxKind.NamedTupleMember,202],[n.SyntaxKind.TemplateLiteralType,203],[n.SyntaxKind.TemplateLiteralTypeSpan,204],[n.SyntaxKind.ImportType,205],[n.SyntaxKind.ObjectBindingPattern,206],[n.SyntaxKind.ArrayBindingPattern,207],[n.SyntaxKind.BindingElement,208],[n.SyntaxKind.ArrayLiteralExpression,209],[n.SyntaxKind.ObjectLiteralExpression,210],[n.SyntaxKind.PropertyAccessExpression,211],[n.SyntaxKind.ElementAccessExpression,212],[n.SyntaxKind.CallExpression,213],[n.SyntaxKind.NewExpression,214],[n.SyntaxKind.TaggedTemplateExpression,215],[n.SyntaxKind.TypeAssertionExpression,216],[n.SyntaxKind.ParenthesizedExpression,217],[n.SyntaxKind.FunctionExpression,218],[n.SyntaxKind.ArrowFunction,219],[n.SyntaxKind.DeleteExpression,220],[n.SyntaxKind.TypeOfExpression,221],[n.SyntaxKind.VoidExpression,222],[n.SyntaxKind.AwaitExpression,223],[n.SyntaxKind.PrefixUnaryExpression,224],[n.SyntaxKind.PostfixUnaryExpression,225],[n.SyntaxKind.BinaryExpression,226],[n.SyntaxKind.ConditionalExpression,227],[n.SyntaxKind.TemplateExpression,228],[n.SyntaxKind.YieldExpression,229],[n.SyntaxKind.SpreadElement,230],[n.SyntaxKind.ClassExpression,231],[n.SyntaxKind.OmittedExpression,232],[n.SyntaxKind.ExpressionWithTypeArguments,233],[n.SyntaxKind.AsExpression,234],[n.SyntaxKind.NonNullExpression,235],[n.SyntaxKind.MetaProperty,236],[n.SyntaxKind.SyntheticExpression,237],[n.SyntaxKind.SatisfiesExpression,238],[n.SyntaxKind.TemplateSpan,239],[n.SyntaxKind.SemicolonClassElement,240],[n.SyntaxKind.Block,241],[n.SyntaxKind.EmptyStatement,242],[n.SyntaxKind.VariableStatement,243],[n.SyntaxKind.ExpressionStatement,244],[n.SyntaxKind.IfStatement,245],[n.SyntaxKind.DoStatement,246],[n.SyntaxKind.WhileStatement,247],[n.SyntaxKind.ForStatement,248],[n.SyntaxKind.ForInStatement,249],[n.SyntaxKind.ForOfStatement,250],[n.SyntaxKind.ContinueStatement,251],[n.SyntaxKind.BreakStatement,252],[n.SyntaxKind.ReturnStatement,253],[n.SyntaxKind.WithStatement,254],[n.SyntaxKind.SwitchStatement,255],[n.SyntaxKind.LabeledStatement,256],[n.SyntaxKind.ThrowStatement,257],[n.SyntaxKind.TryStatement,258],[n.SyntaxKind.DebuggerStatement,259],[n.SyntaxKind.VariableDeclaration,260],[n.SyntaxKind.VariableDeclarationList,261],[n.SyntaxKind.FunctionDeclaration,262],[n.SyntaxKind.ClassDeclaration,263],[n.SyntaxKind.InterfaceDeclaration,264],[n.SyntaxKind.TypeAliasDeclaration,265],[n.SyntaxKind.EnumDeclaration,266],[n.SyntaxKind.ModuleDeclaration,267],[n.SyntaxKind.ModuleBlock,268],[n.SyntaxKind.CaseBlock,269],[n.SyntaxKind.NamespaceExportDeclaration,270],[n.SyntaxKind.ImportEqualsDeclaration,271],[n.SyntaxKind.ImportDeclaration,272],[n.SyntaxKind.ImportClause,273],[n.SyntaxKind.NamespaceImport,274],[n.SyntaxKind.NamedImports,275],[n.SyntaxKind.ImportSpecifier,276],[n.SyntaxKind.ExportAssignment,277],[n.SyntaxKind.ExportDeclaration,278],[n.SyntaxKind.NamedExports,279],[n.SyntaxKind.NamespaceExport,280],[n.SyntaxKind.ExportSpecifier,281],[n.SyntaxKind.MissingDeclaration,282],[n.SyntaxKind.ExternalModuleReference,283],[n.SyntaxKind.JsxElement,284],[n.SyntaxKind.JsxSelfClosingElement,285],[n.SyntaxKind.JsxOpeningElement,286],[n.SyntaxKind.JsxClosingElement,287],[n.SyntaxKind.JsxFragment,288],[n.SyntaxKind.JsxOpeningFragment,289],[n.SyntaxKind.JsxClosingFragment,290],[n.SyntaxKind.JsxAttribute,291],[n.SyntaxKind.JsxAttributes,292],[n.SyntaxKind.JsxSpreadAttribute,293],[n.SyntaxKind.JsxExpression,294],[n.SyntaxKind.JsxNamespacedName,295],[n.SyntaxKind.CaseClause,296],[n.SyntaxKind.DefaultClause,297],[n.SyntaxKind.HeritageClause,298],[n.SyntaxKind.CatchClause,299],[n.SyntaxKind.ImportAttributes,300],[n.SyntaxKind.ImportAttribute,301],[n.SyntaxKind.PropertyAssignment,303],[n.SyntaxKind.ShorthandPropertyAssignment,304],[n.SyntaxKind.SpreadAssignment,305],[n.SyntaxKind.EnumMember,306],[n.SyntaxKind.SourceFile,307],[n.SyntaxKind.Bundle,308],[n.SyntaxKind.JSDocTypeExpression,309],[n.SyntaxKind.JSDocNameReference,310],[n.SyntaxKind.JSDocMemberName,311],[n.SyntaxKind.JSDocAllType,312],[n.SyntaxKind.JSDocUnknownType,313],[n.SyntaxKind.JSDocNullableType,314],[n.SyntaxKind.JSDocNonNullableType,315],[n.SyntaxKind.JSDocOptionalType,316],[n.SyntaxKind.JSDocFunctionType,317],[n.SyntaxKind.JSDocVariadicType,318],[n.SyntaxKind.JSDocNamepathType,319],[n.SyntaxKind.JSDoc,320],[n.SyntaxKind.JSDocText,321],[n.SyntaxKind.JSDocTypeLiteral,322],[n.SyntaxKind.JSDocSignature,323],[n.SyntaxKind.JSDocLink,324],[n.SyntaxKind.JSDocLinkCode,325],[n.SyntaxKind.JSDocLinkPlain,326],[n.SyntaxKind.JSDocTag,327],[n.SyntaxKind.JSDocAugmentsTag,328],[n.SyntaxKind.JSDocImplementsTag,329],[n.SyntaxKind.JSDocAuthorTag,330],[n.SyntaxKind.JSDocDeprecatedTag,331],[n.SyntaxKind.JSDocClassTag,332],[n.SyntaxKind.JSDocPublicTag,333],[n.SyntaxKind.JSDocPrivateTag,334],[n.SyntaxKind.JSDocProtectedTag,335],[n.SyntaxKind.JSDocReadonlyTag,336],[n.SyntaxKind.JSDocOverrideTag,337],[n.SyntaxKind.JSDocCallbackTag,338],[n.SyntaxKind.JSDocOverloadTag,339],[n.SyntaxKind.JSDocEnumTag,340],[n.SyntaxKind.JSDocParameterTag,341],[n.SyntaxKind.JSDocReturnTag,342],[n.SyntaxKind.JSDocThisTag,343],[n.SyntaxKind.JSDocTypeTag,344],[n.SyntaxKind.JSDocTemplateTag,345],[n.SyntaxKind.JSDocTypedefTag,346],[n.SyntaxKind.JSDocSeeTag,347],[n.SyntaxKind.JSDocPropertyTag,348],[n.SyntaxKind.JSDocThrowsTag,349],[n.SyntaxKind.JSDocSatisfiesTag,350],[n.SyntaxKind.JSDocImportTag,351],[n.SyntaxKind.SyntaxList,352],[n.SyntaxKind.NotEmittedStatement,353],[n.SyntaxKind.PartiallyEmittedExpression,354],[n.SyntaxKind.CommaListExpression,355],[n.SyntaxKind.SyntheticReferenceExpression,356],[n.SyntaxKind.NotEmittedTypeElement,357]]),s=9999;function d(h){let y=[];for(;h!==void 0;)y.push(F.get(h.kind)??s),h=h.parent;return y}f.getPath=d})(Yt=_.StableSyntaxKinds||={})})(Nt||={});Rt.exports=Nt});var st,at,we,Et=V(()=>{"use strict";st=class{[Symbol.toStringTag]="LinkedMap";_map;_head;_tail;_size;_state;constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=0){let i=this._map.get(e);if(i)return t!==0&&this.touch(i,t),i.value}set(e,t,i=0){let o=this._map.get(e);if(o)o.value=t,i!==0&&this.touch(o,i);else{switch(o={key:e,value:t,next:void 0,previous:void 0},i){case 0:this.addItemLast(o);break;case 1:this.addItemFirst(o);break;case 2:this.addItemLast(o);break;default:this.addItemLast(o);break}this._map.set(e,o),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let i=this._state,o=this._head;for(;o;){if(t?e.bind(t)(o.value,o.key,this):e(o.value,o.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");o=o.next}}keys(){let e=this,t=this._state,i=this._head,o={[Symbol.iterator](){return o},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){let r={value:i.key,done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return o}values(){let e=this,t=this._state,i=this._head,o={[Symbol.iterator](){return o},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){let r={value:i.value,done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return o}entries(){let e=this,t=this._state,i=this._head,o={[Symbol.iterator](){return o},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){let r={value:[i.key,i.value],done:!1};return i=i.next,r}else return{value:void 0,done:!0}}};return o}[Symbol.iterator](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.previous,i--;this._tail=t,this._size=i,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;let i=e.next,o=e.previous;e===this._tail?(o.next=void 0,this._tail=o):(i.previous=o,o.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;let i=e.next,o=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=o,o.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(let[t,i]of e)this.set(t,i)}},at=class extends st{_limit;_ratio;constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},we=class extends at{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}}});var R,oe,N,he,De,j,dt,lt,Pe,Ae,ct,O,$,Se,Ne,W=V(()=>{"use strict";J();z();R=X(Z());Et();oe=A(),N=class extends Error{static SourceFileNotFound=1;static NodeNotFound=2;static NodeKindMismatch=3;static SymbolNotFound=4;static NoDeclaration=5;static NoProgram=6;static NoSourceFile=7;code;constructor(e,t){super(e),this.code=t}},he=class{getSymbolInfo(e,t=!1){let i=e.declarations;if(i===void 0||i.length===0)return{skip:!0};let o,r=0,l=this.getProgram();for(let a of i){let p=a.getSourceFile();o===void 0&&(o=p),(l.isSourceFileDefaultLibrary(p)||t&&l.isSourceFileFromExternalLibrary(p))&&r++}return r===i.length?{skip:!0}:{skip:!1,primary:o}}skipDeclaration(e,t=e.getSourceFile()){let i=this.getProgram();return i.isSourceFileDefaultLibrary(t)||i.isSourceFileFromExternalLibrary(t)||t.isDeclarationFile}},De=class{symbols;seenSymbols;neighborFiles;knownContextItems;constructor(e,t){this.symbols=new Map,this.seenSymbols=new Map,this.neighborFiles=e,this.knownContextItems=t}getSymbols(e){let t=this.symbols.get(e);return t===void 0&&(t=new R.Symbols(e),this.symbols.set(e,t)),t}getSeenSymbols(e,t){let i=this.seenSymbols.get(t);return i===void 0&&(i=new ct(e),this.seenSymbols.set(t,i)),i}getPreferredNeighborFiles(e){let t=[];for(let i of this.neighborFiles){let o=e.getSourceFile(i);o!==void 0&&t.push(o)}return t}isCachedOnClient(e){return this.knownContextItems.has(e)}getCachedContextItem(e){return this.knownContextItems.get(e)}},j=class extends he{program;symbols;constructor(e,t=new R.Symbols(e)){if(super(),e!==t.getProgram())throw new Error("Program and symbols program must match");this.program=e,this.symbols=t}getSymbols(){return this.symbols}getProgram(){return this.program}getHeritageSymbol(e){let t=this.symbols.getSymbolAtLocation(e);if(t===void 0)return;R.Symbols.isAlias(t)&&(t=this.symbols.getAliasedSymbol(t));let i=0;for(;R.Symbols.isTypeAlias(t)&&i<10;){let o=t.declarations;if(o!==void 0){let r=t;for(let l of o)if(oe.isTypeAliasDeclaration(l)){let a=l.type;oe.isTypeReferenceNode(a)&&(t=this.symbols.getLeafSymbolAtLocation(a.typeName))}if(r===t)break}i++}return t}static getNodeInProgram(e,t){function i(p,u){if(p===void 0||u===void 0)return p===u;for(;p!==void 0&&u!==void 0;){if(p.kind!==u.kind||p.pos!==u.pos||p.end!==u.end)return!1;p=p.parent,u=u.parent}return p===void 0&&u===void 0}let o=t.getSourceFile().fileName,r=e.getSourceFile(o);if(r===void 0)throw new N(`No source file found for ${o}`,N.SourceFileNotFound);let l=R.default.getTokenAtPosition(r,t.pos),a=l;if(a===void 0)throw new N(`No node found for ${o}:${t.pos}`,N.NodeNotFound);for(;a!==void 0;){if(t.pos===a.pos&&t.end===a.end&&t.kind===a.kind&&i(t.parent,a.parent))return a;a=a.parent}throw new N(`Found node ${l.kind} for node ${t.kind} in file ${o}:${t.pos}`,N.NodeKindMismatch)}},dt=class{info(){}msg(){}startGroup(){}endGroup(){}},lt=class{host;codeCache;importedByState;supportsCaching;constructor(e,t){this.host=e,this.codeCache=new we(100),this.importedByState=new Map,this.supportsCaching=t}getImportedByState(e){let t=this.importedByState.get(e);return t===void 0&&(t=new R.ImportedByState(e),this.importedByState.set(e,t)),t}run(e,t,i){let o=this.getPossiblePrograms(e,t);for(let r of o){let a=e.with(r).run(t,i);if(a!==void 0)return[r,a]}return[void 0,void 0]}getPossiblePrograms(e,t){let i=[];for(let o of this.getLanguageServices()){let r=o.getProgram();if(r===void 0)continue;let l=e.score(r,t);l>0&&i.push([l,r])}return i.sort((o,r)=>r[0]-o[0]).map(o=>o[1])}getCachedCode(e,t){if(this.supportsCaching){if(typeof e=="string")return this.codeCache.get(e);{let i=R.Symbols.createVersionedKey(t,this,this.host);return i===void 0?void 0:this.codeCache.get(i)}}}cacheCode(e,t){if(this.supportsCaching)if(typeof e=="string")this.codeCache.set(e,t);else{let i=R.Symbols.createVersionedKey(e,this,this.host);i!==void 0&&this.codeCache.set(i,t)}}addComputationStateItems(e,t){let i=t.getImportsByCacheRange();if(i===void 0){for(let o of this.importedByState.values())o.markAsOutdated();return}e.addComputationState("importedByState",{kind:"range",range:i})}applyComputationStates(e){let t=!1;for(let i of e)i.kind==="computationState"&&i.key==="importedByState"&&(t=!0);if(!t)for(let i of this.importedByState.values())i.markAsOutdated()}enableBlueprintSearch(){return!1}},Pe=class extends lt{session;logger;constructor(e,t){super(t,!0),this.session=e;let i=R.Sessions.getProjectService(this.session);this.logger=i?.logger??new dt}logError(e,t){this.session.logError(e,t)}getFileAndProject(e){return R.Sessions.getFileAndProject(this.session,e)}getPositionInFile(e,t){return R.Sessions.getPositionInFile(this.session,e,t)}*getLanguageServices(e){let t=R.Sessions.getProjectService(this.session);if(t!==void 0)if(e===void 0){for(let i of t.configuredProjects.values())yield i.getLanguageService();for(let i of t.inferredProjects)yield i.getLanguageService();for(let i of t.externalProjects)yield i.getLanguageService()}else{let i=oe.server.toNormalizedPath(e.fileName),o=t.getScriptInfoForNormalizedPath(i);yield*o?o.containingProjects.map(r=>r.getLanguageService()):[]}}getScriptVersion(e){let t=oe.server.toNormalizedPath(e.fileName),i=R.Sessions.getProjectService(this.session);return i===void 0?void 0:i.getScriptInfoForNormalizedPath(t)?.getLatestVersion()}},Ae=class{tokenBudget;_metaItems=[];_items;constructor(e){this.tokenBudget=e,this._metaItems=[],this._items=[]}get items(){return this._metaItems.concat(this._items)}addMetaData(e,t){this._metaItems.push(et.create(e,t))}addErrorData(e){this._metaItems.push(tt.create(e.code,e.message))}addTimings(e,t){this._metaItems.push(nt.create(e,t))}addCachedContextItem(e){this._items.push(it.create(e.key)),e.sizeInChars!==void 0&&this.tokenBudget.spent(e.sizeInChars)}addComputationState(e,t){this._items.push(ot.create(e,t))}addTrait(e,t,i,o,r){let l=G.create(e,t,i,o,r);this._items.push(l),this.tokenBudget.spent(G.sizeInChars(l))}addSnippet(e,t,i,o){if(e.isEmpty())return;let r=e.snippet(t,i,o);this.tokenBudget.spent(ye.sizeInChars(r)),this._items.push(r)}},ct=class{session;symbols=new Set;keys=new Set;constructor(e,t){this.session=e,this.symbols=new Set,this.keys=t?.keys??new Set}add(e){this.symbols.add(e);let t=R.Symbols.createKey(e,this.session.host);t!==void 0&&this.keys.add(t)}has(e){if(this.symbols.has(e))return!0;let t=R.Symbols.createKey(e,this.session.host);return t===void 0?!1:this.keys.has(t)?(this.symbols.add(e),!0):!1}manages(e){return this.has(e)?!0:(this.add(e),!1)}},O=class{session;languageService;context;symbols;cost;constructor(e,t,i,o){this.session=e,this.languageService=t,this.context=i,this.symbols=i.getSymbols(this.getProgram()),this.cost=o}getProgram(){let e=this.languageService.getProgram();if(e===void 0)throw new N("No program available",N.NoProgram);return e}createCacheInfo(e,t,i,o){if(e===void 0)return;let r,l;this.isNodeArray(i)?(r=i.pos,l=i.end):(r=i.getStart(o),l=i.getEnd(),o===void 0&&(o=i.getSourceFile()));let a=this.symbols.getFullyQualifiedSymbolName(e),p=a!==void 0?`${o.fileName}:${a}[${r}]`:`${o.fileName}:[${r}]`,u=oe.getLineAndCharacterOfPosition(o,r),S=oe.getLineAndCharacterOfPosition(o,l);return{key:JSON.stringify({k:t,s:p},void 0,0),scope:{kind:"range",range:{start:u,end:S}}}}isNodeArray(e){return Array.isArray(e)}skipSourceFile(e){let t=this.getProgram();return t.isSourceFileDefaultLibrary(e)||t.isSourceFileFromExternalLibrary(e)}},$=class{contextKind;symbolsToQuery;constructor(e,t){this.contextKind=e,this.symbolsToQuery=t}isCallableProvider;_getImportsByCacheRange(e){let t=e.getSourceFile(),i=e.getStart(t),o=oe.getLineAndCharacterOfPosition(t,i),r=oe.getLineAndCharacterOfPosition(t,e.getEnd());return{start:o,end:r}}},Se=class extends Error{constructor(){super("Budget exhausted")}},Ne=class{charBudget;constructor(e){this.charBudget=e*4}spent(e){this.charBudget-=e}isExhausted(){return this.charBudget<=0}throwIfExhausted(){if(this.charBudget<=0)throw new Se}spentAndThrowIfExhausted(e){this.spent(e),this.throwIfExhausted()}}});var I,L,de,le,be,Re,Ee,ut,pt,mt,ft,B,ce=V(()=>{"use strict";J();W();z();I=X(Z()),L=A();(o=>{function c(r,l){l??=r.getSourceFile();let a=r.getStart(l,!0),p=l.getLineAndCharacterOfPosition(a),S=l.text.substring(a,r.getEnd()).split(/\r?\n/g);if(p.character>0){let b=l.getPositionOfLineAndCharacter(p.line,0),C=l.text.substring(b,a);t(S,C)}return i(S),S}o.getLines=c;function e(r){let l=r.getFullText(),a=L.getLeadingCommentRanges(l,0);if(a!==void 0&&a.length>0){let p=a.at(-1).pos,u=a.at(-1).end,b=l.substring(p,u).trim().split(/\r?\n/);if(i(b),b.length>1){let v=b[1].match(/^\s+/);v!==null&&t(b,v[0])}return b}}o.getDocumentation=e;function t(r,l,a=1){let p=!0;for(let u=a;u<r.length;u++)if(!r[u].startsWith(l)){p=!1;break}if(p)for(let u=a;u<r.length;u++)r[u]=r[u].substring(l.length)}function i(r){for(;r.length>0&&r[0].trim()==="";)r.shift();for(;r.length>0&&r.at(-1).trim()==="";)r.pop()}})(de||={});le=class{session;indent;lines;source;additionalSources;constructor(e,t,i=0){this.session=e,this.indent=i,this.source=t.fileName,this.lines=[],this.additionalSources=new Set}makeKey(e){if(Array.isArray(e)){if(e.length===0)return;let t=[];for(let i of e){let o=I.Symbols.createVersionedKey(i,this.session,this.session.host);if(o!==void 0)t.push(o);else{t=void 0;break}}return t===void 0?void 0:t.join(";")}else return I.Symbols.createVersionedKey(e,this.session,this.session.host)}getAdditionalSources(){return this.additionalSources.delete(this.source),this.additionalSources}increaseIndent(){this.indent++}decreaseIndent(){this.indent--}addPropertyDeclaration(e){this.lines.push(...de.getLines(e))}addMethodDeclaration(e){let t=de.getDocumentation(e);t!==void 0&&this.lines.push(...t);let i=[];i.push("	".repeat(this.indent)),e.modifiers!==void 0&&(i.push(e.modifiers.map(o=>o.getText()).join(" ")),i.push(" ")),i.push(e.name.getText()),e.typeParameters!==void 0&&(i.push("<"),i.push(e.typeParameters.map(o=>o.getText()).join(", ")),i.push(">")),i.push("("),e.parameters!==void 0&&i.push(e.parameters.map(o=>o.getText()).join(", ")),i.push(")"),e.type!==void 0&&(i.push(": "),i.push(e.type.getText())),i.push(";"),this.lines.push(i.join(""))}addFunctionDeclaration(e,t,i){t??=e.name?.getText()??"";let o=de.getDocumentation(e);o!==void 0&&this.lines.push(...o);let r=[];r.push("	".repeat(this.indent)),r.push(this.getModifiers(e.modifiers,i)),r.push(" function "),r.push(t),r.push(this.getTypeParameters(e.typeParameters)),r.push("("),r.push(this.getParameters(e.parameters)),r.push(")"),r.push(this.getReturnTypes(e)),r.push(";"),this.lines.push(r.join(""))}getModifiers(e,t){if(e===void 0)return"";let i=[];t!==void 0&&i.push(t);for(let o of e)o.kind===L.SyntaxKind.AsyncKeyword||o.kind===L.SyntaxKind.DeclareKeyword||o.kind===L.SyntaxKind.ExportKeyword||i.push(o.getText());return i.join(" ")}getTypeParameters(e){if(e===void 0)return"";let t=[];return t.push("<"),t.push(e.map(i=>i.getText()).join(", ")),t.push(">"),t.join("")}getParameters(e){return e===void 0?"":e.map(t=>t.getText()).join(", ")}getReturnTypes(e){return e.type===void 0?"":`: ${e.type.getText()}`}},be=class extends le{type;name;constructor(e,t,i,o){super(e,t),this.type=i,this.name=o}processMembers(e){for(let[t,i]of e)this.processMember(i)}processMember(e){let t=e.declarations;if(t!==void 0){if(I.Symbols.isProperty(e)){let i=t[0];(L.isPropertyDeclaration(i)||L.isPropertySignature(i))&&this.addPropertyDeclaration(i)}else if(I.Symbols.isMethod(e))for(let i of t)(L.isMethodDeclaration(i)||L.isMethodSignature(i))&&this.addMethodDeclaration(i)}}},Re=class extends be{superClasses;includePrivates;key;constructor(e,t,i,o,r,l,a){super(e,i,o,r),this.includePrivates=a,this.key=void 0,l?(this.superClasses=new Array(...t.getAllSuperClasses(o)),this.key=this.makeKey([o,...this.superClasses])):(this.key=this.makeKey(o),this.superClasses=void 0)}emit(){if(this.lines.push(`declare class${this.getTypeParameters()} ${this.name} {`),this.increaseIndent(),this.superClasses!==void 0)for(let e=this.superClasses.length-1;e>=0;e--){let t=this.superClasses[e];t.members!==void 0&&(I.Symbols.fillSources(this.additionalSources,t),this.processMembers(t.members))}this.type.members!==void 0&&(I.Symbols.fillSources(this.additionalSources,this.type),this.processMembers(this.type.members)),this.decreaseIndent(),this.lines.push("}")}processMember(e){!this.includePrivates&&I.Symbols.isPrivate(e)||super.processMember(e)}getTypeParameters(){let e=this.type.declarations;if(e===void 0||e.length===0)return"";let t=e[0];return L.isClassDeclaration(t)&&t.typeParameters!==void 0?super.getTypeParameters(t.typeParameters):""}},Ee=class extends be{superTypes;key;constructor(e,t,i,o,r){super(e,i,o,r),this.superTypes=new Array(...t.getAllSuperTypes(o)).filter(l=>I.Symbols.isInterface(l)),this.superTypes.length===0?this.key=this.makeKey(o):this.key=this.makeKey([o,...this.superTypes])}emit(){this.lines.push(`interface ${this.name} {`),this.increaseIndent();for(let e=this.superTypes.length-1;e>=0;e--){let t=this.superTypes[e];t.members!==void 0&&(I.Symbols.fillSources(this.additionalSources,t),this.processMembers(t.members))}this.type.members!==void 0&&(I.Symbols.fillSources(this.additionalSources,this.type),this.processMembers(this.type.members)),this.decreaseIndent(),this.lines.push("}")}},ut=class extends le{type;name;key;constructor(e,t,i,o){super(e,t),this.type=i,this.name=o,this.key=this.makeKey(i)}emit(){if(this.lines.push(`${I.Symbols.isConstEnum(this.type)?"const ":""}enum ${this.name} {`),this.increaseIndent(),this.type.exports!==void 0){let e=0,t=this.type.exports.size-1;for(let[i,o]of this.type.exports){let r=o.declarations;if(r===void 0)continue;let l=r[0];if(L.isEnumMember(l)){let a=de.getLines(l);e<t&&(a[a.length-1]+=","),this.lines.push(...a)}e++}}this.decreaseIndent(),this.lines.push("}")}},pt=class extends be{key;constructor(e,t,i,o){super(e,t,i,o)}emit(){this.lines.push(`type ${this.name} = {`),this.increaseIndent(),this.type.members!==void 0&&this.processMembers(this.type.members),this.decreaseIndent(),this.lines.push("}")}},mt=class extends le{func;name;constructor(e,t,i,o){super(e,t),this.func=i,this.name=o??i.getName()}get key(){}emit(e){let t=this.func.declarations;if(t!==void 0)for(let i of t){let o=i.getSourceFile().fileName;o!==e.fileName&&L.isFunctionDeclaration(i)&&(this.addFunctionDeclaration(i,this.name,"declare"),this.additionalSources.add(o))}}},ft=class extends le{module;name;constructor(e,t,i,o){super(e,t),this.module=i,this.name=o??i.getName()}get key(){}emit(e){this.lines.push(`declare namespace ${this.name} {`),this.increaseIndent();let t=this.module.exports;t!==void 0&&this.addExports(t,e),this.decreaseIndent(),this.lines.push("}")}addExports(e,t){for(let[i,o]of e){let r=o.declarations;if(r!==void 0&&I.Symbols.isFunction(o))for(let l of r){let a=l.getSourceFile().fileName;a!==t.fileName&&L.isFunctionDeclaration(l)&&(this.addFunctionDeclaration(l,this.name,"declare"),this.additionalSources.add(a))}}}},B=class extends he{lines;source;additionalSources;indent=0;session;symbols;currentSourceFile;seen;constructor(e,t,i,o){super(),this.lines=[],this.source=void 0,this.additionalSources=new Set,this.session=e,this.symbols=t,this.currentSourceFile=i,this.seen=o}increaseIndent(){this.indent++}decreaseIndent(){this.indent--}getProgram(){return this.symbols.getProgram()}addSource(e){this.source===void 0?this.source=e:this.additionalSources.add(e)}addAdditionalSource(e){if(e!==void 0)for(let t of e)this.additionalSources.add(t)}isEmpty(){return this.lines.length===0||this.source===void 0}snippet(e,t,i){if(this.source===void 0)throw new N("No source",N.NoSourceFile);return this.additionalSources.delete(this.source),ye.create(this.source,this.additionalSources.size===0?void 0:[...this.additionalSources],this.lines.join(`
`),e,t,i)}addDeclaration(e){let t=e.getSourceFile();if(t.fileName===this.currentSourceFile.fileName||this.skipDeclaration(e,t))return;let i=de.getLines(e,t);this.indent===0?this.lines.push(...i):this.lines.push(...i.map(o=>`${"	".repeat(this.indent)}${o})`)),this.addSource(t.fileName)}addTypeNode(e){if(L.isTypeReferenceNode(e)){let t=this.symbols.getLeafSymbolAtLocation(e.typeName);t!==void 0&&this.addTypeSymbol(t,e.typeName.getText())}else if(L.isUnionTypeNode(e)||L.isIntersectionTypeNode(e))for(let t of e.types)this.addTypeNode(t)}addClassSymbol(e,t,i=!0,o=!1){if(!I.Symbols.isClass(e)||this.seen.manages(e))return;let r=this.getSymbolInfo(e);r.skip||this.addEmitter(new Re(this.session,this.symbols,r.primary,e,t,i,o))}addInterfaceSymbol(e,t){if(!I.Symbols.isInterface(e)||this.seen.manages(e))return;let i=this.getSymbolInfo(e);i.skip||this.addEmitter(new Ee(this.session,this.symbols,i.primary,e,t))}addTypeAliasSymbol(e,t){if(!I.Symbols.isTypeAlias(e)||this.seen.manages(e))return;let i=this.getTypeToEmit(e);if(i===void 0)return;let o=this.getSymbolInfo(i);if(o.skip)return;let r=o.primary;I.Symbols.isClass(i)?this.addEmitter(new Re(this.session,this.symbols,r,i,t,!0,!1)):I.Symbols.isInterface(i)?this.addEmitter(new Ee(this.session,this.symbols,r,i,t)):I.Symbols.isTypeLiteral(i)&&this.addEmitter(new pt(this.session,r,i,t))}addEnumSymbol(e,t){if(!I.Symbols.isEnum(e)||this.seen.manages(e))return;let i=this.getSymbolInfo(e);i.skip||this.addEmitter(new ut(this.session,i.primary,e,t))}addFunctionSymbol(e,t){if(!I.Symbols.isFunction(e)||this.seen.manages(e))return;let i=this.getSymbolInfo(e);i.skip||this.addEmitter(new mt(this.session,i.primary,e,t))}addModuleSymbol(e,t){if(!I.Symbols.isValueModule(e)||this.seen.manages(e))return;let i=this.getSymbolInfo(e);i.skip||this.addEmitter(new ft(this.session,i.primary,e,t))}addTypeSymbol(e,t){t??=e.getName(),I.Symbols.isClass(e)?this.addClassSymbol(e,t):I.Symbols.isInterface(e)?this.addInterfaceSymbol(e,t):I.Symbols.isTypeAlias(e)?this.addTypeAliasSymbol(e,t):I.Symbols.isEnum(e)?this.addEnumSymbol(e,t):I.Symbols.isFunction(e)?this.addFunctionSymbol(e,t):I.Symbols.isValueModule(e)&&this.addModuleSymbol(e,t)}addType(e){let t=e.getSymbol();if(t!==void 0&&this.addTypeSymbol(t),I.Types.isIntersection(e)||I.Types.isUnion(e))for(let i of e.types)this.addType(i)}addEmitter(e){let t,i,o;if(e.key!==void 0){let r=this.session.getCachedCode(e.key);r!==void 0&&(t=r.value,i=r.uri,o=r.additionalUris)}(t===void 0||i===void 0)&&(e.emit(this.currentSourceFile),t=e.lines,i=e.source,o=e.getAdditionalSources(),e.key!==void 0&&this.session.cacheCode(e.key,{value:t,uri:i,additionalUris:o})),this.indent===0?this.lines.push(...t):this.lines.push(...t.map(r=>`${"	".repeat(this.indent)}${r}`)),this.addSource(i),this.addAdditionalSource(o)}getTypeToEmit(e){if(!I.Symbols.isTypeAlias(e))return;let t=e.declarations;if(t!==void 0){for(let i of t)if(L.isTypeAliasDeclaration(i)){let o=i.type;if(L.isTypeLiteralNode(o)){let r=this.symbols.getSymbolAtLocation(o);if(I.Symbols.isTypeLiteral(r))return r}else if(L.isTypeReferenceNode(o)){let r=this.symbols.getLeafSymbolAtLocation(o.typeName);if(I.Symbols.isInterface(r)||I.Symbols.isTypeLiteral(r)||I.Symbols.isTypeLiteral(r))return r}}}}}});var Y,re,yt,Me,ht,Le,St,Mt=V(()=>{"use strict";J();ce();W();z();Y=X(Z()),re=A(),yt=class c extends j{classDeclaration;stateProvider;abstractMembers;extends;implements;constructor(e,t,i,o){if(super(e,t),i instanceof c){let r=i;this.classDeclaration=j.getNodeInProgram(e,r.classDeclaration),this.stateProvider=r.stateProvider,this.abstractMembers=r.abstractMembers;let l=a=>{let p=a.type,u=e.getSourceFile(p.getSourceFile().fileName);if(u!==void 0){let S=Y.default.getTokenAtPosition(u,p.pos);if(re.isExpressionWithTypeArguments(S)){let b=t.getSymbolAtLocation(S.expression);if(b!==void 0&&!this.getSymbolInfo(b).skip)return{symbol:b,type:S,abstractMembers:a.abstractMembers}}}};if(r.extends!==void 0&&(this.extends=l(r.extends)),r.implements!==void 0){let a;for(let p of r.implements){let u=l(p);u!==void 0&&(a=a??[],a.push(u))}this.implements=a}}else{let r=i;this.classDeclaration=r,this.stateProvider=o;let l=r.heritageClauses;if(l===void 0){this.abstractMembers=0,this.extends=void 0,this.implements=void 0;return}let a=0,p,u;for(let S of l)if(S.token===re.SyntaxKind.ExtendsKeyword){if(S.types.length===1){let b=S.types[0],C=this.getHeritageSymbol(b.expression);if(C!==void 0&&!this.getSymbolInfo(C).skip){let v=this.getNumberOfAbstractMembers(C);a+=v,p={symbol:C,type:b,abstractMembers:v}}}}else if(S.token===re.SyntaxKind.ImplementsKeyword)for(let b of S.types){let C=this.getHeritageSymbol(b.expression);if(C!==void 0&&!this.getSymbolInfo(C).skip){u=u??[];let v=this.getNumberOfAbstractMembers(C);a+=v,u.push({symbol:C,type:b,abstractMembers:v})}}u!==void 0&&u.sort((S,b)=>b.abstractMembers-S.abstractMembers),this.abstractMembers=a,this.extends=p,this.implements=u}}with(e){return e===this.program?this:new c(e,new Y.Symbols(e),this)}*all(){this.extends!==void 0&&(yield this.extends),this.implements!==void 0&&(yield*this.implements)}isSame(e){return this.classDeclaration===e||this.classDeclaration.getSourceFile().fileName===e.getSourceFile().fileName&&this.classDeclaration.pos===e.pos}score(e,t){if(this.abstractMembers===0){if(this.extends===void 0)return-1;let a=this.extends.symbol.declarations;if(a===void 0)return-1;for(let p of a)if(e.getSourceFile(p.getSourceFile().fileName)===void 0)return-1;return 1}let i;for(let a of this.all())if(a.symbol.declarations!==void 0)for(let p of a.symbol.declarations){let u=p.getSourceFile();if(e.getSourceFile(u.fileName)!==void 0){i??=0,i+=a.abstractMembers;break}}if(i===void 0)return-1;let o=i/this.abstractMembers,r=t.neighborFiles;if(r.length===0)return o;let l=Math.pow(10,r.length.toString().length);o*=l;for(let a of r)e.getSourceFile(a)!==void 0&&(o+=1);return o}run(e,t){if(this.extends===void 0&&this.implements===void 0)return;let i,o=new Map([...this.all()].map(r=>[r.symbol,r]));for(let r of this.all()){let a=r.symbol.declarations;if(a===void 0)continue;let p=new Set;for(let u of a){if(!re.isClassDeclaration(u)&&!re.isInterfaceDeclaration(u)&&!re.isTypeAliasDeclaration(u)||u.name===void 0)continue;let S=u.getSourceFile();if(p.has(S.fileName))continue;let b=new Y.ReferencedByVisitor(this.program,S,e.getPreferredNeighborFiles(this.program),this.stateProvider,t);for(let C of b.entries()){t.throwIfCancellationRequested();for(let v of Y.ClassDeclarations.entries(C)){if(v.heritageClauses===void 0||this.isSame(v))continue;let w;for(let U of v.heritageClauses)for(let ae of U.types){let Q=this.getHeritageSymbol(ae.expression);if(Q===void 0)continue;let ve=o.get(Q);ve!==void 0&&(w??=0,w+=ve.abstractMembers)}if(w!==void 0&&(i===void 0?i={declaration:v,matchesAbstractMembers:w}:w>i.matchesAbstractMembers&&(i={declaration:v,matchesAbstractMembers:w})),i!==void 0&&i.matchesAbstractMembers===this.abstractMembers)return i}}}}}getNumberOfAbstractMembers(e){return this.symbols.getMemberStatistic(e).abstract.size}},Me=class extends O{classDeclaration;constructor(e,t,i,o){super(e,t,i,2),this.classDeclaration=o}compute(e,t){t.throwIfCancellationRequested();let i=this.symbols,o=i.getSymbolAtLocation(this.classDeclaration.name??this.classDeclaration);if(o===void 0||!Y.Symbols.isClass(o)||o.declarations===void 0)return;let r=this.createCacheInfo(o,"superClass",this.classDeclaration.members,this.classDeclaration.getSourceFile()),l=r!==void 0?this.context.getCachedContextItem(r.key):void 0;if(l!==void 0)e.addCachedContextItem(l);else{let a=this.context.getSeenSymbols(this.session,this.getProgram()),p=this.classDeclaration.getSourceFile(),[u,S]=i.getExtendsSymbol(o);if(u!==void 0&&S!==void 0){let b=new B(this.session,i,p,a);b.addClassSymbol(u,S,!0,!1),e.addSnippet(b,"superClass",.9,r),a.add(u)}}}},ht=class extends O{classDeclaration;constructor(e,t,i,o){super(e,t,i,3),this.classDeclaration=o}compute(e,t){t.throwIfCancellationRequested();let i=this.getProgram(),o=this.classDeclaration,r=this.symbols.getSymbolAtLocation(o.name??o);if(r===void 0||!Y.Symbols.isClass(r))return;let l=this.createCacheInfo(r,"blueprint",o),a=l!==void 0?this.context.getCachedContextItem(l.key):void 0;if(a!==void 0)e.addCachedContextItem(a);else{let p=new yt(i,this.symbols,o);if(p.extends===void 0&&p.implements===void 0)return;let[u,S]=this.session.run(p,this.context,t);if(u===void 0||S===void 0)return;let b=new B(this.session,this.context.getSymbols(u),o.getSourceFile(),this.context.getSeenSymbols(this.session,u));b.addDeclaration(S.declaration),e.addSnippet(b,"blueprint",1,l)}}},Le=class c extends ${static create(e,t){return e.members===void 0||e.members.length===0?new St(e,t):new c(e,t)}classDeclaration;constructor(e,t){super("class"),this.classDeclaration=e}provide(e,t,i,o,r){r.throwIfCancellationRequested(),e.push(new Me(t,i,o,this.classDeclaration))}},St=class extends ${classDeclaration;constructor(e,t){super("wholeClass",re.SymbolFlags.Function),this.classDeclaration=e}getImportsByCacheRange(){return this._getImportsByCacheRange(this.classDeclaration)}provide(e,t,i,o,r){r.throwIfCancellationRequested(),e.push(new Me(t,i,o,this.classDeclaration)),t.enableBlueprintSearch()&&e.push(new ht(t,i,o,this.classDeclaration))}}});var ue,q,ee,te,ne,Ve=V(()=>{"use strict";J();ce();W();z();ue=X(Z()),q=A(),ee=class extends O{tokenInfo;excludes;priority;constructor(e,t,i,o,r,l=1){super(e,t,i,1),this.tokenInfo=o,this.excludes=r,this.priority=l}compute(e,t){t.throwIfCancellationRequested();let i=this.tokenInfo.previous??this.tokenInfo.token??this.tokenInfo.touching,r=this.symbols.getTypeChecker(),l=r.getSymbolsInScope(i,q.SymbolFlags.BlockScopedVariable);if(l.length===0)return;let a=i.getSourceFile(),p=this.context.getSeenSymbols(this.session,this.getProgram());for(let u of l){if(t.throwIfCancellationRequested(),p.has(u)||this.excludes.has(u))continue;let S=ue.Symbols.getPrimarySourceFile(u);if(S!==a||this.skipSourceFile(S))continue;let b=ue.Symbols.getDeclaration(u,q.SyntaxKind.VariableDeclaration);if(b!==void 0){if(b.type!==void 0){let C=new B(this.session,this.symbols,a,p);C.addTypeNode(b.type),e.addSnippet(C,"completion",this.priority)}else{let C=r.getTypeAtLocation(b.type??b),v=new B(this.session,this.symbols,a,p);v.addType(C),e.addSnippet(v,"completion",this.priority)}p.add(u)}}}},te=class extends O{tokenInfo;excludes;priority;constructor(e,t,i,o,r,l=1){super(e,t,i,2),this.tokenInfo=o,this.excludes=r,this.priority=l}compute(e,t){t.throwIfCancellationRequested();let i=this.tokenInfo.previous??this.tokenInfo.token??this.tokenInfo.touching,l=this.symbols.getTypeChecker().getSymbolsInScope(i,q.SymbolFlags.Class|q.SymbolFlags.Interface|q.SymbolFlags.TypeAlias|q.SymbolFlags.Enum|q.SymbolFlags.Alias);if(l.length===0)return;let a=i.getSourceFile(),p=this.context.getSeenSymbols(this.session,this.getProgram());for(let u of l){if(t.throwIfCancellationRequested(),p.has(u)||this.excludes.has(u))continue;let S=ue.Symbols.getPrimarySourceFile(u);if(S===void 0||this.skipSourceFile(S))continue;let b=u,C=u.name;if(ue.Symbols.isAlias(u)){let w=this.symbols.getLeafAliasedSymbol(u);w!==void 0&&(w.flags&(q.SymbolFlags.Class|q.SymbolFlags.Interface|q.SymbolFlags.TypeAlias|q.SymbolFlags.Enum))!==0?b=w:b=void 0}if(b===void 0||p.has(b)||this.excludes.has(b))continue;if(b!==u){let w=ue.Symbols.getPrimarySourceFile(b);if(w===void 0||this.skipSourceFile(w)||w===a)continue}let v=new B(this.session,this.symbols,a,p);if(v.addTypeSymbol(b,C),e.addSnippet(v,"completion",this.priority),p.add(b),e.tokenBudget.isExhausted())break}}},ne=class c extends O{expression;priority;constructor(e,t,i,o,r){super(e,t,i,2),this.expression=o,this.priority=r}static provide(e,t,i,o,r,l){let a=r.previous;if(!(a===void 0||a.parent===void 0)&&(q.isIdentifier(a)||a.kind===q.SyntaxKind.DotToken)&&q.isPropertyAccessExpression(a.parent)){let p=this.getRightMostIdentifier(a.parent.expression,0);if(p!==void 0){let u=new c(t,i,o,p,1);e.push(u)}}}static getRightMostIdentifier(e,t){if(t!==32)switch(e.kind){case q.SyntaxKind.Identifier:return e;case q.SyntaxKind.PropertyAccessExpression:return this.getRightMostIdentifier(e.name,t+1);case q.SyntaxKind.ElementAccessExpression:return this.getRightMostIdentifier(e.argumentExpression,t+1);case q.SyntaxKind.CallExpression:return this.getRightMostIdentifier(e.expression,t+1);default:return}}compute(e,t){t.throwIfCancellationRequested();let i=this.symbols.getLeafSymbolAtLocation(this.expression);if(i===void 0)return;let o=this.symbols.getTypeChecker(),r=this.context.getSeenSymbols(this.session,this.getProgram());if(r.has(i))return;let l=o.getTypeOfSymbolAtLocation(i,this.expression),a=l.getConstructSignatures().concat(l.getCallSignatures()),p=this.expression.getSourceFile();for(let b of a){t.throwIfCancellationRequested();let C=b.getReturnType(),v=C.aliasSymbol??C.getSymbol();if(v===void 0||r.has(v))continue;let w=new B(this.session,this.symbols,p,r);w.addTypeSymbol(v,v.name),e.addSnippet(w,"completion",this.priority)}let u=l.getSymbol();if(u===void 0||r.has(u))return;let S=new B(this.session,this.symbols,p,r);S.addTypeSymbol(u,u.name),e.addSnippet(S,"completion",this.priority),r.add(u)}}});var ge,Oe,xe,se,Je=V(()=>{"use strict";J();ce();W();z();ge=A(),Oe=class c extends O{static traitsToCollect=[["module","The TypeScript module system used in this project is ",1,G.makeContextItemKey("module"),ge.ModuleKind],["moduleResolution","The TypeScript module resolution strategy used in this project is ",1,G.makeContextItemKey("moduleResolution"),ge.ModuleResolutionKind],["target","The target version of JavaScript for this project is ",1,G.makeContextItemKey("target"),ge.ScriptTarget],["lib","Library files that should be included in TypeScript compilation are ",1,G.makeContextItemKey("lib"),void 0]];document;constructor(e,t,i,o){super(e,t,i,1),this.document=o}compute(e,t){t.throwIfCancellationRequested();let i=this.getProgram().getCompilerOptions(),o=this.context,r=o.getCachedContextItem(G.makeContextItemKey("version"));r!==void 0?e.addCachedContextItem(r):e.addTrait("version",.5,"The TypeScript version used in this project is ",ge.version,this.document);for(let[l,a,p,u,S]of c.traitsToCollect){let b=o.getCachedContextItem(u);if(b!==void 0)e.addCachedContextItem(b);else{let C=i[l];if(C){if(typeof C=="number"){let v=c.getEnumName(S,C);v&&(C=v)}e.addTrait(l,p,a,C.toString(),this.document)}}}}static getEnumName(e,t){return Object.keys(e).find(i=>e[i]===t)}},xe=class extends O{declaration;sourceFile;constructor(e,t,i,o,r){super(e,t,i,r),this.declaration=o,this.sourceFile=o.getSourceFile()}getCacheInfo(e){let t=this.getSymbol();if(t===void 0)return;let i=this.declaration.body;if(!(i===void 0||!ge.isBlock(i)))return this.createCacheInfo(t,e,i)}},se=class extends xe{priority;constructor(e,t,i,o,r){super(e,t,i,o,1),this.priority=r}getSymbol(){return this.symbols.getSymbolAtLocation(this.declaration?.name??this.declaration)}compute(e,t){let i=this.getCacheInfo("signature"),o=this.context.getSeenSymbols(this.session,this.getProgram()),r=this.declaration.parameters;for(let a=0;a<r.length;a++){t.throwIfCancellationRequested();let p=i===void 0?void 0:{...i,key:`${i.key} #p${a} `},u=p!==void 0?this.context.getCachedContextItem(p.key):void 0;if(u!==void 0)e.addCachedContextItem(u);else{let b=this.declaration.parameters[a].type;if(b===void 0)continue;this.processSymbol(e,b,this.priority,o,p)}}let l=this.declaration.type;if(l!==void 0){t.throwIfCancellationRequested();let a=i===void 0?void 0:{...i,key:`${i.key} #rt`},p=a!==void 0?this.context.getCachedContextItem(a.key):void 0;p!==void 0?e.addCachedContextItem(p):this.processSymbol(e,l,this.priority,o,a)}}processSymbol(e,t,i,o,r){let l=new B(this.session,this.symbols,this.sourceFile,o);l.addTypeNode(t),e.addSnippet(l,"signature",i,r)}}});var Ce,pe,Lt=V(()=>{"use strict";J();Ve();W();Je();z();Ce=A(),pe=class extends ${functionDeclaration;tokenInfo;isCallableProvider;constructor(e,t){super("function",Ce.SymbolFlags.Function|Ce.SymbolFlags.ValueModule),this.functionDeclaration=e,this.tokenInfo=t,this.isCallableProvider=!0}provide(e,t,i,o,r){e.push(new se(t,i,o,this.functionDeclaration,1)),this.isEmptyBody()?e.push(new te(t,i,o,this.tokenInfo,new Set,1)):(e.push(new ee(t,i,o,this.tokenInfo,new Set,1)),ne.provide(e,t,i,o,this.tokenInfo,r))}isEmptyBody(){return Ce.isArrowFunction(this.functionDeclaration)?this.functionDeclaration.body===void 0?!0:Ce.isExpression(this.functionDeclaration.body)?!1:Ce.isBlock(this.functionDeclaration.body)?this.functionDeclaration.body.statements.length===0:!1:this.functionDeclaration.body===void 0||this.functionDeclaration.body.statements.length===0}}});var D,E,je,Te,He,bt,gt,xt,Ue,Ct,ze,$e,Tt,Kt,Qe,Bt=V(()=>{"use strict";J();ce();Ve();W();Je();z();D=X(Z()),E=A(),je=class extends j{declaration;stateProvider;constructor(e,t,i,o){super(e,t),this.declaration=i,this.stateProvider=o}isSame(e){return this.declaration===e||this.declaration.getSourceFile().fileName===e.getSourceFile().fileName&&this.declaration.pos===e.pos}score(e,t){if(e.getSourceFile(this.declaration.getSourceFile().fileName)===void 0)return 0;let i=t.neighborFiles;if(i.length===0)return 1;let o=Math.pow(10,i.length.toString().length);for(let r of i)e.getSourceFile(r)!==void 0&&(o+=1);return o}},Te=class extends je{constructor(e,t,i,o){super(e,t,i,o)}static create(e,t,i,o){let r=i.parent;if(!E.isClassDeclaration(r))return;let l=D.Declarations.isPrivate(i),a=[],p;if(!l){let u=t.getSymbolAtLocation(r.name!==void 0?r.name:r);if(u===void 0||!D.Symbols.isClass(u))return;let S=E.escapeLeadingUnderscores(i.name.getText()),b,C=!1;for(let[v,w]of t.getAllSuperTypesWithPath(u)){if(u===v&&(C=!1,b=[]),C)continue;b.push(w);let U=w.members?.get(S);if(U!==void 0){if(D.Symbols.isInterface(w)||D.Symbols.isTypeLiteral(w))a.push(...b),C=!0;else if(D.Symbols.isClass(w))if(D.Symbols.isAbstract(U)){p=w;break}else{p=w;break}}}}if(l){let u=D.ClassDeclarations.getExtendsClause(r);if(u===void 0||u.types.length===0)return;{let S=t.getLeafSymbolAtLocation(u.types[0].expression);return S===void 0||!D.Symbols.isClass(S)?void 0:new bt(e,t,r,S,i,o)}}else{if(p!==void 0)return new gt(e,t,r,i,p,o);if(a.length>0){let u=a.filter(S=>{if(D.Symbols.isTypeLiteral(S))return!1;let b=S.escapedName;return!(b==="__type"||b==="__class")});return new xt(e,t,r,i,u,o)}else return}}},He=class c extends je{classDeclaration;extendsSymbol;constructor(e,t,i,o,r,l){if(i instanceof c){let a=i,p=j.getNodeInProgram(e,a.declaration);super(e,t,p,a.stateProvider),this.classDeclaration=j.getNodeInProgram(e,a.classDeclaration);let u=a.extendsSymbol.declarations;if(u===void 0||u.length===0)throw new Error("No declarations found for extends symbol");let S;for(let b of u)if(E.isClassDeclaration(b)){let C=D.ClassDeclarations.getExtendsClause(b);if(C===void 0||C.types.length===0)throw new Error("No extends clause found");if(S=this.symbols.getSymbolAtLocation(C.types[0].expression),S===void 0||!D.Symbols.isClass(S))throw new Error("No extends symbol found");break}if(S===void 0)throw new Error("No extends symbol found");this.extendsSymbol=S}else super(e,t,r,l),this.classDeclaration=i,this.extendsSymbol=o}run(e,t){let i=this.getMemberName();for(let o of this.symbols.getDirectSubTypes(this.extendsSymbol,e.getPreferredNeighborFiles(this.program),this.stateProvider,t))if(t.throwIfCancellationRequested(),o.members!==void 0){let r=o.members.get(i);if(r===void 0)continue;let l=r.declarations;if(l===void 0||l.length===0)continue;for(let a of l){if(a.kind!==this.declaration.kind)continue;let p=a.parent;if(!(!E.isClassDeclaration(p)||p===this.classDeclaration))return p}}}},bt=class c extends He{constructor(e,t,i,o,r,l){i instanceof c?super(e,t,i):super(e,t,i,o,r,l)}with(e){return e===this.program?this:new c(e,new D.Symbols(e),this)}getMemberName(){return E.escapeLeadingUnderscores(this.declaration.name.getText())}},gt=class c extends Te{classDeclaration;startClass;constructor(e,t,i,o,r,l){if(i instanceof c){let a=i,p=j.getNodeInProgram(e,a.declaration);super(e,t,p,a.stateProvider),this.classDeclaration=j.getNodeInProgram(e,a.classDeclaration);let S=a.startClass.declarations;if(S===void 0||S.length===0)throw new N("No declarations found for start class",N.NoDeclaration);let b;for(let C of S)if(E.isClassDeclaration(C)&&(b=this.symbols.getSymbolAtLocation(C.name?C.name:C),b!==void 0))break;if(b===void 0)throw new N("No symbol found for start class",N.SymbolNotFound);this.startClass=b}else super(e,t,o,l),this.classDeclaration=i,this.startClass=r}with(e){return e===this.program?this:new c(e,new D.Symbols(e),this)}run(e,t){if(!D.Symbols.isClass(this.startClass))return;let i=E.escapeLeadingUnderscores(this.declaration.name.getText());for(let o of this.symbols.getAllSubTypes(this.startClass,D.Traversal.breadthFirst,e.getPreferredNeighborFiles(this.program),this.stateProvider,t))if(t.throwIfCancellationRequested(),o.members!==void 0){let r=o.members.get(i);if(r===void 0)continue;let l=r.declarations;if(l===void 0||l.length===0)continue;for(let a of l){if(!E.isMethodDeclaration(a))continue;let p=a.parent;if(!(!E.isClassDeclaration(p)||p===this.classDeclaration))return p}}}},xt=class c extends Te{classDeclaration;typesToCheck;constructor(e,t,i,o,r,l){if(i instanceof c){let a=i,p=j.getNodeInProgram(e,a.declaration);super(e,t,p,a.stateProvider),this.classDeclaration=j.getNodeInProgram(e,a.classDeclaration);let u=[];for(let S of a.typesToCheck){let b=S.declarations;if(b===void 0||b.length===0)throw new N("No declarations found for start class",N.NoDeclaration);let C;for(let v of b)if(!(!E.isClassDeclaration(v)&&!E.isInterfaceDeclaration(v))&&(C=this.symbols.getSymbolAtLocation(v.name?v.name:v),C!==void 0&&C.flags===S.flags))break;if(C===void 0)throw new N("No symbol found for start class",N.SymbolNotFound);u.push(C)}this.typesToCheck=u}else super(e,t,o,l),this.classDeclaration=i,this.typesToCheck=r}with(e){return e===this.program?this:new c(e,new D.Symbols(e),this)}run(e,t){let i=E.escapeLeadingUnderscores(this.declaration.name.getText()),o=new Set(this.typesToCheck),r=[];for(let a of this.typesToCheck){t.throwIfCancellationRequested();for(let p of this.symbols.getDirectSubTypes(a,e.getPreferredNeighborFiles(this.program),this.stateProvider,t))if(t.throwIfCancellationRequested(),!o.has(p)){if(D.Symbols.isClass(p)){let u=p.members?.get(i);if(u!==void 0&&!D.Symbols.isAbstract(u)){let S=D.ClassDeclarations.fromSymbol(p);if(S===this.classDeclaration)continue;if(S!==void 0)return S}}r.push(p)}}let l=new Set;for(let a of r)if(t.throwIfCancellationRequested(),!l.has(a)){for(let p of this.symbols.getAllSubTypes(a,D.Traversal.breadthFirst,e.getPreferredNeighborFiles(this.program),this.stateProvider,t))if(t.throwIfCancellationRequested(),!l.has(p)){if(D.Symbols.isClass(p)){let u=p.members?.get(i);if(u!==void 0&&!D.Symbols.isAbstract(u)){let S=D.ClassDeclarations.fromSymbol(p);if(S===this.classDeclaration){l.add(p);continue}if(S!==void 0)return S}}l.add(p)}l.add(a)}}},Ue=class extends xe{constructor(e,t,i,o){super(e,t,i,o,3)}compute(e,t){t.throwIfCancellationRequested();let i=this.getCacheInfo("blueprint"),o=i!==void 0?this.context.getCachedContextItem(i.key):void 0;if(o!==void 0)e.addCachedContextItem(o);else{if(this.getSymbol()===void 0)return;let l=this.createSearch(t);if(l!==void 0){let[a,p]=this.session.run(l,this.context,t);if(a!==void 0&&p!==void 0){let u=this.declaration.getSourceFile(),S=new B(this.session,this.context.getSymbols(a),u,this.context.getSeenSymbols(this.session,a));S.addDeclaration(p),e.addSnippet(S,"blueprint",1,i)}}}}},Ct=class extends Ue{constructor(e,t,i,o){super(e,t,i,o)}createSearch(){return Te.create(this.getProgram(),this.symbols,this.declaration,this.session)}getSymbol(){let e=this.symbols.getSymbolAtLocation(this.declaration.name);return D.Symbols.isMethod(e)?e:void 0}},ze=class extends ${declaration;isCallableProvider;constructor(e,t,i){super(e,t),this.declaration=i,this.isCallableProvider=!0}getImportsByCacheRange(){let e=this.declaration.parent;return E.isClassDeclaration(e)?this._getImportsByCacheRange(e):void 0}getTypeExcludes(e,t){let i=new Set,o=this.declaration.parent;if(E.isClassDeclaration(o)&&o.heritageClauses!==void 0&&o.heritageClauses.length>0){let r=e.getProgram();if(r!==void 0){let l=t.getSymbols(r);for(let a of o.heritageClauses)if(a.token===E.SyntaxKind.ExtendsKeyword)for(let p of a.types){let u=l.getSymbolAtLocation(p.expression);if(u!==void 0&&D.Symbols.isClass(u))return i.add(u)}}}return i}},$e=class extends ze{tokenInfo;constructor(e,t){super(e.body===void 0||e.body.statements.length===0?"wholeMethod":"method",E.SymbolFlags.Function,e),this.tokenInfo=t}provide(e,t,i,o,r){r.throwIfCancellationRequested(),e.push(new se(t,i,o,this.declaration,.9)),t.enableBlueprintSearch()&&e.push(new Ct(t,i,o,this.declaration)),this.contextKind==="wholeMethod"?e.push(new te(t,i,o,this.tokenInfo,this.getTypeExcludes(i,o),.9)):(e.push(new ee(t,i,o,this.tokenInfo,this.getTypeExcludes(i,o),.9)),ne.provide(e,t,i,o,this.tokenInfo,r))}},Tt=class c extends He{constructor(e,t,i,o,r,l){i instanceof c?super(e,t,i):super(e,t,i,o,r,l)}with(e){return e===this.program?this:new c(e,new D.Symbols(e),this)}getMemberName(){return E.InternalSymbolName.Constructor}},Kt=class extends Ue{constructor(e,t,i,o){super(e,t,i,o)}createSearch(){let e=this.declaration.parent;if(!E.isClassDeclaration(e))return;let t=D.ClassDeclarations.getExtendsClause(e);if(!(t===void 0||t.types.length===0)){let i=this.symbols.getLeafSymbolAtLocation(t.types[0].expression);return i===void 0||!D.Symbols.isClass(i)?void 0:new Tt(this.getProgram(),this.symbols,e,i,this.declaration,this.session)}}getSymbol(){let e=this.symbols.getSymbolAtLocation(this.declaration);return D.Symbols.isConstructor(e)?e:void 0}},Qe=class extends ze{tokenInfo;constructor(e,t){super(e.body===void 0||e.body.statements.length===0?"wholeConstructor":"constructor",E.SymbolFlags.Function,e),this.tokenInfo=t}provide(e,t,i,o,r){r.throwIfCancellationRequested(),e.push(new se(t,i,o,this.declaration,.9)),t.enableBlueprintSearch()&&e.push(new Kt(t,i,o,this.declaration)),this.contextKind==="wholeConstructor"?e.push(new te(t,i,o,this.tokenInfo,this.getTypeExcludes(i,o),.9)):(e.push(new ee(t,i,o,this.tokenInfo,this.getTypeExcludes(i,o),.9)),ne.provide(e,t,i,o,this.tokenInfo,r))}}});var Ke,me,vt,Ge,qt=V(()=>{"use strict";J();ce();Ve();W();z();Ke=X(Z()),me=A(),vt=class extends O{tokenAtCursor;symbolsToQuery;constructor(e,t,i,o,r,l=1){super(e,t,i,l),this.tokenAtCursor=o,this.symbolsToQuery=r}compute(e,t){t.throwIfCancellationRequested();let i=this.getProgram(),o=this.symbols,r=this.context.getSeenSymbols(this.session,i),l=this.tokenAtCursor.getSourceFile(),a=this.getModulesAndFunctionsInScope(i,o.getTypeChecker(),l);t.throwIfCancellationRequested();let p=new B(this.session,o,l,r);for(let u of a.functions.real)p.addFunctionSymbol(u);t.throwIfCancellationRequested();for(let{alias:u,real:S}of a.functions.aliased)p.addFunctionSymbol(S,u.getName());t.throwIfCancellationRequested(),p.isEmpty()||e.addSnippet(p,"generalScope",.8),p=new B(this.session,o,l,r);for(let{alias:u,real:S}of a.modules)p.addModuleSymbol(S,u.getName());t.throwIfCancellationRequested(),p.isEmpty()||e.addSnippet(p,"generalScope",.8)}getModulesAndFunctionsInScope(e,t,i){let o={functions:{real:[],aliased:[]},modules:[]},r=t.getSymbolsInScope(this.tokenAtCursor,this.symbolsToQuery|me.SymbolFlags.Alias);for(let l of r){let a=l.declarations;if(a!==void 0)for(let p of a){let u=p.getSourceFile();if(!(e.isSourceFileDefaultLibrary(u)||e.isSourceFileFromExternalLibrary(u))){if(Ke.Symbols.isFunction(l)&&this.includeFunctions()&&u!==i){o.functions.real.push(l);break}else if(Ke.Symbols.isAlias(l)){let S=t.getAliasedSymbol(l);if(Ke.Symbols.isFunction(S)&&this.includeFunctions()){o.functions.aliased.push({alias:l,real:S});break}else if(Ke.Symbols.isValueModule(S)&&this.includeValueModules()){o.modules.push({alias:l,real:S});break}}}}}return o}includeFunctions(){return(this.symbolsToQuery&me.SymbolFlags.Function)!==0}includeValueModules(){return(this.symbolsToQuery&me.SymbolFlags.ValueModule)!==0}},Ge=class extends ${tokenInfo;computeInfo;constructor(e,t){super("sourceFile",me.SymbolFlags.Function),this.tokenInfo=e,this.computeInfo=t}provide(e,t,i,o,r){r.throwIfCancellationRequested();let l=this.computeInfo.getSymbolsToQuery();l!==void 0&&l!==me.SymbolFlags.None&&e.push(new vt(t,i,o,this.tokenInfo.token,l,2)),this.computeInfo.hasCallableProvider()||(this.hasVariableDeclarations()?e.push(new ee(t,i,o,this.tokenInfo,new Set,1)):e.push(new te(t,i,o,this.tokenInfo,new Set,1)),ne.provide(e,t,i,o,this.tokenInfo,r))}hasVariableDeclarations(){let e=this.tokenInfo.token.getSourceFile();for(let t of e.statements)if(me.isVariableStatement(t))return!0;return!1}}});function _t(c,e,t,i,o,r,l,a){let p=t.getProgram();if(p===void 0)return;let u=p.getSourceFile(i);if(u===void 0)return;let S=Ft.default.getRelevantTokens(u,o);new kt(i,S,r,l).execute(c,e,t,a)}var Ft,H,It,kt,Vt=V(()=>{"use strict";J();Mt();W();Lt();Bt();Je();z();qt();Ft=X(Z()),H=A(),It=class{callableProvider;completionKind;symbolsToQuery;importsByCacheRange;constructor(){this.completionKind=void 0,this.symbolsToQuery=H.SymbolFlags.None,this.callableProvider=!1}update(e){return this.completionKind===void 0&&(this.completionKind=e.contextKind),e.symbolsToQuery!==void 0&&e.symbolsToQuery!==H.SymbolFlags.None&&(this.symbolsToQuery|=e.symbolsToQuery),this.importsByCacheRange===void 0&&typeof e.getImportsByCacheRange=="function"&&(this.importsByCacheRange=e.getImportsByCacheRange()),e.isCallableProvider!==void 0&&e.isCallableProvider===!0&&(this.callableProvider=!0),e}getImportsByCacheRange(){return this.importsByCacheRange}getCompletionKind(){return this.completionKind??"none"}getSymbolsToQuery(){return this.symbolsToQuery}hasCallableProvider(){return this.callableProvider}},kt=class c{static Factories=new Map([[H.SyntaxKind.SourceFile,(e,t,i)=>new Ge(t,i)],[H.SyntaxKind.FunctionDeclaration,(e,t)=>new pe(e,t)],[H.SyntaxKind.ArrowFunction,(e,t)=>new pe(e,t)],[H.SyntaxKind.FunctionExpression,(e,t)=>new pe(e,t)],[H.SyntaxKind.ClassDeclaration,Le.create],[H.SyntaxKind.Constructor,(e,t)=>new Qe(e,t)],[H.SyntaxKind.MethodDeclaration,(e,t)=>new $e(e,t)]]);document;tokenInfo;computeInfo;neighborFiles;knownContextItems;constructor(e,t,i,o){this.document=e,this.tokenInfo=t,this.computeInfo=new It,this.neighborFiles=i,this.knownContextItems=new Map(o.map(r=>[r.key,r]))}execute(e,t,i,o){let r=[];if(this.neighborFiles!==void 0)for(let u of this.neighborFiles)r.push(H.server.toNormalizedPath(u));let l=new De(r,this.knownContextItems),a=this.getContextComputeRunnables(t,i,l,o),p=this.computeInfo.getCompletionKind();e.addMetaData(p,Ft.default.StableSyntaxKinds.getPath(this.tokenInfo.touching??this.tokenInfo.token));for(let u of a){o.throwIfCancellationRequested();try{u.compute(e,o)}catch(S){if(S instanceof N)e.addErrorData(S);else throw S}}t.addComputationStateItems(e,this.computeInfo)}getContextComputeRunnables(e,t,i,o){let r=[];r.push(new Oe(e,t,i,this.document));let l=this.computeProviders();for(let a of l)a.provide(r,e,t,i,o);return r.sort((a,p)=>a.cost-p.cost),r}computeProviders(){let e=[],t=this.tokenInfo.touching;if(t===void 0&&(this.tokenInfo.token===void 0||this.tokenInfo.token.kind===H.SyntaxKind.EndOfFileToken?t=this.tokenInfo.previous:t=this.tokenInfo.token),t===void 0||t.kind===H.SyntaxKind.EndOfFileToken)return e;let i=t;for(;i!==void 0;){let o=c.Factories.get(i.kind);if(o!==void 0){let r=o(i,this.tokenInfo,this.computeInfo);r!==void 0&&e.push(this.computeInfo.update(r))}i=i.parent}return e}}});var Ot,We,Jt=V(()=>{"use strict";Ot=X(require("crypto")),We=class{constructor(){}createHash(e){return Ot.default.createHash(e)}isDebugging(){return process.execArgv.some(e=>/^--(?:inspect|debug)(?:-brk)?(?:=\d+)?$/i.test(e))}}});var Ut={};rn(Ut,{create:()=>un});function un(c){if(jt)return c.languageService;if(c.session!==void 0)try{c.session.addProtocolHandler("_.copilot.ping",()=>({response:Ye,responseRequired:!0}));try{let e=pn();Ye={kind:"ok",session:!0,supported:e,version:Dt.version},e&&(fe=new Pe(c.session,new We),wt=c.languageServiceHost,c.session.addProtocolHandler("_.copilot.context",cn))}catch(e){e instanceof Error?(Ye={kind:"error",message:e.message,stack:e.stack},c.session.logError(e,"_.copilot.installHandler")):(Ye={kind:"error",message:"Unknown error"},c.session.logError(new Error("Unknown error"),"_.copilot.installHandler"))}}catch(e){e instanceof Error?c.session.logError(e,"_.copilot.installPingHandler"):c.session.logError(new Error("Unknown error"),"_.copilot.installPingHandler")}finally{jt=!0}return c.languageService}function pn(){try{let c=Dt.versionMajorMinor.split(".");if(c.length<2)return!1;let e=parseInt(c[0]),t=parseInt(c[1]);return e>5||e===5&&t>=5}catch{return!1}}var Ht,Dt,jt,fe,wt,Ye,cn,zt=V(()=>{"use strict";Vt();W();z();Ht=X(Z());J();Jt();Dt=A(),jt=!1,Ye={kind:"error",message:"Attempt to install context handler failed"},cn=c=>{let e=Date.now();if(c.arguments===void 0)return{response:{error:"noArguments",message:"No arguments provided"},responseRequired:!0};let t=c.arguments,i=fe?.getFileAndProject(t);if(i===void 0)return{response:{error:"noProject",message:"No project found"},responseRequired:!0};if(typeof t.line!="number"||typeof t.offset!="number")return{response:{error:"invalidArguments",message:"No project found"},responseRequired:!0};let{file:o,project:r}=i,l=fe?.getPositionInFile(t,o);if(l===void 0)return{response:{error:"invalidPosition",message:"Position not valid"},responseRequired:!0};let a=c.arguments?.startTime??e,p=typeof t.timeBudget=="number"?t.timeBudget:100;a+p>e&&(a=e,p=100);let u=r.getLanguageService(),S=Date.now(),b=new Ne(typeof t.tokenBudget=="number"?t.tokenBudget:7*1024),C=t.knownContextItems??[],v=t.computationStates??[],w=new Ht.CancellationTokenWithTimer(wt?.getCancellationToken?wt.getCancellationToken():void 0,a,p,fe?.host.isDebugging()??!1),U=new Ae(b);try{w.throwIfCancellationRequested(),fe.applyComputationStates(v),_t(U,fe,u,o,l,t.neighborFiles,C,w)}catch(Q){if(!(Q instanceof Dt.OperationCanceledException)&&!(Q instanceof Se))return Q instanceof Error?{response:{error:"exception",message:Q.message,stack:Q.stack},responseRequired:!0}:{response:{error:"exception",message:"Unknown error"},responseRequired:!0}}let ae=Date.now();return U.addTimings(ae-e,ae-S),{response:{items:U.items,timedOut:w.isTimedOut(),tokenBudgetExhausted:b.isExhausted()},responseRequired:!0}}});J();var $t=!1,Pt;function mn(c){if(!$t)try{A.install(c.typescript),Pt=(zt(),sn(Ut)).create}finally{$t=!0}if(Pt===void 0)throw new Error("Couldn't initialize TypeScript Context Server Plugin.");return{create:Pt}}module.exports=mn;
