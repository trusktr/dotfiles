exports.id=240,exports.ids=[240],exports.modules={1649:(t,e,r)=>{r.r(e),r.d(e,{compressAndSend:()=>l,createHttpAgent:()=>c,sendWithHttp:()=>u});var n=r(8611),i=r(5692),s=r(3106),o=r(2203),a=r(4780);function u(t,e,r,s,o){let u=new URL(t.url),c=Number(process.versions.node.split(".")[0]),p={hostname:u.hostname,port:u.port,path:u.pathname,method:"POST",headers:{...t.headers()},agent:e},d=("http:"===u.protocol?n.request:i.request)(p,t=>{let e=[];t.on("data",t=>e.push(t)),t.on("end",()=>{t.statusCode&&t.statusCode<299?s({status:"success",data:Buffer.concat(e)}):t.statusCode&&[429,502,503,504].includes(t.statusCode)?s({status:"retryable",retryInMillis:function(t){if(null==t)return;let e=Number.parseInt(t,10);if(Number.isInteger(e))return e>0?1e3*e:-1;let r=new Date(t).getTime()-Date.now();return r>=0?r:0}(t.headers["retry-after"])}):s({status:"failure",error:new a.N(t.statusMessage,t.statusCode,Buffer.concat(e).toString())})})});d.setTimeout(o,()=>{d.destroy(),s({status:"failure",error:Error("Request Timeout")})}),d.on("error",t=>{s({status:"failure",error:t})}),d.on(c>=14?"close":"abort",()=>{s({status:"failure",error:Error("Request timed out")})}),l(d,t.compression,r,t=>{s({status:"failure",error:t})})}function l(t,e,r,n){let i=function(t){let e=new o.Readable;return e.push(t),e.push(null),e}(r);"gzip"===e&&(t.setHeader("Content-Encoding","gzip"),i=i.on("error",n).pipe(s.createGzip()).on("error",n)),i.pipe(t).on("error",n)}function c(t,e){return new("http:"===new URL(t).protocol?n.Agent:i.Agent)(e)}},4780:(t,e,r)=>{r.d(e,{N:()=>OTLPExporterError});let OTLPExporterError=class OTLPExporterError extends Error{code;name="OTLPExporterError";data;constructor(t,e,r){super(t),this.data=r,this.code=e}}},8461:(t,e,r)=>{r.r(e),r.d(e,{OpenTelemetryProvider:()=>OpenTelemetryProvider}),(v=y||(y={}))[v.INTERNAL=0]="INTERNAL",v[v.SERVER=1]="SERVER",v[v.CLIENT=2]="CLIENT",v[v.PRODUCER=3]="PRODUCER",v[v.CONSUMER=4]="CONSUMER";let OTLPExporterBase=class OTLPExporterBase{_delegate;constructor(t){this._delegate=t}export(t,e){this._delegate.export(t,e)}forceFlush(){return this._delegate.forceFlush()}shutdown(){return this._delegate.shutdown()}};function n(t){return Object.keys(t).map(e=>(function t(e,r){return{key:e,value:function e(r){let n=typeof r;return"string"===n?{stringValue:r}:"number"===n?Number.isInteger(r)?{intValue:r}:{doubleValue:r}:"boolean"===n?{boolValue:r}:r instanceof Uint8Array?{bytesValue:r}:Array.isArray(r)?{arrayValue:{values:r.map(e)}}:"object"===n&&null!=r?{kvlistValue:{values:Object.entries(r).map(([e,r])=>t(e,r))}}:{}}(r)}})(e,t[e]))}let i=r(2987).performance;function s(t){return[Math.trunc(t/1e3),Math.round(t%1e3*1e6)]}function o(){let t=i.timeOrigin;return"number"!=typeof t&&(t=i.timing&&i.timing.fetchStart),t}function a(t){return Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]}function u(t){return a(t)||"number"==typeof t||t instanceof Date}function l(t,e){let r=[t[0]+e[0],t[1]+e[1]];return r[1]>=1e9&&(r[1]-=1e9,r[0]+=1),r}function c(t){return t>=48&&t<=57?t-48:t>=97&&t<=102?t-87:t-55}function p(t){let e=new Uint8Array(t.length/2),r=0;for(let n=0;n<t.length;n+=2){let i=c(t.charCodeAt(n)),s=c(t.charCodeAt(n+1));e[r++]=i<<4|s}return e}function d(t){let e=BigInt(1e9);return BigInt(t[0])*e+BigInt(t[1])}function h(t){var e=d(t);return{low:Number(BigInt.asUintN(32,e)),high:Number(BigInt.asUintN(32,e>>BigInt(32)))}}let m="undefined"!=typeof BigInt?function(t){return d(t).toString()}:function(t){return 1e9*t[0]+t[1]};function f(t){return t}function _(t){if(void 0!==t)return p(t)}let g={encodeHrTime:h,encodeSpanContext:p,encodeOptionalSpanContext:_},S={serializeRequest:t=>{let e={resourceSpans:function(t,e){let r=function(t){let e=new Map;for(let r of t){let t=e.get(r.resource);t||(t=new Map,e.set(r.resource,t));let n=`${r.instrumentationScope.name}@${r.instrumentationScope.version||""}:${r.instrumentationScope.schemaUrl||""}`,i=t.get(n);i||(i=[],t.set(n,i)),i.push(r)}return e}(t),i=[],s=r.entries(),o=s.next();for(;!o.done;){let[t,r]=o.value,u=[],l=r.values(),c=l.next();for(;!c.done;){let t=c.value;if(t.length>0){var a;let r=t.map(t=>(function(t,e){let r=t.spanContext(),i=t.status,s=t.parentSpanContext?.spanId?e.encodeSpanContext(t.parentSpanContext?.spanId):void 0;return{traceId:e.encodeSpanContext(r.traceId),spanId:e.encodeSpanContext(r.spanId),parentSpanId:s,traceState:r.traceState?.serialize(),name:t.name,kind:null==t.kind?0:t.kind+1,startTimeUnixNano:e.encodeHrTime(t.startTime),endTimeUnixNano:e.encodeHrTime(t.endTime),attributes:n(t.attributes),droppedAttributesCount:t.droppedAttributesCount,events:t.events.map(t=>{var r,i;return r=t,i=e,{attributes:r.attributes?n(r.attributes):[],name:r.name,timeUnixNano:i.encodeHrTime(r.time),droppedAttributesCount:r.droppedAttributesCount||0}}),droppedEventsCount:t.droppedEventsCount,status:{code:i.code,message:i.message},links:t.links.map(t=>{var r,i;return r=t,i=e,{attributes:r.attributes?n(r.attributes):[],spanId:i.encodeSpanContext(r.context.spanId),traceId:i.encodeSpanContext(r.context.traceId),traceState:r.context.traceState?.serialize(),droppedAttributesCount:r.droppedAttributesCount||0}}),droppedLinksCount:t.droppedLinksCount}})(t,e));u.push({scope:{name:(a=t[0].instrumentationScope).name,version:a.version},spans:r,schemaUrl:t[0].instrumentationScope.schemaUrl})}c=l.next()}let p={resource:{attributes:n(t.attributes),droppedAttributesCount:0},scopeSpans:u,schemaUrl:void 0};i.push(p),o=s.next()}return i}(t,function(t){if(void 0===t)return g;let e=t.useLongBits??!0,r=t.useHex??!1;return{encodeHrTime:e?h:m,encodeSpanContext:r?f:p,encodeOptionalSpanContext:r?f:_}}({useHex:!0,useLongBits:!1}))};return new TextEncoder().encode(JSON.stringify(e))},deserializeResponse:t=>JSON.parse(new TextDecoder().decode(t))};(P=E||(E={}))[P.SUCCESS=0]="SUCCESS",P[P.FAILED=1]="FAILED";var v,y,E,b,T,w,O,L,A,P,x,C,R,I,N,D,M,k=r(4780),U="object"==typeof globalThis?globalThis:global,B="1.9.0",j=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/,$=function(t){var e=new Set([t]),r=new Set,n=t.match(j);if(!n)return function(){return!1};var i={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(null!=i.prerelease)return function(e){return e===t};function s(t){return r.add(t),!1}return function(t){if(e.has(t))return!0;if(r.has(t))return!1;var n=t.match(j);if(!n)return s(t);var o={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(null!=o.prerelease||i.major!==o.major)return s(t);if(0===i.major)return i.minor===o.minor&&i.patch<=o.patch?(e.add(t),!0):s(t);return i.minor<=o.minor?(e.add(t),!0):s(t)}}(B),z=Symbol.for("opentelemetry.js.api."+B.split(".")[0]);function F(t,e,r,n){void 0===n&&(n=!1);var i,s=U[z]=null!==(i=U[z])&&void 0!==i?i:{version:B};if(!n&&s[t]){var o=Error("@opentelemetry/api: Attempted duplicate registration of API: "+t);return r.error(o.stack||o.message),!1}if(s.version!==B){var o=Error("@opentelemetry/api: Registration of version v"+s.version+" for "+t+" does not match previously registered API v"+B);return r.error(o.stack||o.message),!1}return s[t]=e,r.debug("@opentelemetry/api: Registered a global for "+t+" v"+B+"."),!0}function V(t){var e,r,n=null===(e=U[z])||void 0===e?void 0:e.version;if(n&&$(n))return null===(r=U[z])||void 0===r?void 0:r[t]}function H(t,e){e.debug("@opentelemetry/api: Unregistering a global for "+t+" v"+B+".");var r=U[z];r&&delete r[t]}var G=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o},Q=function(t,e,r){if(r||2==arguments.length)for(var n,i=0,s=e.length;i<s;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))},X=function(){function t(t){this._namespace=t.namespace||"DiagComponentLogger"}return t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return K("debug",this._namespace,t)},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return K("error",this._namespace,t)},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return K("info",this._namespace,t)},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return K("warn",this._namespace,t)},t.prototype.verbose=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return K("verbose",this._namespace,t)},t}();function K(t,e,r){var n=V("diag");if(n)return r.unshift(e),n[t].apply(n,Q([],G(r),!1))}(x=b||(b={}))[x.NONE=0]="NONE",x[x.ERROR=30]="ERROR",x[x.WARN=50]="WARN",x[x.INFO=60]="INFO",x[x.DEBUG=70]="DEBUG",x[x.VERBOSE=80]="VERBOSE",x[x.ALL=9999]="ALL";var q=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o},W=function(t,e,r){if(r||2==arguments.length)for(var n,i=0,s=e.length;i<s;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))},J=function(){function t(){function t(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=V("diag");if(n)return n[t].apply(n,W([],q(e),!1))}}var e=this;e.setLogger=function(t,r){if(void 0===r&&(r={logLevel:b.INFO}),t===e){var n,i,s,o=Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return e.error(null!==(n=o.stack)&&void 0!==n?n:o.message),!1}"number"==typeof r&&(r={logLevel:r});var a=V("diag"),u=function(t,e){function r(r,n){var i=e[r];return"function"==typeof i&&t>=n?i.bind(e):function(){}}return t<b.NONE?t=b.NONE:t>b.ALL&&(t=b.ALL),e=e||{},{error:r("error",b.ERROR),warn:r("warn",b.WARN),info:r("info",b.INFO),debug:r("debug",b.DEBUG),verbose:r("verbose",b.VERBOSE)}}(null!==(i=r.logLevel)&&void 0!==i?i:b.INFO,t);if(a&&!r.suppressOverrideMessage){var l=null!==(s=Error().stack)&&void 0!==s?s:"<failed to generate stacktrace>";a.warn("Current logger will be overwritten from "+l),u.warn("Current logger will overwrite one already registered from "+l)}return F("diag",u,e,!0)},e.disable=function(){H("diag",e)},e.createComponentLogger=function(t){return new X(t)},e.verbose=t("verbose"),e.debug=t("debug"),e.info=t("info"),e.warn=t("warn"),e.error=t("error")}return t.instance=function(){return this._instance||(this._instance=new t),this._instance},t}(),Y=J.instance();let OTLPExportDelegate=class OTLPExportDelegate{_transport;_serializer;_responseHandler;_promiseQueue;_timeout;_diagLogger;constructor(t,e,r,n,i){this._transport=t,this._serializer=e,this._responseHandler=r,this._promiseQueue=n,this._timeout=i,this._diagLogger=Y.createComponentLogger({namespace:"OTLPExportDelegate"})}export(t,e){if(this._diagLogger.debug("items to be sent",t),this._promiseQueue.hasReachedLimit()){e({code:E.FAILED,error:Error("Concurrent export limit reached")});return}let r=this._serializer.serializeRequest(t);if(null==r){e({code:E.FAILED,error:Error("Nothing to send")});return}this._promiseQueue.pushPromise(this._transport.send(r,this._timeout).then(t=>{if("success"===t.status){if(null!=t.data)try{this._responseHandler.handleResponse(this._serializer.deserializeResponse(t.data))}catch(e){this._diagLogger.warn("Export succeeded but could not deserialize response - is the response specification compliant?",e,t.data)}e({code:E.SUCCESS});return}if("failure"===t.status&&t.error){e({code:E.FAILED,error:t.error});return}"retryable"===t.status?e({code:E.FAILED,error:new k.N("Export failed with retryable status")}):e({code:E.FAILED,error:new k.N("Export failed with unknown error")})},t=>e({code:E.FAILED,error:t})))}forceFlush(){return this._promiseQueue.awaitAll()}async shutdown(){this._diagLogger.debug("shutdown started"),await this.forceFlush(),this._transport.shutdown()}};let HttpExporterTransport=class HttpExporterTransport{_parameters;_utils=null;constructor(t){this._parameters=t}async send(t,e){let{agent:r,send:n}=this._loadUtils();return new Promise(i=>{n(this._parameters,r,t,t=>{i(t)},e)})}shutdown(){}_loadUtils(){let t=this._utils;if(null===t){let{sendWithHttp:e,createHttpAgent:n}=r(1649);t=this._utils={agent:n(this._parameters.url,this._parameters.agentOptions),send:e}}return t}};let BoundedQueueExportPromiseHandler=class BoundedQueueExportPromiseHandler{_concurrencyLimit;_sendingPromises=[];constructor(t){this._concurrencyLimit=t}pushPromise(t){if(this.hasReachedLimit())throw Error("Concurrency Limit reached");this._sendingPromises.push(t);let e=()=>{let e=this._sendingPromises.indexOf(t);this._sendingPromises.splice(e,1)};t.then(e,e)}hasReachedLimit(){return this._sendingPromises.length>=this._concurrencyLimit}async awaitAll(){await Promise.all(this._sendingPromises)}};let RetryingTransport=class RetryingTransport{_transport;constructor(t){this._transport=t}retry(t,e,r){return new Promise((n,i)=>{setTimeout(()=>{this._transport.send(t,e).then(n,i)},r)})}async send(t,e){let r=Date.now()+e,n=await this._transport.send(t,e),i=5,s=1e3;for(;"retryable"===n.status&&i>0;){i--;let e=Math.max(Math.min(s,5e3)+(.4*Math.random()-.2),0);s*=1.5;let o=n.retryInMillis??e,a=r-Date.now();if(o>a)break;n=await this.retry(t,a,o)}return n}shutdown(){return this._transport.shutdown()}};function Z(t){if(null!=t)return()=>t}var tt=Symbol("BaggageEntryMetadata"),te=J.instance();function tr(t){return"string"!=typeof t||0===t.length?{}:t.split(",").map(t=>(function(t){let e,r=t.split(";");if(r.length<=0)return;let n=r.shift();if(!n)return;let i=n.indexOf("=");if(i<=0)return;let s=decodeURIComponent(n.substring(0,i).trim()),o=decodeURIComponent(n.substring(i+1).trim());if(r.length>0){var a;"string"!=typeof(a=r.join(";"))&&(te.error("Cannot create baggage metadata from unknown type: "+typeof a),a=""),e={__TYPE__:tt,toString:function(){return a}}}return{key:s,value:o,metadata:e}})(t)).filter(t=>void 0!==t&&t.value.length>0).reduce((t,e)=>(t[e.key]=e.value,t),{})}function tn(t){let e=process.env[t]?.trim();if(null!=e&&""!==e){let r=Number(e);if(Number.isFinite(r)&&r>0)return r;Y.warn(`Configuration: ${t} is invalid, expected number greater than 0 (actual: ${e})`)}}function ti(t){let e=process.env[t]?.trim();if(""!==e){if(null==e||"none"===e||"gzip"===e)return e;Y.warn(`Configuration: ${t} is invalid, expected 'none' or 'gzip' (actual: '${e}')`)}}let OTLPTraceExporter=class OTLPTraceExporter extends OTLPExporterBase{constructor(t={}){var e,r,n,i,s,o,a,u,l,c,p;super((u=(e="TRACES",r="v1/traces",n={"User-Agent":"OTel-OTLP-Exporter-JavaScript/0.200.0","Content-Type":"application/json"},t.metadata&&Y.warn("Metadata cannot be set when using http"),i={url:t.url,headers:Z(t.headers),concurrencyLimit:t.concurrencyLimit,timeoutMillis:t.timeoutMillis,compression:t.compression,agentOptions:(t?.keepAlive!=null&&(null!=t.httpAgentOptions?null==t.httpAgentOptions.keepAlive&&(t.httpAgentOptions.keepAlive=t.keepAlive):t.httpAgentOptions={keepAlive:t.keepAlive}),t.httpAgentOptions)},s={...{timeoutMillis:function(t){let e=tn(`OTEL_EXPORTER_OTLP_${t}_TIMEOUT`),r=tn("OTEL_EXPORTER_OTLP_TIMEOUT");return e??r}(e),compression:function(t){let e=ti(`OTEL_EXPORTER_OTLP_${t}_COMPRESSION`),r=ti("OTEL_EXPORTER_OTLP_COMPRESSION");return e??r}(e)},url:function(t){let e=process.env[`OTEL_EXPORTER_OTLP_${t}_ENDPOINT`]?.trim();if(null!=e&&""!==e){try{return new URL(e).toString()}catch{Y.warn(`Configuration: Could not parse environment-provided export URL: '${e}', falling back to undefined`)}return}}(e)??function(t){let e=process.env.OTEL_EXPORTER_OTLP_ENDPOINT?.trim();if(null!=e&&""!==e){var r=e;try{new URL(r)}catch{Y.warn(`Configuration: Could not parse environment-provided export URL: '${r}', falling back to undefined`);return}r.endsWith("/")||(r+="/"),r+=t;try{new URL(r)}catch{Y.warn(`Configuration: Provided URL appended with '${t}' is not a valid URL, using 'undefined' instead of '${r}'`);return}return r}}(r),headers:Z(function(t){let e=process.env[`OTEL_EXPORTER_OTLP_${t}_HEADERS`]?.trim(),r=process.env.OTEL_EXPORTER_OTLP_HEADERS?.trim(),n=tr(e),i=tr(r);if(0!==Object.keys(n).length||0!==Object.keys(i).length)return Object.assign({},tr(r),tr(e))}(e))},{...(o={timeoutMillis:1e4,concurrencyLimit:30,compression:"none",headers:()=>n,url:"http://localhost:4318/"+r,agentOptions:{keepAlive:!0}},{timeoutMillis:function(t){if(Number.isFinite(t)&&t>0)return t;throw Error(`Configuration: timeoutMillis is invalid, expected number greater than 0 (actual: '${t}')`)}(i.timeoutMillis??s.timeoutMillis??o.timeoutMillis),concurrencyLimit:i.concurrencyLimit??s.concurrencyLimit??o.concurrencyLimit,compression:i.compression??s.compression??o.compression}),headers:function(t,e,r){let n={...r()},i={};return()=>(null!=e&&Object.assign(i,e()),null!=t&&Object.assign(i,t()),Object.assign(i,n))}((a=i.headers,()=>{let t={};return Object.entries(a?.()??{}).forEach(([e,r])=>{void 0!==r?t[e]=String(r):Y.warn(`Header "${e}" has invalid value (${r}) and will be ignored`)}),t}),s.headers,o.headers),url:function(t){if(null!=t)try{return new URL(t),t}catch{throw Error(`Configuration: Could not parse user-provided export URL: '${t}'`)}}(i.url)??s.url??o.url,agentOptions:i.agentOptions??s.agentOptions??o.agentOptions}),l=S,c={transport:new RetryingTransport({transport:new HttpExporterTransport(u)}.transport),serializer:l,promiseHandler:new BoundedQueueExportPromiseHandler(u.concurrencyLimit)},p={timeout:u.timeoutMillis},new OTLPExportDelegate(c.transport,c.serializer,{handleResponse(t){null!=t&&Object.prototype.hasOwnProperty.call(t,"partialSuccess")&&null!=t.partialSuccess&&0!==Object.keys(t.partialSuccess).length&&Y.warn("Received Partial Success response:",JSON.stringify(t.partialSuccess))}},c.promiseHandler,p.timeout)))}};let ts={"telemetry.sdk.name":"opentelemetry","process.runtime.name":"node","telemetry.sdk.language":"nodejs","telemetry.sdk.version":"2.0.0"};var to="service.name",ta="telemetry.sdk.language",tu="telemetry.sdk.name",tl="telemetry.sdk.version";let tc=t=>null!==t&&"object"==typeof t&&"function"==typeof t.then;let ResourceImpl=class ResourceImpl{_rawAttributes;_asyncAttributesPending=!1;_memoizedAttributes;static FromAttributeList(t){let e=new ResourceImpl({});return e._rawAttributes=t,e._asyncAttributesPending=t.filter(([t,e])=>tc(e)).length>0,e}constructor(t){let e=t.attributes??{};this._rawAttributes=Object.entries(e).map(([t,e])=>(tc(e)&&(this._asyncAttributesPending=!0),[t,e]))}get asyncAttributesPending(){return this._asyncAttributesPending}async waitForAsyncAttributes(){if(this.asyncAttributesPending){for(let t=0;t<this._rawAttributes.length;t++){let[e,r]=this._rawAttributes[t];try{this._rawAttributes[t]=[e,tc(r)?await r:r]}catch(r){Y.debug("a resource's async attributes promise rejected: %s",r),this._rawAttributes[t]=[e,void 0]}}this._asyncAttributesPending=!1}}get attributes(){if(this.asyncAttributesPending&&Y.error("Accessing resource attributes before async attributes settled"),this._memoizedAttributes)return this._memoizedAttributes;let t={};for(let[e,r]of this._rawAttributes){if(tc(r)){Y.debug(`Unsettled resource attribute ${e} skipped`);continue}null!=r&&(t[e]??=r)}return this._asyncAttributesPending||(this._memoizedAttributes=t),t}getRawAttributes(){return this._rawAttributes}merge(t){return null==t?this:ResourceImpl.FromAttributeList([...t.getRawAttributes(),...this.getRawAttributes()])}};function tp(t){return ResourceImpl.FromAttributeList(Object.entries(t))}(C=T||(T={}))[C.NONE=0]="NONE",C[C.SAMPLED=1]="SAMPLED";let Deferred=class Deferred{_promise;_resolve;_reject;constructor(){this._promise=new Promise((t,e)=>{this._resolve=t,this._reject=e})}get promise(){return this._promise}resolve(t){this._resolve(t)}reject(t){this._reject(t)}};let BindOnceFuture=class BindOnceFuture{_callback;_that;_isCalled=!1;_deferred=new Deferred;constructor(t,e){this._callback=t,this._that=e}get isCalled(){return this._isCalled}get promise(){return this._deferred.promise}call(...t){if(!this._isCalled){this._isCalled=!0;try{Promise.resolve(this._callback.call(this._that,...t)).then(t=>this._deferred.resolve(t),t=>this._deferred.reject(t))}catch(t){this._deferred.reject(t)}}return this._deferred.promise}};let td=t=>{var e;Y.error("string"==typeof(e=t)?e:JSON.stringify(function(t){let e={},r=t;for(;null!==r;)Object.getOwnPropertyNames(r).forEach(t=>{if(e[t])return;let n=r[t];n&&(e[t]=String(n))}),r=Object.getPrototypeOf(r);return e}(e)))};function th(t){try{td(t)}catch{}}function tm(t){return Symbol.for(t)}var tf=new function t(e){var r=this;r._currentContext=e?new Map(e):new Map,r.getValue=function(t){return r._currentContext.get(t)},r.setValue=function(e,n){var i=new t(r._currentContext);return i._currentContext.set(e,n),i},r.deleteValue=function(e){var n=new t(r._currentContext);return n._currentContext.delete(e),n}},t_=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o},tg=function(t,e,r){if(r||2==arguments.length)for(var n,i=0,s=e.length;i<s;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))},tS=function(){function t(){}return t.prototype.active=function(){return tf},t.prototype.with=function(t,e,r){for(var n=[],i=3;i<arguments.length;i++)n[i-3]=arguments[i];return e.call.apply(e,tg([r],t_(n),!1))},t.prototype.bind=function(t,e){return e},t.prototype.enable=function(){return this},t.prototype.disable=function(){return this},t}(),tv=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o},ty=function(t,e,r){if(r||2==arguments.length)for(var n,i=0,s=e.length;i<s;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))},tE="context",tb=new tS,tT=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalContextManager=function(t){return F(tE,t,J.instance())},t.prototype.active=function(){return this._getContextManager().active()},t.prototype.with=function(t,e,r){for(var n,i=[],s=3;s<arguments.length;s++)i[s-3]=arguments[s];return(n=this._getContextManager()).with.apply(n,ty([t,e,r],tv(i),!1))},t.prototype.bind=function(t,e){return this._getContextManager().bind(t,e)},t.prototype._getContextManager=function(){return V(tE)||tb},t.prototype.disable=function(){this._getContextManager().disable(),H(tE,J.instance())},t}(),tw=tT.getInstance();let tO=tm("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function tL(t){return t.setValue(tO,!0)}let SimpleSpanProcessor=class SimpleSpanProcessor{_exporter;_shutdownOnce;_pendingExports;constructor(t){this._exporter=t,this._shutdownOnce=new BindOnceFuture(this._shutdown,this),this._pendingExports=new Set}async forceFlush(){await Promise.all(Array.from(this._pendingExports)),this._exporter.forceFlush&&await this._exporter.forceFlush()}onStart(t,e){}onEnd(t){if(this._shutdownOnce.isCalled||(t.spanContext().traceFlags&T.SAMPLED)==0)return;let e=this._doExport(t).catch(t=>th(t));this._pendingExports.add(e),e.finally(()=>this._pendingExports.delete(e))}async _doExport(t){var e,r;t.resource.asyncAttributesPending&&await t.resource.waitForAsyncAttributes?.();let n=await (e=this._exporter,r=[t],new Promise(t=>{tw.with(tL(tw.active()),()=>{e.export(r,e=>{t(e)})})}));if(n.code!==E.SUCCESS)throw n.error??Error(`SimpleSpanProcessor: span export failed (status ${n})`)}shutdown(){return this._shutdownOnce.call()}_shutdown(){return this._exporter.shutdown()}};var tA=r(9023);function tP(t){let e=process.env[t];if(null==e||""===e.trim())return;let r=Number(e);if(isNaN(r)){Y.warn(`Unknown value ${(0,tA.inspect)(e)} for ${t}, expected a number, using defaults`);return}return r}let BatchSpanProcessorBase=class BatchSpanProcessorBase{_exporter;_maxExportBatchSize;_maxQueueSize;_scheduledDelayMillis;_exportTimeoutMillis;_isExporting=!1;_finishedSpans=[];_timer;_shutdownOnce;_droppedSpansCount=0;constructor(t,e){this._exporter=t,this._maxExportBatchSize="number"==typeof e?.maxExportBatchSize?e.maxExportBatchSize:tP("OTEL_BSP_MAX_EXPORT_BATCH_SIZE")??512,this._maxQueueSize="number"==typeof e?.maxQueueSize?e.maxQueueSize:tP("OTEL_BSP_MAX_QUEUE_SIZE")??2048,this._scheduledDelayMillis="number"==typeof e?.scheduledDelayMillis?e.scheduledDelayMillis:tP("OTEL_BSP_SCHEDULE_DELAY")??5e3,this._exportTimeoutMillis="number"==typeof e?.exportTimeoutMillis?e.exportTimeoutMillis:tP("OTEL_BSP_EXPORT_TIMEOUT")??3e4,this._shutdownOnce=new BindOnceFuture(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(Y.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}forceFlush(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()}onStart(t,e){}onEnd(t){this._shutdownOnce.isCalled||(t.spanContext().traceFlags&T.SAMPLED)!=0&&this._addToBuffer(t)}shutdown(){return this._shutdownOnce.call()}_shutdown(){return Promise.resolve().then(()=>this.onShutdown()).then(()=>this._flushAll()).then(()=>this._exporter.shutdown())}_addToBuffer(t){if(this._finishedSpans.length>=this._maxQueueSize){0===this._droppedSpansCount&&Y.debug("maxQueueSize reached, dropping spans"),this._droppedSpansCount++;return}this._droppedSpansCount>0&&(Y.warn(`Dropped ${this._droppedSpansCount} spans because maxQueueSize reached`),this._droppedSpansCount=0),this._finishedSpans.push(t),this._maybeStartTimer()}_flushAll(){return new Promise((t,e)=>{let r=[],n=Math.ceil(this._finishedSpans.length/this._maxExportBatchSize);for(let t=0;t<n;t++)r.push(this._flushOneBatch());Promise.all(r).then(()=>{t()}).catch(e)})}_flushOneBatch(){return(this._clearTimer(),0===this._finishedSpans.length)?Promise.resolve():new Promise((t,e)=>{let r=setTimeout(()=>{e(Error("Timeout"))},this._exportTimeoutMillis);tw.with(tL(tw.active()),()=>{let n;this._finishedSpans.length<=this._maxExportBatchSize?(n=this._finishedSpans,this._finishedSpans=[]):n=this._finishedSpans.splice(0,this._maxExportBatchSize);let i=()=>this._exporter.export(n,n=>{clearTimeout(r),n.code===E.SUCCESS?t():e(n.error??Error("BatchSpanProcessor: span export failed"))}),s=null;for(let t=0,e=n.length;t<e;t++){let e=n[t];e.resource.asyncAttributesPending&&e.resource.waitForAsyncAttributes&&(s??=[]).push(e.resource.waitForAsyncAttributes())}null===s?i():Promise.all(s).then(i,t=>{th(t),e(t)})})})}_maybeStartTimer(){if(this._isExporting)return;let t=()=>{this._isExporting=!0,this._flushOneBatch().finally(()=>{this._isExporting=!1,this._finishedSpans.length>0&&(this._clearTimer(),this._maybeStartTimer())}).catch(t=>{this._isExporting=!1,th(t)})};if(this._finishedSpans.length>=this._maxExportBatchSize)return t();void 0===this._timer&&(this._timer=setTimeout(()=>t(),this._scheduledDelayMillis),function(t){t.unref()}(this._timer))}_clearTimer(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)}};let BatchSpanProcessor=class BatchSpanProcessor extends BatchSpanProcessorBase{onShutdown(){}};let tx=Function.prototype.toString,tC=tx.call(Object),tR=Object.getPrototypeOf,tI=Object.prototype,tN=tI.hasOwnProperty,tD=Symbol?Symbol.toStringTag:void 0,tM=tI.toString;function tk(t){var e,r,n;if(null==(e=t)||"object"!=typeof e||"[object Object]"!==(null==(r=t)?void 0===r?"[object Undefined]":"[object Null]":tD&&tD in Object(r)?function(t){let e=tN.call(t,tD),r=t[tD],n=!1;try{t[tD]=void 0,n=!0}catch{}let i=tM.call(t);return n&&(e?t[tD]=r:delete t[tD]),i}(r):(n=r,tM.call(n))))return!1;let i=tR(t);if(null===i)return!0;let s=tN.call(i,"constructor")&&i.constructor;return"function"==typeof s&&s instanceof s&&tx.call(s)===tC}function tU(t){return tj(t)?t.slice():t}function tB(t,e,r){let n=r.get(t[e])||[];for(let r=0,i=n.length;r<i;r++){let i=n[r];if(i.key===e&&i.obj===t)return!0}return!1}function tj(t){return Array.isArray(t)}function t$(t){return"function"==typeof t}function tz(t){return!tF(t)&&!tj(t)&&!t$(t)&&"object"==typeof t}function tF(t){return"string"==typeof t||"number"==typeof t||"boolean"==typeof t||void 0===t||t instanceof Date||t instanceof RegExp||null===t}var tV="0000000000000000",tH="00000000000000000000000000000000",tG={traceId:tH,spanId:tV,traceFlags:T.NONE},tQ=function(){function t(t){void 0===t&&(t=tG),this._spanContext=t}return t.prototype.spanContext=function(){return this._spanContext},t.prototype.setAttribute=function(t,e){return this},t.prototype.setAttributes=function(t){return this},t.prototype.addEvent=function(t,e){return this},t.prototype.addLink=function(t){return this},t.prototype.addLinks=function(t){return this},t.prototype.setStatus=function(t){return this},t.prototype.updateName=function(t){return this},t.prototype.end=function(t){},t.prototype.isRecording=function(){return!1},t.prototype.recordException=function(t,e){},t}(),tX=tm("OpenTelemetry Context Key SPAN");function tK(t){return t.getValue(tX)||void 0}function tq(){return tK(tT.getInstance().active())}function tW(t,e){return t.setValue(tX,e)}function tJ(t){return t.deleteValue(tX)}function tY(t,e){return tW(t,new tQ(e))}function tZ(t){var e;return null===(e=tK(t))||void 0===e?void 0:e.spanContext()}var t0=/^([0-9a-f]{32})$/i,t1=/^[0-9a-f]{16}$/i;function t2(t){return t0.test(t)&&t!==tH}function t3(t){var e;return t2(t.traceId)&&(e=t.spanId,t1.test(e)&&e!==tV)}function t4(t){return new tQ(t)}var t8=tT.getInstance(),t9=function(){function t(){}return t.prototype.startSpan=function(t,e,r){if(void 0===r&&(r=t8.active()),null==e?void 0:e.root)return new tQ;var n,i=r&&tZ(r);return"object"==typeof(n=i)&&"string"==typeof n.spanId&&"string"==typeof n.traceId&&"number"==typeof n.traceFlags&&t3(i)?new tQ(i):new tQ},t.prototype.startActiveSpan=function(t,e,r,n){if(!(arguments.length<2)){2==arguments.length?o=e:3==arguments.length?(i=e,o=r):(i=e,s=r,o=n);var i,s,o,a=null!=s?s:t8.active(),u=this.startSpan(t,i,a),l=tW(a,u);return t8.with(l,o,void 0,u)}},t}(),t5=new t9,t6=function(){function t(t,e,r,n){this._provider=t,this.name=e,this.version=r,this.options=n}return t.prototype.startSpan=function(t,e,r){return this._getTracer().startSpan(t,e,r)},t.prototype.startActiveSpan=function(t,e,r,n){var i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)},t.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):t5},t}(),t7=new(function(){function t(){}return t.prototype.getTracer=function(t,e,r){return new t9},t}()),et=function(){function t(){}return t.prototype.getTracer=function(t,e,r){var n;return null!==(n=this.getDelegateTracer(t,e,r))&&void 0!==n?n:new t6(this,t,e,r)},t.prototype.getDelegate=function(){var t;return null!==(t=this._delegate)&&void 0!==t?t:t7},t.prototype.setDelegate=function(t){this._delegate=t},t.prototype.getDelegateTracer=function(t,e,r){var n;return null===(n=this._delegate)||void 0===n?void 0:n.getTracer(t,e,r)},t}(),ee="trace",er=(function(){function t(){this._proxyTracerProvider=new et,this.wrapSpanContext=t4,this.isSpanContextValid=t3,this.deleteSpan=tJ,this.getSpan=tK,this.getActiveSpan=tq,this.getSpanContext=tZ,this.setSpan=tW,this.setSpanContext=tY}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalTracerProvider=function(t){var e=F(ee,this._proxyTracerProvider,J.instance());return e&&this._proxyTracerProvider.setDelegate(t),e},t.prototype.getTracerProvider=function(){return V(ee)||this._proxyTracerProvider},t.prototype.getTracer=function(t,e){return this.getTracerProvider().getTracer(t,e)},t.prototype.disable=function(){H(ee,J.instance()),this._proxyTracerProvider=new et},t})().getInstance();function en(t){let e={};if("object"!=typeof t||null==t)return e;for(let[n,i]of Object.entries(t)){var r;if(!("string"==typeof(r=n)&&r.length>0)){Y.warn(`Invalid attribute key: ${n}`);continue}if(!ei(i)){Y.warn(`Invalid attribute value set for key: ${n}`);continue}Array.isArray(i)?e[n]=i.slice():e[n]=i}return e}function ei(t){return null==t||(Array.isArray(t)?function(t){let e;for(let r of t)if(null!=r){if(!e){if(es(r)){e=typeof r;continue}return!1}if(typeof r!==e)return!1}return!0}(t):es(t))}function es(t){switch(typeof t){case"number":case"boolean":case"string":return!0}return!1}(R=w||(w={}))[R.NOT_RECORD=0]="NOT_RECORD",R[R.RECORD=1]="RECORD",R[R.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED",(I=O||(O={}))[I.UNSET=0]="UNSET",I[I.OK=1]="OK",I[I.ERROR=2]="ERROR";var eo="exception.type",ea="exception.message";let SpanImpl=class SpanImpl{_spanContext;kind;parentSpanContext;attributes={};links=[];events=[];startTime;resource;instrumentationScope;_droppedAttributesCount=0;_droppedEventsCount=0;_droppedLinksCount=0;name;status={code:O.UNSET};endTime=[0,0];_ended=!1;_duration=[-1,-1];_spanProcessor;_spanLimits;_attributeValueLengthLimit;_performanceStartTime;_performanceOffset;_startTimeProvided;constructor(t){let e=Date.now();this._spanContext=t.spanContext,this._performanceStartTime=i.now(),this._performanceOffset=e-(this._performanceStartTime+o()),this._startTimeProvided=null!=t.startTime,this._spanLimits=t.spanLimits,this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0,this._spanProcessor=t.spanProcessor,this.name=t.name,this.parentSpanContext=t.parentSpanContext,this.kind=t.kind,this.links=t.links||[],this.startTime=this._getTime(t.startTime??e),this.resource=t.resource,this.instrumentationScope=t.scope,null!=t.attributes&&this.setAttributes(t.attributes),this._spanProcessor.onStart(this,t.context)}spanContext(){return this._spanContext}setAttribute(t,e){if(null==e||this._isSpanEnded())return this;if(0===t.length)return Y.warn(`Invalid attribute key: ${t}`),this;if(!ei(e))return Y.warn(`Invalid attribute value set for key: ${t}`),this;let{attributeCountLimit:r}=this._spanLimits;return void 0!==r&&Object.keys(this.attributes).length>=r&&!Object.prototype.hasOwnProperty.call(this.attributes,t)?this._droppedAttributesCount++:this.attributes[t]=this._truncateToSize(e),this}setAttributes(t){for(let[e,r]of Object.entries(t))this.setAttribute(e,r);return this}addEvent(t,e,r){if(this._isSpanEnded())return this;let{eventCountLimit:n}=this._spanLimits;if(0===n)return Y.warn("No events allowed."),this._droppedEventsCount++,this;void 0!==n&&this.events.length>=n&&(0===this._droppedEventsCount&&Y.debug("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),u(e)&&(u(r)||(r=e),e=void 0);let i=en(e);return this.events.push({name:t,attributes:i,time:this._getTime(r),droppedAttributesCount:0}),this}addLink(t){return this.links.push(t),this}addLinks(t){return this.links.push(...t),this}setStatus(t){return this._isSpanEnded()||(this.status={...t},null!=this.status.message&&"string"!=typeof t.message&&(Y.warn(`Dropping invalid status.message of type '${typeof t.message}', expected 'string'`),delete this.status.message)),this}updateName(t){return this._isSpanEnded()||(this.name=t),this}end(t){var e,r;let n,i;if(this._isSpanEnded()){Y.error(`${this.name} ${this._spanContext.traceId}-${this._spanContext.spanId} - You can only call end() on a span once.`);return}this._ended=!0,this.endTime=this._getTime(t),this._duration=(e=this.startTime,n=(r=this.endTime)[0]-e[0],(i=r[1]-e[1])<0&&(n-=1,i+=1e9),[n,i]),this._duration[0]<0&&(Y.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._droppedEventsCount>0&&Y.warn(`Dropped ${this._droppedEventsCount} events because eventCountLimit reached`),this._spanProcessor.onEnd(this)}_getTime(t){if("number"==typeof t&&t<=i.now()){var e=t+this._performanceOffset;return l(s(o()),s("number"==typeof e?e:i.now()))}if("number"==typeof t)return s(t);if(t instanceof Date)return s(t.getTime());if(a(t))return t;if(this._startTimeProvided)return s(Date.now());let r=i.now()-this._performanceStartTime;return l(this.startTime,s(r))}isRecording(){return!1===this._ended}recordException(t,e){let r={};"string"==typeof t?r[ea]=t:t&&(t.code?r[eo]=t.code.toString():t.name&&(r[eo]=t.name),t.message&&(r[ea]=t.message),t.stack&&(r["exception.stacktrace"]=t.stack)),r[eo]||r[ea]?this.addEvent("exception",r,e):Y.warn(`Failed to record an exception ${t}`)}get duration(){return this._duration}get ended(){return this._ended}get droppedAttributesCount(){return this._droppedAttributesCount}get droppedEventsCount(){return this._droppedEventsCount}get droppedLinksCount(){return this._droppedLinksCount}_isSpanEnded(){if(this._ended){let t=Error(`Operation attempted on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`);Y.warn(`Cannot execute the operation on ended Span {traceId: ${this._spanContext.traceId}, spanId: ${this._spanContext.spanId}}`,t)}return this._ended}_truncateToLimitUtil(t,e){return t.length<=e?t:t.substring(0,e)}_truncateToSize(t){let e=this._attributeValueLengthLimit;return e<=0?(Y.warn(`Attribute value limit must be positive, got ${e}`),t):"string"==typeof t?this._truncateToLimitUtil(t,e):Array.isArray(t)?t.map(t=>"string"==typeof t?this._truncateToLimitUtil(t,e):t):t}};(N=L||(L={}))[N.NOT_RECORD=0]="NOT_RECORD",N[N.RECORD=1]="RECORD",N[N.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED";let AlwaysOffSampler=class AlwaysOffSampler{shouldSample(){return{decision:L.NOT_RECORD}}toString(){return"AlwaysOffSampler"}};let AlwaysOnSampler=class AlwaysOnSampler{shouldSample(){return{decision:L.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}};let ParentBasedSampler=class ParentBasedSampler{_root;_remoteParentSampled;_remoteParentNotSampled;_localParentSampled;_localParentNotSampled;constructor(t){this._root=t.root,this._root||(th(Error("ParentBasedSampler must have a root sampler configured")),this._root=new AlwaysOnSampler),this._remoteParentSampled=t.remoteParentSampled??new AlwaysOnSampler,this._remoteParentNotSampled=t.remoteParentNotSampled??new AlwaysOffSampler,this._localParentSampled=t.localParentSampled??new AlwaysOnSampler,this._localParentNotSampled=t.localParentNotSampled??new AlwaysOffSampler}shouldSample(t,e,r,n,i,s){let o=er.getSpanContext(t);return o&&t3(o)?o.isRemote?o.traceFlags&T.SAMPLED?this._remoteParentSampled.shouldSample(t,e,r,n,i,s):this._remoteParentNotSampled.shouldSample(t,e,r,n,i,s):o.traceFlags&T.SAMPLED?this._localParentSampled.shouldSample(t,e,r,n,i,s):this._localParentNotSampled.shouldSample(t,e,r,n,i,s):this._root.shouldSample(t,e,r,n,i,s)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}};let TraceIdRatioBasedSampler=class TraceIdRatioBasedSampler{_ratio;_upperBound;constructor(t=0){this._ratio=t,this._ratio=this._normalize(t),this._upperBound=Math.floor(0xffffffff*this._ratio)}shouldSample(t,e){return{decision:t2(e)&&this._accumulate(e)<this._upperBound?L.RECORD_AND_SAMPLED:L.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(t){return"number"!=typeof t||isNaN(t)?0:t>=1?1:t<=0?0:t}_accumulate(t){let e=0;for(let r=0;r<t.length/8;r++){let n=8*r;e=(e^parseInt(t.slice(n,n+8),16))>>>0}return e}};function eu(){return{sampler:el(),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:tP("OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT")??1/0,attributeCountLimit:tP("OTEL_ATTRIBUTE_COUNT_LIMIT")??128},spanLimits:{attributeValueLengthLimit:tP("OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT")??1/0,attributeCountLimit:tP("OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT")??128,linkCountLimit:tP("OTEL_SPAN_LINK_COUNT_LIMIT")??128,eventCountLimit:tP("OTEL_SPAN_EVENT_COUNT_LIMIT")??128,attributePerEventCountLimit:tP("OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT")??128,attributePerLinkCountLimit:tP("OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT")??128}}}function el(){let t=function(t){let e=process.env[t];if(null!=e&&""!==e.trim())return e}("OTEL_TRACES_SAMPLER")??"parentbased_always_on";switch(t){case"always_on":return new AlwaysOnSampler;case"always_off":return new AlwaysOffSampler;case"parentbased_always_on":return new ParentBasedSampler({root:new AlwaysOnSampler});case"parentbased_always_off":return new ParentBasedSampler({root:new AlwaysOffSampler});case"traceidratio":return new TraceIdRatioBasedSampler(ec());case"parentbased_traceidratio":return new ParentBasedSampler({root:new TraceIdRatioBasedSampler(ec())});default:return Y.error(`OTEL_TRACES_SAMPLER value "${t}" invalid, defaulting to "parentbased_always_on".`),new ParentBasedSampler({root:new AlwaysOnSampler})}}function ec(){let t=tP("OTEL_TRACES_SAMPLER_ARG");return null==t?(Y.error("OTEL_TRACES_SAMPLER_ARG is blank, defaulting to 1."),1):t<0||t>1?(Y.error(`OTEL_TRACES_SAMPLER_ARG=${t} was given, but it is out of range ([0..1]), defaulting to 1.`),1):t}let ep=1/0;let RandomIdGenerator=class RandomIdGenerator{generateTraceId=eh(16);generateSpanId=eh(8)};let ed=Buffer.allocUnsafe(16);function eh(t){return function(){for(let e=0;e<t/4;e++)ed.writeUInt32BE(0x100000000*Math.random()>>>0,4*e);for(let e=0;e<t;e++)if(ed[e]>0)break;else e===t-1&&(ed[t-1]=1);return ed.toString("hex",0,t)}}let Tracer=class Tracer{_sampler;_generalLimits;_spanLimits;_idGenerator;instrumentationScope;_resource;_spanProcessor;constructor(t,e,r,n){let i=function(t){let e={sampler:el()},r=eu(),n=Object.assign({},r,e,t);return n.generalLimits=Object.assign({},r.generalLimits,t.generalLimits||{}),n.spanLimits=Object.assign({},r.spanLimits,t.spanLimits||{}),n}(e);this._sampler=i.sampler,this._generalLimits=i.generalLimits,this._spanLimits=i.spanLimits,this._idGenerator=e.idGenerator||new RandomIdGenerator,this._resource=r,this._spanProcessor=n,this.instrumentationScope=t}startSpan(t,e={},r=tw.active()){let n,i,s;e.root&&(r=er.deleteSpan(r));let o=er.getSpan(r);if(!0===r.getValue(tO))return Y.debug("Instrumentation suppressed, returning Noop Span"),er.wrapSpanContext(tG);let a=o?.spanContext(),u=this._idGenerator.generateSpanId();a&&er.isSpanContextValid(a)?(i=a.traceId,s=a.traceState,n=a):i=this._idGenerator.generateTraceId();let l=e.kind??y.INTERNAL,c=(e.links??[]).map(t=>({context:t.context,attributes:en(t.attributes)})),p=en(e.attributes),d=this._sampler.shouldSample(r,i,t,l,p,c);s=d.traceState??s;let h={traceId:i,spanId:u,traceFlags:d.decision===w.RECORD_AND_SAMPLED?T.SAMPLED:T.NONE,traceState:s};if(d.decision===w.NOT_RECORD)return Y.debug("Recording is off, propagating context in a non-recording span"),er.wrapSpanContext(h);let m=en(Object.assign(p,d.attributes));return new SpanImpl({resource:this._resource,scope:this.instrumentationScope,context:r,spanContext:h,name:t,kind:l,links:c,parentSpanContext:n,attributes:m,startTime:e.startTime,spanProcessor:this._spanProcessor,spanLimits:this._spanLimits})}startActiveSpan(t,e,r,n){let i,s,o;if(arguments.length<2)return;2==arguments.length?o=e:3==arguments.length?(i=e,o=r):(i=e,s=r,o=n);let a=s??tw.active(),u=this.startSpan(t,i,a),l=er.setSpan(a,u);return tw.with(l,o,void 0,u)}getGeneralLimits(){return this._generalLimits}getSpanLimits(){return this._spanLimits}};let MultiSpanProcessor=class MultiSpanProcessor{_spanProcessors;constructor(t){this._spanProcessors=t}forceFlush(){let t=[];for(let e of this._spanProcessors)t.push(e.forceFlush());return new Promise(e=>{Promise.all(t).then(()=>{e()}).catch(t=>{th(t||Error("MultiSpanProcessor: forceFlush failed")),e()})})}onStart(t,e){for(let r of this._spanProcessors)r.onStart(t,e)}onEnd(t){for(let e of this._spanProcessors)e.onEnd(t)}shutdown(){let t=[];for(let e of this._spanProcessors)t.push(e.shutdown());return new Promise((e,r)=>{Promise.all(t).then(()=>{e()},r)})}};(D=A||(A={}))[D.resolved=0]="resolved",D[D.timeout=1]="timeout",D[D.error=2]="error",D[D.unresolved=3]="unresolved";let BasicTracerProvider=class BasicTracerProvider{_config;_tracers=new Map;_resource;_activeSpanProcessor;constructor(t={}){let e=function(...t){let e=t.shift(),r=new WeakMap;for(;t.length>0;)e=function t(e,r,n=0,i){let s;if(!(n>20)){if(n++,tF(e)||tF(r)||t$(r))s=tU(r);else if(tj(e)){if(s=e.slice(),tj(r))for(let t=0,e=r.length;t<e;t++)s.push(tU(r[t]));else if(tz(r)){let t=Object.keys(r);for(let e=0,n=t.length;e<n;e++){let n=t[e];s[n]=tU(r[n])}}}else if(tz(e))if(tz(r)){var o,a;if(o=e,a=r,!(tk(o)&&tk(a)))return r;s=Object.assign({},e);let u=Object.keys(r);for(let o=0,a=u.length;o<a;o++){let a=u[o],l=r[a];if(tF(l))void 0===l?delete s[a]:s[a]=l;else{let o=s[a];if(tB(e,a,i)||tB(r,a,i))delete s[a];else{if(tz(o)&&tz(l)){let t=i.get(o)||[],n=i.get(l)||[];t.push({obj:e,key:a}),n.push({obj:r,key:a}),i.set(o,t),i.set(l,n)}s[a]=t(s[a],l,n,i)}}}}else s=r;return s}}(e,t.shift(),0,r);return e}({},eu(),function(t){let e=Object.assign({},t.spanLimits);return e.attributeCountLimit=t.spanLimits?.attributeCountLimit??t.generalLimits?.attributeCountLimit??tP("OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT")??tP("OTEL_ATTRIBUTE_COUNT_LIMIT")??128,e.attributeValueLengthLimit=t.spanLimits?.attributeValueLengthLimit??t.generalLimits?.attributeValueLengthLimit??tP("OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT")??tP("OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT")??ep,Object.assign({},t,{spanLimits:e})}(t));this._resource=e.resource??tp({[to]:`unknown_service:${process.argv0}`,[ta]:ts[ta],[tu]:ts[tu],[tl]:ts[tl]}),this._config=Object.assign({},e,{resource:this._resource});let r=[];t.spanProcessors?.length&&r.push(...t.spanProcessors),this._activeSpanProcessor=new MultiSpanProcessor(r)}getTracer(t,e,r){let n=`${t}@${e||""}:${r?.schemaUrl||""}`;return this._tracers.has(n)||this._tracers.set(n,new Tracer({name:t,version:e,schemaUrl:r?.schemaUrl},this._config,this._resource,this._activeSpanProcessor)),this._tracers.get(n)}forceFlush(){let t=this._config.forceFlushTimeoutMillis,e=this._activeSpanProcessor._spanProcessors.map(e=>new Promise(r=>{let n,i=setTimeout(()=>{r(Error(`Span processor did not completed within timeout period of ${t} ms`)),n=A.timeout},t);e.forceFlush().then(()=>{clearTimeout(i),n!==A.timeout&&r(n=A.resolved)}).catch(t=>{clearTimeout(i),n=A.error,r(t)})}));return new Promise((t,r)=>{Promise.all(e).then(e=>{let n=e.filter(t=>t!==A.resolved);n.length>0?r(n):t()}).catch(t=>r([t]))})}shutdown(){return this._activeSpanProcessor.shutdown()}};var em=((M=em||{}).NONE="none",M.GZIP="gzip",M);let OpenTelemetryProvider=class OpenTelemetryProvider{_globalAttributes={};provider;tracer;constructor(t,e,r){let n=new OTLPTraceExporter({url:r?"https://otel-dev.gitkraken.com/v1/traces":"https://otel.gitkraken.com/v1/traces",compression:"gzip",httpAgentOptions:e?.options}),i=[];r?i.push(new SimpleSpanProcessor(n)):i.push(new BatchSpanProcessor(n)),this.provider=new BasicTracerProvider({resource:tp({[to]:"gitlens","service.version":t.extensionVersion,"deployment.environment":t.env,"deployment.environment.name":t.env,"device.id":t.machineId,"os.type":t.platform,"extension.id":t.extensionId,"session.id":t.sessionId,language:t.language,"vscode.edition":t.vscodeEdition,"vscode.version":t.vscodeVersion,"vscode.host":t.vscodeHost,"vscode.remoteName":t.vscodeRemoteName,"vscode.shell":t.vscodeShell,"vscode.uiKind":t.vscodeUIKind}),spanProcessors:i}),this.tracer=this.provider.getTracer(t.extensionId)}dispose(){this.provider.shutdown()}sendEvent(t,e,r,n){let i=this.tracer.startSpan(t,{attributes:this._globalAttributes,kind:y.INTERNAL,startTime:r??Date.now()});null!=e&&i.setAttributes(e),i.end(n)}startEvent(t,e,r){let n=this.tracer.startSpan(t,{attributes:this._globalAttributes,kind:y.INTERNAL,startTime:r??Date.now()});return null!=e&&n.setAttributes(e),n}setGlobalAttributes(t){this._globalAttributes=Object.fromEntries(t)}}}};